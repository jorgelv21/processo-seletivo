{"ast":null,"code":"import * as i0 from '@angular/core';\nimport { InjectionToken, EventEmitter, Injectable, Inject, Optional, forwardRef, Directive, Input, Output, HostListener, Pipe, NgModule } from '@angular/core';\nimport { __awaiter, __rest } from 'tslib';\nimport { DOCUMENT } from '@angular/common';\nimport { NG_VALUE_ACCESSOR, NG_VALIDATORS } from '@angular/forms';\nconst NGX_MASK_CONFIG = new InjectionToken('ngx-mask config');\nconst NEW_CONFIG = new InjectionToken('new ngx-mask config');\nconst INITIAL_CONFIG = new InjectionToken('initial ngx-mask config');\nconst initialConfig = {\n  suffix: '',\n  prefix: '',\n  thousandSeparator: ' ',\n  decimalMarker: ['.', ','],\n  clearIfNotMatch: false,\n  showTemplate: false,\n  showMaskTyped: false,\n  placeHolderCharacter: '_',\n  dropSpecialCharacters: true,\n  hiddenInput: undefined,\n  shownMaskExpression: '',\n  separatorLimit: '',\n  allowNegativeNumbers: false,\n  validation: true,\n  // eslint-disable-next-line @typescript-eslint/quotes\n  specialCharacters: ['-', '/', '(', ')', '.', ':', ' ', '+', ',', '@', '[', ']', '\"', \"'\"],\n  leadZeroDateTime: false,\n  apm: false,\n  leadZero: false,\n  keepCharacterPositions: false,\n  triggerOnMaskChange: false,\n  inputTransformFn: value => value,\n  outputTransformFn: value => value,\n  maskFilled: new EventEmitter(),\n  patterns: {\n    '0': {\n      pattern: new RegExp('\\\\d')\n    },\n    '9': {\n      pattern: new RegExp('\\\\d'),\n      optional: true\n    },\n    X: {\n      pattern: new RegExp('\\\\d'),\n      symbol: '*'\n    },\n    A: {\n      pattern: new RegExp('[a-zA-Z0-9]')\n    },\n    S: {\n      pattern: new RegExp('[a-zA-Z]')\n    },\n    U: {\n      pattern: new RegExp('[A-Z]')\n    },\n    L: {\n      pattern: new RegExp('[a-z]')\n    },\n    d: {\n      pattern: new RegExp('\\\\d')\n    },\n    m: {\n      pattern: new RegExp('\\\\d')\n    },\n    M: {\n      pattern: new RegExp('\\\\d')\n    },\n    H: {\n      pattern: new RegExp('\\\\d')\n    },\n    h: {\n      pattern: new RegExp('\\\\d')\n    },\n    s: {\n      pattern: new RegExp('\\\\d')\n    }\n  }\n};\nconst timeMasks = [\"Hh:m0:s0\"\n/* HOURS_MINUTES_SECONDS */\n, \"Hh:m0\"\n/* HOURS_MINUTES */\n, \"m0:s0\"\n/* MINUTES_SECONDS */\n];\nconst withoutValidation = [\"percent\"\n/* PERCENT */\n, \"Hh\"\n/* HOURS_HOUR */\n, \"s0\"\n/* SECONDS */\n, \"m0\"\n/* MINUTES */\n, \"separator\"\n/* SEPARATOR */\n, \"d0/M0/0000\"\n/* DAYS_MONTHS_YEARS */\n, \"d0/M0\"\n/* DAYS_MONTHS */\n, \"d0\"\n/* DAYS */\n, \"M0\"\n/* MONTHS */\n];\n\nclass NgxMaskApplierService {\n  constructor(_config) {\n    this._config = _config;\n    this._shift = new Set();\n    this.plusOnePosition = false;\n    this.maskExpression = '';\n    this.actualValue = '';\n    this.showKeepCharacterExp = '';\n    this.shownMaskExpression = '';\n    this.deletedSpecialCharacter = false;\n\n    this._formatWithSeparators = (str, thousandSeparatorChar, decimalChars, precision) => {\n      var _a, _b, _c;\n\n      let x = [];\n      let decimalChar = '';\n\n      if (Array.isArray(decimalChars)) {\n        const regExp = new RegExp(decimalChars.map(v => '[\\\\^$.|?*+()'.indexOf(v) >= 0 ? `\\\\${v}` : v).join('|'));\n        x = str.split(regExp);\n        decimalChar = (_b = (_a = str.match(regExp)) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : \"\"\n        /* EMPTY_STRING */\n        ;\n      } else {\n        x = str.split(decimalChars);\n        decimalChar = decimalChars;\n      }\n\n      const decimals = x.length > 1 ? `${decimalChar}${x[1]}` : \"\"\n      /* EMPTY_STRING */\n      ;\n      let res = (_c = x[0]) !== null && _c !== void 0 ? _c : \"\"\n      /* EMPTY_STRING */\n      ;\n      const separatorLimit = this.separatorLimit.replace(/\\s/g, \"\"\n      /* EMPTY_STRING */\n      );\n\n      if (separatorLimit && +separatorLimit) {\n        if (res[0] === \"-\"\n        /* MINUS */\n        ) {\n          res = `-${res.slice(1, res.length).slice(0, separatorLimit.length)}`;\n        } else {\n          res = res.slice(0, separatorLimit.length);\n        }\n      }\n\n      const rgx = /(\\d+)(\\d{3})/;\n\n      while (thousandSeparatorChar && rgx.test(res)) {\n        res = res.replace(rgx, '$1' + thousandSeparatorChar + '$2');\n      }\n\n      if (precision === undefined) {\n        return res + decimals;\n      } else if (precision === 0) {\n        return res;\n      }\n\n      return res + decimals.substring(0, precision + 1);\n    };\n\n    this.percentage = str => {\n      const sanitizedStr = str.replace(',', '.');\n      const value = Number(sanitizedStr);\n      return !isNaN(value) && value >= 0 && value <= 100;\n    };\n\n    this.getPrecision = maskExpression => {\n      const x = maskExpression.split(\".\"\n      /* DOT */\n      );\n\n      if (x.length > 1) {\n        return Number(x[x.length - 1]);\n      }\n\n      return Infinity;\n    };\n\n    this.checkAndRemoveSuffix = inputValue => {\n      var _a, _b, _c, _d;\n\n      for (let i = ((_a = this.suffix) === null || _a === void 0 ? void 0 : _a.length) - 1; i >= 0; i--) {\n        const substr = this.suffix.substring(i, (_b = this.suffix) === null || _b === void 0 ? void 0 : _b.length);\n\n        if (inputValue.includes(substr) && i !== ((_c = this.suffix) === null || _c === void 0 ? void 0 : _c.length) - 1 && (i - 1 < 0 || !inputValue.includes(this.suffix.substring(i - 1, (_d = this.suffix) === null || _d === void 0 ? void 0 : _d.length)))) {\n          return inputValue.replace(substr, \"\"\n          /* EMPTY_STRING */\n          );\n        }\n      }\n\n      return inputValue;\n    };\n\n    this.checkInputPrecision = (inputValue, precision, decimalMarker) => {\n      var _a, _b;\n\n      if (precision < Infinity) {\n        // TODO need think about decimalMarker\n        if (Array.isArray(decimalMarker)) {\n          const marker = decimalMarker.find(dm => dm !== this.thousandSeparator); // eslint-disable-next-line no-param-reassign\n\n          decimalMarker = marker ? marker : decimalMarker[0];\n        }\n\n        const precisionRegEx = new RegExp(this._charToRegExpExpression(decimalMarker) + `\\\\d{${precision}}.*$`);\n        const precisionMatch = inputValue.match(precisionRegEx);\n        const precisionMatchLength = (_b = precisionMatch && ((_a = precisionMatch[0]) === null || _a === void 0 ? void 0 : _a.length)) !== null && _b !== void 0 ? _b : 0;\n\n        if (precisionMatchLength - 1 > precision) {\n          const diff = precisionMatchLength - 1 - precision; // eslint-disable-next-line no-param-reassign\n\n          inputValue = inputValue.substring(0, inputValue.length - diff);\n        }\n\n        if (precision === 0 && this._compareOrIncludes(inputValue[inputValue.length - 1], decimalMarker, this.thousandSeparator)) {\n          // eslint-disable-next-line no-param-reassign\n          inputValue = inputValue.substring(0, inputValue.length - 1);\n        }\n      }\n\n      return inputValue;\n    };\n\n    this.dropSpecialCharacters = this._config.dropSpecialCharacters;\n    this.hiddenInput = this._config.hiddenInput;\n    this.clearIfNotMatch = this._config.clearIfNotMatch;\n    this.specialCharacters = this._config.specialCharacters;\n    this.patterns = this._config.patterns;\n    this.prefix = this._config.prefix;\n    this.suffix = this._config.suffix;\n    this.thousandSeparator = this._config.thousandSeparator;\n    this.decimalMarker = this._config.decimalMarker;\n    this.showMaskTyped = this._config.showMaskTyped;\n    this.placeHolderCharacter = this._config.placeHolderCharacter;\n    this.validation = this._config.validation;\n    this.separatorLimit = this._config.separatorLimit;\n    this.allowNegativeNumbers = this._config.allowNegativeNumbers;\n    this.leadZeroDateTime = this._config.leadZeroDateTime;\n    this.leadZero = this._config.leadZero;\n    this.apm = this._config.apm;\n    this.inputTransformFn = this._config.inputTransformFn;\n    this.outputTransformFn = this._config.outputTransformFn;\n    this.keepCharacterPositions = this._config.keepCharacterPositions;\n  }\n\n  applyMaskWithPattern(inputValue, maskAndPattern) {\n    const [mask, customPattern] = maskAndPattern;\n    this.customPattern = customPattern;\n    return this.applyMask(inputValue, mask);\n  }\n\n  applyMask(inputValue, maskExpression, position = 0, justPasted = false, backspaced = false, // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n  cb = () => {}) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s;\n\n    if (!maskExpression || typeof inputValue !== 'string') {\n      return \"\"\n      /* EMPTY_STRING */\n      ;\n    }\n\n    let cursor = 0;\n    let result = '';\n    let multi = false;\n    let backspaceShift = false;\n    let shift = 1;\n    let stepBack = false;\n\n    if (inputValue.slice(0, this.prefix.length) === this.prefix) {\n      // eslint-disable-next-line no-param-reassign\n      inputValue = inputValue.slice(this.prefix.length, inputValue.length);\n    }\n\n    if (!!this.suffix && (inputValue === null || inputValue === void 0 ? void 0 : inputValue.length) > 0) {\n      // eslint-disable-next-line no-param-reassign\n      inputValue = this.checkAndRemoveSuffix(inputValue);\n    }\n\n    if (inputValue === '(' && this.prefix) {\n      // eslint-disable-next-line no-param-reassign\n      inputValue = '';\n    }\n\n    const inputArray = inputValue.toString().split(\"\"\n    /* EMPTY_STRING */\n    );\n\n    if (this.allowNegativeNumbers && inputValue.slice(cursor, cursor + 1) === \"-\"\n    /* MINUS */\n    ) {\n      // eslint-disable-next-line no-param-reassign\n      result += inputValue.slice(cursor, cursor + 1);\n    }\n\n    if (maskExpression === \"IP\"\n    /* IP */\n    ) {\n      const valuesIP = inputValue.split(\".\"\n      /* DOT */\n      );\n      this.ipError = this._validIP(valuesIP); // eslint-disable-next-line no-param-reassign\n\n      maskExpression = '099.099.099.099';\n    }\n\n    const arr = [];\n\n    for (let i = 0; i < inputValue.length; i++) {\n      if ((_a = inputValue[i]) === null || _a === void 0 ? void 0 : _a.match('\\\\d')) {\n        arr.push((_b = inputValue[i]) !== null && _b !== void 0 ? _b : \"\"\n        /* EMPTY_STRING */\n        );\n      }\n    }\n\n    if (maskExpression === \"CPF_CNPJ\"\n    /* CPF_CNPJ */\n    ) {\n      this.cpfCnpjError = arr.length !== 11 && arr.length !== 14;\n\n      if (arr.length > 11) {\n        // eslint-disable-next-line no-param-reassign\n        maskExpression = '00.000.000/0000-00';\n      } else {\n        // eslint-disable-next-line no-param-reassign\n        maskExpression = '000.000.000-00';\n      }\n    }\n\n    if (maskExpression.startsWith(\"percent\"\n    /* PERCENT */\n    )) {\n      if (inputValue.match('[a-z]|[A-Z]') || // eslint-disable-next-line no-useless-escape\n      inputValue.match(/[-!$%^&*()_+|~=`{}\\[\\]:\";'<>?,\\/.]/) && !backspaced) {\n        // eslint-disable-next-line no-param-reassign\n        inputValue = this._stripToDecimal(inputValue);\n        const precision = this.getPrecision(maskExpression); // eslint-disable-next-line no-param-reassign\n\n        inputValue = this.checkInputPrecision(inputValue, precision, this.decimalMarker);\n      }\n\n      const decimalMarker = typeof this.decimalMarker === 'string' ? this.decimalMarker : \".\"\n      /* DOT */\n      ;\n\n      if (inputValue.indexOf(decimalMarker) > 0 && !this.percentage(inputValue.substring(0, inputValue.indexOf(decimalMarker)))) {\n        let base = inputValue.substring(0, inputValue.indexOf(decimalMarker) - 1);\n\n        if (this.allowNegativeNumbers && inputValue.slice(cursor, cursor + 1) === \"-\"\n        /* MINUS */\n        && !backspaced) {\n          base = inputValue.substring(0, inputValue.indexOf(decimalMarker));\n        } // eslint-disable-next-line no-param-reassign\n\n\n        inputValue = `${base}${inputValue.substring(inputValue.indexOf(decimalMarker), inputValue.length)}`;\n      }\n\n      let value = '';\n      this.allowNegativeNumbers && inputValue.slice(cursor, cursor + 1) === \"-\"\n      /* MINUS */\n      ? value = inputValue.slice(cursor + 1, cursor + inputValue.length) : value = inputValue;\n\n      if (this.percentage(value)) {\n        result = this._splitPercentZero(inputValue);\n      } else {\n        result = this._splitPercentZero(inputValue.substring(0, inputValue.length - 1));\n      }\n    } else if (maskExpression.startsWith(\"separator\"\n    /* SEPARATOR */\n    )) {\n      if (inputValue.match('[wа-яА-Я]') || inputValue.match('[ЁёА-я]') || inputValue.match('[a-z]|[A-Z]') || inputValue.match(/[-@#!$%\\\\^&*()_£¬'+|~=`{}\\]:\";<>.?/]/) || inputValue.match('[^A-Za-z0-9,]')) {\n        // eslint-disable-next-line no-param-reassign\n        inputValue = this._stripToDecimal(inputValue);\n      }\n\n      const precision = this.getPrecision(maskExpression);\n      const decimalMarker = Array.isArray(this.decimalMarker) ? \".\"\n      /* DOT */\n      : this.decimalMarker;\n\n      if (precision === 0) {\n        // eslint-disable-next-line no-param-reassign\n        inputValue = this.allowNegativeNumbers ? inputValue.length > 2 && inputValue[0] === \"-\"\n        /* MINUS */\n        && inputValue[1] === \"0\"\n        /* NUMBER_ZERO */\n        && inputValue[2] !== this.thousandSeparator && inputValue[2] !== \",\"\n        /* COMMA */\n        && inputValue[2] !== \".\"\n        /* DOT */\n        ? '-' + inputValue.slice(2, inputValue.length) : inputValue[0] === \"0\"\n        /* NUMBER_ZERO */\n        && inputValue.length > 1 && inputValue[1] !== this.thousandSeparator && inputValue[1] !== \",\"\n        /* COMMA */\n        && inputValue[1] !== \".\"\n        /* DOT */\n        ? inputValue.slice(1, inputValue.length) : inputValue : inputValue.length > 1 && inputValue[0] === \"0\"\n        /* NUMBER_ZERO */\n        && inputValue[1] !== this.thousandSeparator && inputValue[1] !== \",\"\n        /* COMMA */\n        && inputValue[1] !== \".\"\n        /* DOT */\n        ? inputValue.slice(1, inputValue.length) : inputValue;\n      } else {\n        // eslint-disable-next-line no-param-reassign\n        if (inputValue[0] === decimalMarker && inputValue.length > 1) {\n          // eslint-disable-next-line no-param-reassign\n          inputValue = \"0\"\n          /* NUMBER_ZERO */\n          + inputValue.slice(0, inputValue.length + 1);\n          this.plusOnePosition = true;\n        }\n\n        if (inputValue[0] === \"0\"\n        /* NUMBER_ZERO */\n        && inputValue[1] !== decimalMarker && inputValue[1] !== this.thousandSeparator) {\n          // eslint-disable-next-line no-param-reassign\n          inputValue = inputValue.length > 1 ? inputValue.slice(0, 1) + decimalMarker + inputValue.slice(1, inputValue.length + 1) : inputValue;\n          this.plusOnePosition = true;\n        }\n\n        if (this.allowNegativeNumbers && inputValue[0] === \"-\"\n        /* MINUS */\n        && (inputValue[1] === decimalMarker || inputValue[1] === \"0\"\n        /* NUMBER_ZERO */\n        )) {\n          // eslint-disable-next-line no-param-reassign\n          inputValue = inputValue[1] === decimalMarker && inputValue.length > 2 ? inputValue.slice(0, 1) + \"0\"\n          /* NUMBER_ZERO */\n          + inputValue.slice(1, inputValue.length) : inputValue[1] === \"0\"\n          /* NUMBER_ZERO */\n          && inputValue.length > 2 && inputValue[2] !== decimalMarker ? inputValue.slice(0, 2) + decimalMarker + inputValue.slice(2, inputValue.length) : inputValue;\n          this.plusOnePosition = true;\n        }\n      }\n\n      if (backspaced) {\n        if (inputValue[0] === \"0\"\n        /* NUMBER_ZERO */\n        && inputValue[1] === this.decimalMarker && (inputValue[position] === \"0\"\n        /* NUMBER_ZERO */\n        || inputValue[position] === this.decimalMarker)) {\n          // eslint-disable-next-line no-param-reassign\n          inputValue = inputValue.slice(2, inputValue.length);\n        }\n\n        if (inputValue[0] === \"-\"\n        /* MINUS */\n        && inputValue[1] === \"0\"\n        /* NUMBER_ZERO */\n        && inputValue[2] === this.decimalMarker && (inputValue[position] === \"0\"\n        /* NUMBER_ZERO */\n        || inputValue[position] === this.decimalMarker)) {\n          // eslint-disable-next-line no-param-reassign\n          inputValue = \"-\"\n          /* MINUS */\n          + inputValue.slice(3, inputValue.length);\n        } // eslint-disable-next-line no-param-reassign\n\n\n        inputValue = this._compareOrIncludes(inputValue[inputValue.length - 1], this.decimalMarker, this.thousandSeparator) ? inputValue.slice(0, inputValue.length - 1) : inputValue;\n      } // TODO: we had different rexexps here for the different cases... but tests dont seam to bother - check this\n      //  separator: no COMMA, dot-sep: no SPACE, COMMA OK, comma-sep: no SPACE, COMMA OK\n\n\n      const thousandSeparatorCharEscaped = this._charToRegExpExpression(this.thousandSeparator);\n\n      let invalidChars = '@#!$%^&*()_+|~=`{}\\\\[\\\\]:\\\\s,\\\\.\";<>?\\\\/'.replace(thousandSeparatorCharEscaped, ''); //.replace(decimalMarkerEscaped, '');\n\n      if (Array.isArray(this.decimalMarker)) {\n        for (const marker of this.decimalMarker) {\n          invalidChars = invalidChars.replace(this._charToRegExpExpression(marker), \"\"\n          /* EMPTY_STRING */\n          );\n        }\n      } else {\n        invalidChars = invalidChars.replace(this._charToRegExpExpression(this.decimalMarker), '');\n      }\n\n      const invalidCharRegexp = new RegExp('[' + invalidChars + ']');\n\n      if (inputValue.match(invalidCharRegexp)) {\n        // eslint-disable-next-line no-param-reassign\n        inputValue = inputValue.substring(0, inputValue.length - 1);\n      } // eslint-disable-next-line no-param-reassign\n\n\n      inputValue = this.checkInputPrecision(inputValue, precision, this.decimalMarker);\n      const strForSep = inputValue.replace(new RegExp(thousandSeparatorCharEscaped, 'g'), '');\n      result = this._formatWithSeparators(strForSep, this.thousandSeparator, this.decimalMarker, precision);\n      const commaShift = result.indexOf(\",\"\n      /* COMMA */\n      ) - inputValue.indexOf(\",\"\n      /* COMMA */\n      );\n      const shiftStep = result.length - inputValue.length;\n\n      if (shiftStep > 0 && result[position] !== this.thousandSeparator) {\n        backspaceShift = true;\n        let _shift = 0;\n\n        do {\n          this._shift.add(position + _shift);\n\n          _shift++;\n        } while (_shift < shiftStep);\n      } else if (result[position - 1] === this.decimalMarker || shiftStep === -4 || shiftStep === -3 || result[position] === \",\"\n      /* COMMA */\n      ) {\n        this._shift.clear();\n\n        this._shift.add(position - 1);\n      } else if (commaShift !== 0 && position > 0 && !(result.indexOf(\",\"\n      /* COMMA */\n      ) >= position && position > 3) || !(result.indexOf(\".\"\n      /* DOT */\n      ) >= position && position > 3) && shiftStep <= 0) {\n        this._shift.clear();\n\n        backspaceShift = true;\n        shift = shiftStep; // eslint-disable-next-line no-param-reassign\n\n        position += shiftStep;\n\n        this._shift.add(position);\n      } else {\n        this._shift.clear();\n      }\n    } else {\n      for ( // eslint-disable-next-line\n      let i = 0, inputSymbol = inputArray[0]; i < inputArray.length; i++, inputSymbol = (_c = inputArray[i]) !== null && _c !== void 0 ? _c : \"\"\n      /* EMPTY_STRING */\n      ) {\n        if (cursor === maskExpression.length) {\n          break;\n        }\n\n        const symbolStarInPattern = (\"*\"\n        /* SYMBOL_STAR */\n        in this.patterns);\n\n        if (this._checkSymbolMask(inputSymbol, (_d = maskExpression[cursor]) !== null && _d !== void 0 ? _d : \"\"\n        /* EMPTY_STRING */\n        ) && maskExpression[cursor + 1] === \"?\"\n        /* SYMBOL_QUESTION */\n        ) {\n          result += inputSymbol;\n          cursor += 2;\n        } else if (maskExpression[cursor + 1] === \"*\"\n        /* SYMBOL_STAR */\n        && multi && this._checkSymbolMask(inputSymbol, (_e = maskExpression[cursor + 2]) !== null && _e !== void 0 ? _e : \"\"\n        /* EMPTY_STRING */\n        )) {\n          result += inputSymbol;\n          cursor += 3;\n          multi = false;\n        } else if (this._checkSymbolMask(inputSymbol, (_f = maskExpression[cursor]) !== null && _f !== void 0 ? _f : \"\"\n        /* EMPTY_STRING */\n        ) && maskExpression[cursor + 1] === \"*\"\n        /* SYMBOL_STAR */\n        && !symbolStarInPattern) {\n          result += inputSymbol;\n          multi = true;\n        } else if (maskExpression[cursor + 1] === \"?\"\n        /* SYMBOL_QUESTION */\n        && this._checkSymbolMask(inputSymbol, (_g = maskExpression[cursor + 2]) !== null && _g !== void 0 ? _g : \"\"\n        /* EMPTY_STRING */\n        )) {\n          result += inputSymbol;\n          cursor += 3;\n        } else if (this._checkSymbolMask(inputSymbol, (_h = maskExpression[cursor]) !== null && _h !== void 0 ? _h : \"\"\n        /* EMPTY_STRING */\n        )) {\n          if (maskExpression[cursor] === \"H\"\n          /* HOURS */\n          ) {\n            if (this.apm ? Number(inputSymbol) > 9 : Number(inputSymbol) > 2) {\n              // eslint-disable-next-line no-param-reassign\n              position = !this.leadZeroDateTime ? position + 1 : position;\n              cursor += 1;\n\n              this._shiftStep(maskExpression, cursor, inputArray.length);\n\n              i--;\n\n              if (this.leadZeroDateTime) {\n                result += '0';\n              }\n\n              continue;\n            }\n          }\n\n          if (maskExpression[cursor] === \"h\"\n          /* HOUR */\n          ) {\n            if (this.apm ? result.length === 1 && Number(result) > 1 || result === '1' && Number(inputSymbol) > 2 || inputValue.slice(cursor - 1, cursor).length === 1 && Number(inputValue.slice(cursor - 1, cursor)) > 2 || inputValue.slice(cursor - 1, cursor) === '1' && Number(inputSymbol) > 2 : result === '2' && Number(inputSymbol) > 3 || (result.slice(cursor - 2, cursor) === '2' || result.slice(cursor - 3, cursor) === '2' || result.slice(cursor - 4, cursor) === '2' || result.slice(cursor - 1, cursor) === '2') && Number(inputSymbol) > 3 && cursor > 10) {\n              // eslint-disable-next-line no-param-reassign\n              position = position + 1;\n              cursor += 1;\n              i--;\n              continue;\n            }\n          }\n\n          if (maskExpression[cursor] === \"m\"\n          /* MINUTE */\n          || maskExpression[cursor] === \"s\"\n          /* SECOND */\n          ) {\n            if (Number(inputSymbol) > 5) {\n              // eslint-disable-next-line no-param-reassign\n              position = !this.leadZeroDateTime ? position + 1 : position;\n              cursor += 1;\n\n              this._shiftStep(maskExpression, cursor, inputArray.length);\n\n              i--;\n\n              if (this.leadZeroDateTime) {\n                result += '0';\n              }\n\n              continue;\n            }\n          }\n\n          const daysCount = 31;\n          const inputValueCursor = inputValue[cursor];\n          const inputValueCursorPlusOne = inputValue[cursor + 1];\n          const inputValueCursorPlusTwo = inputValue[cursor + 2];\n          const inputValueCursorMinusOne = inputValue[cursor - 1];\n          const inputValueCursorMinusTwo = inputValue[cursor - 2];\n          const inputValueCursorMinusThree = inputValue[cursor - 3];\n          const inputValueSliceMinusThreeMinusOne = inputValue.slice(cursor - 3, cursor - 1);\n          const inputValueSliceMinusOnePlusOne = inputValue.slice(cursor - 1, cursor + 1);\n          const inputValueSliceCursorPlusTwo = inputValue.slice(cursor, cursor + 2);\n          const inputValueSliceMinusTwoCursor = inputValue.slice(cursor - 2, cursor);\n\n          if (maskExpression[cursor] === \"d\"\n          /* DAY */\n          ) {\n            const maskStartWithMonth = maskExpression.slice(0, 2) === \"M0\"\n            /* MONTHS */\n            ;\n            const startWithMonthInput = maskExpression.slice(0, 2) === \"M0\"\n            /* MONTHS */\n            && this.specialCharacters.includes(inputValueCursorMinusTwo);\n\n            if (Number(inputSymbol) > 3 && this.leadZeroDateTime || !maskStartWithMonth && (Number(inputValueSliceCursorPlusTwo) > daysCount || Number(inputValueSliceMinusOnePlusOne) > daysCount || this.specialCharacters.includes(inputValueCursorPlusOne)) || (startWithMonthInput ? Number(inputValueSliceMinusOnePlusOne) > daysCount || !this.specialCharacters.includes(inputValueCursor) && this.specialCharacters.includes(inputValueCursorPlusTwo) || this.specialCharacters.includes(inputValueCursor) : Number(inputValueSliceCursorPlusTwo) > daysCount || this.specialCharacters.includes(inputValueCursorPlusOne))) {\n              // eslint-disable-next-line no-param-reassign\n              position = !this.leadZeroDateTime ? position + 1 : position;\n              cursor += 1;\n\n              this._shiftStep(maskExpression, cursor, inputArray.length);\n\n              i--;\n\n              if (this.leadZeroDateTime) {\n                result += '0';\n              }\n\n              continue;\n            }\n          }\n\n          if (maskExpression[cursor] === \"M\"\n          /* MONTH */\n          ) {\n            const monthsCount = 12; // mask without day\n\n            const withoutDays = cursor === 0 && (Number(inputSymbol) > 2 || Number(inputValueSliceCursorPlusTwo) > monthsCount || this.specialCharacters.includes(inputValueCursorPlusOne)); // day<10 && month<12 for input\n\n            const specialChart = maskExpression.slice(cursor + 2, cursor + 3);\n            const day1monthInput = inputValueSliceMinusThreeMinusOne.includes(specialChart) && (this.specialCharacters.includes(inputValueCursorMinusTwo) && Number(inputValueSliceMinusOnePlusOne) > monthsCount && !this.specialCharacters.includes(inputValueCursor) || this.specialCharacters.includes(inputValueCursor) || this.specialCharacters.includes(inputValueCursorMinusThree) && Number(inputValueSliceMinusTwoCursor) > monthsCount && !this.specialCharacters.includes(inputValueCursorMinusOne) || this.specialCharacters.includes(inputValueCursorMinusOne)); //  month<12 && day<10 for input\n\n            const day2monthInput = Number(inputValueSliceMinusThreeMinusOne) <= daysCount && !this.specialCharacters.includes(inputValueSliceMinusThreeMinusOne) && this.specialCharacters.includes(inputValueCursorMinusOne) && (Number(inputValueSliceCursorPlusTwo) > monthsCount || this.specialCharacters.includes(inputValueCursorPlusOne)); // cursor === 5 && without days\n\n            const day2monthInputDot = Number(inputValueSliceCursorPlusTwo) > monthsCount && cursor === 5 || this.specialCharacters.includes(inputValueCursorPlusOne) && cursor === 5; // // day<10 && month<12 for paste whole data\n\n            const day1monthPaste = Number(inputValueSliceMinusThreeMinusOne) > daysCount && !this.specialCharacters.includes(inputValueSliceMinusThreeMinusOne) && !this.specialCharacters.includes(inputValueSliceMinusTwoCursor) && Number(inputValueSliceMinusTwoCursor) > monthsCount; // 10<day<31 && month<12 for paste whole data\n\n            const day2monthPaste = Number(inputValueSliceMinusThreeMinusOne) <= daysCount && !this.specialCharacters.includes(inputValueSliceMinusThreeMinusOne) && !this.specialCharacters.includes(inputValueCursorMinusOne) && Number(inputValueSliceMinusOnePlusOne) > monthsCount;\n\n            if (Number(inputSymbol) > 1 && this.leadZeroDateTime || withoutDays || day1monthInput || day2monthPaste || day1monthPaste || day2monthInput || day2monthInputDot && !this.leadZeroDateTime) {\n              // eslint-disable-next-line no-param-reassign\n              position = !this.leadZeroDateTime ? position + 1 : position;\n              cursor += 1;\n\n              this._shiftStep(maskExpression, cursor, inputArray.length);\n\n              i--;\n\n              if (this.leadZeroDateTime) {\n                result += '0';\n              }\n\n              continue;\n            }\n          }\n\n          result += inputSymbol;\n          cursor++;\n        } else if (inputSymbol === \" \"\n        /* WHITE_SPACE */\n        && maskExpression[cursor] === \" \"\n        /* WHITE_SPACE */\n        || inputSymbol === \"/\"\n        /* SLASH */\n        && maskExpression[cursor] === \"/\"\n        /* SLASH */\n        ) {\n          result += inputSymbol;\n          cursor++;\n        } else if (this.specialCharacters.indexOf((_j = maskExpression[cursor]) !== null && _j !== void 0 ? _j : \"\"\n        /* EMPTY_STRING */\n        ) !== -1) {\n          result += maskExpression[cursor];\n          cursor++;\n\n          this._shiftStep(maskExpression, cursor, inputArray.length);\n\n          i--;\n        } else if (maskExpression[cursor] === \"9\"\n        /* NUMBER_NINE */\n        && this.showMaskTyped) {\n          this._shiftStep(maskExpression, cursor, inputArray.length);\n        } else if (this.patterns[(_k = maskExpression[cursor]) !== null && _k !== void 0 ? _k : \"\"\n        /* EMPTY_STRING */\n        ] && ((_m = this.patterns[(_l = maskExpression[cursor]) !== null && _l !== void 0 ? _l : \"\"\n        /* EMPTY_STRING */\n        ]) === null || _m === void 0 ? void 0 : _m.optional)) {\n          if (!!inputArray[cursor] && maskExpression !== '099.099.099.099' && maskExpression !== '000.000.000-00' && maskExpression !== '00.000.000/0000-00' && !maskExpression.match(/^9+\\.0+$/) && !((_p = this.patterns[(_o = maskExpression[cursor]) !== null && _o !== void 0 ? _o : \"\"\n          /* EMPTY_STRING */\n          ]) === null || _p === void 0 ? void 0 : _p.optional)) {\n            result += inputArray[cursor];\n          }\n\n          if (maskExpression.includes(\"9\"\n          /* NUMBER_NINE */\n          + \"*\"\n          /* SYMBOL_STAR */\n          ) && maskExpression.includes(\"0\"\n          /* NUMBER_ZERO */\n          + \"*\"\n          /* SYMBOL_STAR */\n          )) {\n            cursor++;\n          }\n\n          cursor++;\n          i--;\n        } else if (this.maskExpression[cursor + 1] === \"*\"\n        /* SYMBOL_STAR */\n        && this._findSpecialChar((_q = this.maskExpression[cursor + 2]) !== null && _q !== void 0 ? _q : \"\"\n        /* EMPTY_STRING */\n        ) && this._findSpecialChar(inputSymbol) === this.maskExpression[cursor + 2] && multi) {\n          cursor += 3;\n          result += inputSymbol;\n        } else if (this.maskExpression[cursor + 1] === \"?\"\n        /* SYMBOL_QUESTION */\n        && this._findSpecialChar((_r = this.maskExpression[cursor + 2]) !== null && _r !== void 0 ? _r : \"\"\n        /* EMPTY_STRING */\n        ) && this._findSpecialChar(inputSymbol) === this.maskExpression[cursor + 2] && multi) {\n          cursor += 3;\n          result += inputSymbol;\n        } else if (this.showMaskTyped && this.specialCharacters.indexOf(inputSymbol) < 0 && inputSymbol !== this.placeHolderCharacter && this.placeHolderCharacter.length === 1) {\n          stepBack = true;\n        }\n      }\n    }\n\n    if (result.length + 1 === maskExpression.length && this.specialCharacters.indexOf((_s = maskExpression[maskExpression.length - 1]) !== null && _s !== void 0 ? _s : \"\"\n    /* EMPTY_STRING */\n    ) !== -1) {\n      result += maskExpression[maskExpression.length - 1];\n    }\n\n    let newPosition = position + 1;\n\n    while (this._shift.has(newPosition)) {\n      shift++;\n      newPosition++;\n    }\n\n    let actualShift = justPasted && !maskExpression.startsWith(\"separator\"\n    /* SEPARATOR */\n    ) ? cursor : this._shift.has(position) ? shift : 0;\n\n    if (stepBack) {\n      actualShift--;\n    }\n\n    cb(actualShift, backspaceShift);\n\n    if (shift < 0) {\n      this._shift.clear();\n    }\n\n    let onlySpecial = false;\n\n    if (backspaced) {\n      onlySpecial = inputArray.every(char => this.specialCharacters.includes(char));\n    }\n\n    let res = `${this.prefix}${onlySpecial ? \"\"\n    /* EMPTY_STRING */\n    : result}${this.showMaskTyped ? '' : this.suffix}`;\n\n    if (result.length === 0) {\n      res = !this.dropSpecialCharacters ? `${this.prefix}${result}` : `${result}`;\n    }\n\n    if (result.includes(\"-\"\n    /* MINUS */\n    ) && this.prefix && this.allowNegativeNumbers) {\n      if (backspaced && result === \"-\"\n      /* MINUS */\n      ) {\n        return '';\n      }\n\n      res = `${\"-\"\n      /* MINUS */\n      }${this.prefix}${result.split(\"-\"\n      /* MINUS */\n      ).join(\"\"\n      /* EMPTY_STRING */\n      )}${this.suffix}`;\n    }\n\n    return res;\n  }\n\n  _findDropSpecialChar(inputSymbol) {\n    if (Array.isArray(this.dropSpecialCharacters)) {\n      return this.dropSpecialCharacters.find(val => val === inputSymbol);\n    }\n\n    return this._findSpecialChar(inputSymbol);\n  }\n\n  _findSpecialChar(inputSymbol) {\n    return this.specialCharacters.find(val => val === inputSymbol);\n  }\n\n  _checkSymbolMask(inputSymbol, maskSymbol) {\n    var _a, _b, _c;\n\n    this.patterns = this.customPattern ? this.customPattern : this.patterns;\n    return (_c = ((_a = this.patterns[maskSymbol]) === null || _a === void 0 ? void 0 : _a.pattern) && ((_b = this.patterns[maskSymbol]) === null || _b === void 0 ? void 0 : _b.pattern.test(inputSymbol))) !== null && _c !== void 0 ? _c : false;\n  }\n\n  _stripToDecimal(str) {\n    return str.split(\"\"\n    /* EMPTY_STRING */\n    ).filter((i, idx) => {\n      const isDecimalMarker = typeof this.decimalMarker === 'string' ? i === this.decimalMarker : // TODO (inepipenko) use utility type\n      this.decimalMarker.includes(i);\n      return i.match('^-?\\\\d') || i === this.thousandSeparator || isDecimalMarker || i === \"-\"\n      /* MINUS */\n      && idx === 0 && this.allowNegativeNumbers;\n    }).join(\"\"\n    /* EMPTY_STRING */\n    );\n  }\n\n  _charToRegExpExpression(char) {\n    // if (Array.isArray(char)) {\n    // \treturn char.map((v) => ('[\\\\^$.|?*+()'.indexOf(v) >= 0 ? `\\\\${v}` : v)).join('|');\n    // }\n    if (char) {\n      const charsToEscape = '[\\\\^$.|?*+()';\n      return char === ' ' ? '\\\\s' : charsToEscape.indexOf(char) >= 0 ? `\\\\${char}` : char;\n    }\n\n    return char;\n  }\n\n  _shiftStep(maskExpression, cursor, inputLength) {\n    const shiftStep = /[*?]/g.test(maskExpression.slice(0, cursor)) ? inputLength : cursor;\n\n    this._shift.add(shiftStep + this.prefix.length || 0);\n  }\n\n  _compareOrIncludes(value, comparedValue, excludedValue) {\n    return Array.isArray(comparedValue) ? comparedValue.filter(v => v !== excludedValue).includes(value) : value === comparedValue;\n  }\n\n  _validIP(valuesIP) {\n    return !(valuesIP.length === 4 && !valuesIP.some((value, index) => {\n      if (valuesIP.length !== index + 1) {\n        return value === \"\"\n        /* EMPTY_STRING */\n        || Number(value) > 255;\n      }\n\n      return value === \"\"\n      /* EMPTY_STRING */\n      || Number(value.substring(0, 3)) > 255;\n    }));\n  }\n\n  _splitPercentZero(value) {\n    const decimalIndex = typeof this.decimalMarker === 'string' ? value.indexOf(this.decimalMarker) : value.indexOf(\".\"\n    /* DOT */\n    );\n\n    if (decimalIndex === -1) {\n      const parsedValue = parseInt(value, 10);\n      return isNaN(parsedValue) ? \"\"\n      /* EMPTY_STRING */\n      : parsedValue.toString();\n    } else {\n      const integerPart = parseInt(value.substring(0, decimalIndex), 10);\n      const decimalPart = value.substring(decimalIndex + 1);\n      const integerString = isNaN(integerPart) ? '' : integerPart.toString();\n      const decimal = typeof this.decimalMarker === 'string' ? this.decimalMarker : \".\"\n      /* DOT */\n      ;\n      return integerString === \"\"\n      /* EMPTY_STRING */\n      ? \"\"\n      /* EMPTY_STRING */\n      : integerString + decimal + decimalPart;\n    }\n  }\n\n}\n\nNgxMaskApplierService.ɵfac = function NgxMaskApplierService_Factory(t) {\n  return new (t || NgxMaskApplierService)(i0.ɵɵinject(NGX_MASK_CONFIG));\n};\n\nNgxMaskApplierService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: NgxMaskApplierService,\n  factory: NgxMaskApplierService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NgxMaskApplierService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: undefined,\n      decorators: [{\n        type: Inject,\n        args: [NGX_MASK_CONFIG]\n      }]\n    }];\n  }, null);\n})();\n\nclass NgxMaskService extends NgxMaskApplierService {\n  constructor(document, _config, _elementRef, _renderer) {\n    super(_config);\n    this.document = document;\n    this._config = _config;\n    this._elementRef = _elementRef;\n    this._renderer = _renderer;\n    this.isNumberValue = false;\n    this.maskIsShown = '';\n    this.selStart = null;\n    this.selEnd = null;\n    /**\n     * Whether we are currently in writeValue function, in this case when applying the mask we don't want to trigger onChange function,\n     * since writeValue should be a one way only process of writing the DOM value based on the Angular model value.\n     */\n\n    this.writingValue = false;\n    this.maskChanged = false;\n    this._maskExpressionArray = [];\n    this.triggerOnMaskChange = false;\n    this._emitValue = false;\n    this._previousValue = '';\n    this._currentValue = ''; // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n\n    this.onChange = _ => {};\n  } // eslint-disable-next-line complexity\n\n\n  applyMask(inputValue, maskExpression, position = 0, justPasted = false, backspaced = false, // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n  cb = () => {}) {\n    var _a, _b;\n\n    if (!maskExpression) {\n      return inputValue !== this.actualValue ? this.actualValue : inputValue;\n    }\n\n    this.maskIsShown = this.showMaskTyped ? this.showMaskInInput() : \"\"\n    /* EMPTY_STRING */\n    ;\n\n    if (this.maskExpression === \"IP\"\n    /* IP */\n    && this.showMaskTyped) {\n      this.maskIsShown = this.showMaskInInput(inputValue || \"#\"\n      /* HASH */\n      );\n    }\n\n    if (this.maskExpression === \"CPF_CNPJ\"\n    /* CPF_CNPJ */\n    && this.showMaskTyped) {\n      this.maskIsShown = this.showMaskInInput(inputValue || \"#\"\n      /* HASH */\n      );\n    }\n\n    if (!inputValue && this.showMaskTyped) {\n      this.formControlResult(this.prefix);\n      return this.prefix + this.maskIsShown + this.suffix;\n    }\n\n    const getSymbol = !!inputValue && typeof this.selStart === 'number' ? (_a = inputValue[this.selStart]) !== null && _a !== void 0 ? _a : \"\"\n    /* EMPTY_STRING */\n    : \"\"\n    /* EMPTY_STRING */\n    ;\n    let newInputValue = '';\n\n    if (this.hiddenInput !== undefined && !this.writingValue) {\n      let actualResult = inputValue && inputValue.length === 1 ? inputValue.split(\"\"\n      /* EMPTY_STRING */\n      ) : this.actualValue.split(\"\"\n      /* EMPTY_STRING */\n      ); // eslint-disable  @typescript-eslint/no-unused-expressions\n      // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n\n      if (typeof this.selStart === 'object' && typeof this.selEnd === 'object') {\n        this.selStart = Number(this.selStart);\n        this.selEnd = Number(this.selEnd);\n      } else {\n        inputValue !== \"\"\n        /* EMPTY_STRING */\n        && actualResult.length ? typeof this.selStart === 'number' && typeof this.selEnd === 'number' ? inputValue.length > actualResult.length ? actualResult.splice(this.selStart, 0, getSymbol) : inputValue.length < actualResult.length ? actualResult.length - inputValue.length === 1 ? backspaced ? actualResult.splice(this.selStart - 1, 1) : actualResult.splice(inputValue.length - 1, 1) : actualResult.splice(this.selStart, this.selEnd - this.selStart) : null : null : actualResult = [];\n      }\n\n      if (this.showMaskTyped) {\n        if (!this.hiddenInput) {\n          // eslint-disable-next-line no-param-reassign\n          inputValue = this.removeMask(inputValue);\n        }\n      } // eslint-enable  @typescript-eslint/no-unused-expressions\n\n\n      newInputValue = this.actualValue.length && actualResult.length <= inputValue.length ? this.shiftTypedSymbols(actualResult.join(\"\"\n      /* EMPTY_STRING */\n      )) : inputValue;\n    }\n\n    if (justPasted && (this.hiddenInput || !this.hiddenInput)) {\n      newInputValue = inputValue;\n    }\n\n    if (backspaced && this.specialCharacters.indexOf((_b = this.maskExpression[position]) !== null && _b !== void 0 ? _b : \"\"\n    /* EMPTY_STRING */\n    ) !== -1 && this.showMaskTyped) {\n      newInputValue = this._currentValue;\n    }\n\n    if (this.deletedSpecialCharacter && position) {\n      if (this.specialCharacters.includes(this.actualValue.slice(position, position + 1))) {\n        // eslint-disable-next-line no-param-reassign\n        position = position + 1;\n      } else if (maskExpression.slice(position - 1, position + 1) !== \"M0\"\n      /* MONTHS */\n      ) {\n        // eslint-disable-next-line no-param-reassign\n        position = position - 2;\n      } // eslint-disable-next-line no-param-reassign\n\n\n      this.deletedSpecialCharacter = false;\n    }\n\n    if (this.showMaskTyped && this.placeHolderCharacter.length === 1 && !this.leadZeroDateTime) {\n      // eslint-disable-next-line no-param-reassign\n      inputValue = this.removeMask(inputValue);\n    }\n\n    if (this.maskChanged) {\n      newInputValue = inputValue;\n    } else {\n      newInputValue = Boolean(newInputValue) && newInputValue.length ? newInputValue : inputValue;\n    }\n\n    if (this.showMaskTyped && this.keepCharacterPositions && this.actualValue && !justPasted) {\n      const value = this.dropSpecialCharacters ? this.removeMask(this.actualValue) : this.actualValue;\n      this.formControlResult(value);\n      return this.actualValue ? this.actualValue : this.prefix + this.maskIsShown + this.suffix;\n    }\n\n    const result = super.applyMask(newInputValue, maskExpression, position, justPasted, backspaced, cb);\n    this.actualValue = this.getActualValue(result); // handle some separator implications:\n    // a.) adjust decimalMarker default (. -> ,) if thousandSeparator is a dot\n\n    if (this.thousandSeparator === \".\"\n    /* DOT */\n    && this.decimalMarker === \".\"\n    /* DOT */\n    ) {\n      this.decimalMarker = \",\"\n      /* COMMA */\n      ;\n    } // b) remove decimal marker from list of special characters to mask\n\n\n    if (this.maskExpression.startsWith(\"separator\"\n    /* SEPARATOR */\n    ) && this.dropSpecialCharacters === true) {\n      this.specialCharacters = this.specialCharacters.filter(item => !this._compareOrIncludes(item, this.decimalMarker, this.thousandSeparator) //item !== this.decimalMarker, // !\n      );\n    }\n\n    if (result || result === '') {\n      this._previousValue = this._currentValue;\n      this._currentValue = result;\n      this._emitValue = this._previousValue !== this._currentValue || this.maskChanged || this._previousValue === this._currentValue && justPasted;\n    }\n\n    this._emitValue ? this.formControlResult(result) : '';\n\n    if (!this.showMaskTyped || this.showMaskTyped && this.hiddenInput) {\n      if (this.hiddenInput) {\n        if (backspaced) {\n          return this.hideInput(result, this.maskExpression);\n        }\n\n        return this.hideInput(result, this.maskExpression) + this.maskIsShown.slice(result.length);\n      }\n\n      return result;\n    }\n\n    const resLen = result.length;\n    const prefNmask = this.prefix + this.maskIsShown + this.suffix;\n\n    if (this.maskExpression.includes(\"H\"\n    /* HOURS */\n    )) {\n      const countSkipedSymbol = this._numberSkipedSymbols(result);\n\n      return result + prefNmask.slice(resLen + countSkipedSymbol);\n    } else if (this.maskExpression === \"IP\"\n    /* IP */\n    || this.maskExpression === \"CPF_CNPJ\"\n    /* CPF_CNPJ */\n    ) {\n      return result + prefNmask;\n    }\n\n    return result + prefNmask.slice(resLen);\n  } // get the number of characters that were shifted\n\n\n  _numberSkipedSymbols(value) {\n    const regex = /(^|\\D)(\\d\\D)/g;\n    let match = regex.exec(value);\n    let countSkipedSymbol = 0;\n\n    while (match != null) {\n      countSkipedSymbol += 1;\n      match = regex.exec(value);\n    }\n\n    return countSkipedSymbol;\n  }\n\n  applyValueChanges(position, justPasted, backspaced, // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n  cb = () => {}) {\n    var _a;\n\n    const formElement = (_a = this._elementRef) === null || _a === void 0 ? void 0 : _a.nativeElement;\n\n    if (!formElement) {\n      return;\n    }\n\n    formElement.value = this.applyMask(formElement.value, this.maskExpression, position, justPasted, backspaced, cb);\n\n    if (formElement === this._getActiveElement()) {\n      return;\n    }\n\n    this.clearIfNotMatchFn();\n  }\n\n  hideInput(inputValue, maskExpression) {\n    return inputValue.split(\"\"\n    /* EMPTY_STRING */\n    ).map((curr, index) => {\n      var _a, _b, _c, _d, _e;\n\n      if (this.patterns && this.patterns[(_a = maskExpression[index]) !== null && _a !== void 0 ? _a : \"\"\n      /* EMPTY_STRING */\n      ] && ((_c = this.patterns[(_b = maskExpression[index]) !== null && _b !== void 0 ? _b : \"\"\n      /* EMPTY_STRING */\n      ]) === null || _c === void 0 ? void 0 : _c.symbol)) {\n        return (_e = this.patterns[(_d = maskExpression[index]) !== null && _d !== void 0 ? _d : \"\"\n        /* EMPTY_STRING */\n        ]) === null || _e === void 0 ? void 0 : _e.symbol;\n      }\n\n      return curr;\n    }).join(\"\"\n    /* EMPTY_STRING */\n    );\n  } // this function is not necessary, it checks result against maskExpression\n\n\n  getActualValue(res) {\n    const compare = res.split(\"\"\n    /* EMPTY_STRING */\n    ).filter((symbol, i) => {\n      var _a;\n\n      const maskChar = (_a = this.maskExpression[i]) !== null && _a !== void 0 ? _a : \"\"\n      /* EMPTY_STRING */\n      ;\n      return this._checkSymbolMask(symbol, maskChar) || this.specialCharacters.includes(maskChar) && symbol === maskChar;\n    });\n\n    if (compare.join(\"\"\n    /* EMPTY_STRING */\n    ) === res) {\n      return compare.join(\"\"\n      /* EMPTY_STRING */\n      );\n    }\n\n    return res;\n  }\n\n  shiftTypedSymbols(inputValue) {\n    let symbolToReplace = '';\n    const newInputValue = inputValue && inputValue.split(\"\"\n    /* EMPTY_STRING */\n    ).map((currSymbol, index) => {\n      var _a;\n\n      if (this.specialCharacters.includes((_a = inputValue[index + 1]) !== null && _a !== void 0 ? _a : \"\"\n      /* EMPTY_STRING */\n      ) && inputValue[index + 1] !== this.maskExpression[index + 1]) {\n        symbolToReplace = currSymbol;\n        return inputValue[index + 1];\n      }\n\n      if (symbolToReplace.length) {\n        const replaceSymbol = symbolToReplace;\n        symbolToReplace = \"\"\n        /* EMPTY_STRING */\n        ;\n        return replaceSymbol;\n      }\n\n      return currSymbol;\n    }) || [];\n    return newInputValue.join(\"\"\n    /* EMPTY_STRING */\n    );\n  }\n  /**\n   * Convert number value to string\n   * 3.1415 -> '3.1415'\n   * 1e-7 -> '0.0000001'\n   */\n\n\n  numberToString(value) {\n    if (!value && value !== 0 || this.maskExpression.startsWith(\"separator\"\n    /* SEPARATOR */\n    ) && (this.leadZero || !this.dropSpecialCharacters) || this.maskExpression.startsWith(\"separator\"\n    /* SEPARATOR */\n    ) && this.separatorLimit.length > 14 && String(value).length > 14) {\n      return String(value);\n    }\n\n    return Number(value).toLocaleString('fullwide', {\n      useGrouping: false,\n      maximumFractionDigits: 20\n    }).replace(`/${\"-\"\n    /* MINUS */\n    }/`, \"-\"\n    /* MINUS */\n    );\n  }\n\n  showMaskInInput(inputVal) {\n    if (this.showMaskTyped && !!this.shownMaskExpression) {\n      if (this.maskExpression.length !== this.shownMaskExpression.length) {\n        throw new Error('Mask expression must match mask placeholder length');\n      } else {\n        return this.shownMaskExpression;\n      }\n    } else if (this.showMaskTyped) {\n      if (inputVal) {\n        if (this.maskExpression === \"IP\"\n        /* IP */\n        ) {\n          return this._checkForIp(inputVal);\n        }\n\n        if (this.maskExpression === \"CPF_CNPJ\"\n        /* CPF_CNPJ */\n        ) {\n          return this._checkForCpfCnpj(inputVal);\n        }\n      }\n\n      if (this.placeHolderCharacter.length === this.maskExpression.length) {\n        return this.placeHolderCharacter;\n      }\n\n      return this.maskExpression.replace(/\\w/g, this.placeHolderCharacter);\n    }\n\n    return '';\n  }\n\n  clearIfNotMatchFn() {\n    var _a;\n\n    const formElement = (_a = this._elementRef) === null || _a === void 0 ? void 0 : _a.nativeElement;\n\n    if (!formElement) {\n      return;\n    }\n\n    if (this.clearIfNotMatch && this.prefix.length + this.maskExpression.length + this.suffix.length !== formElement.value.replace(this.placeHolderCharacter, \"\"\n    /* EMPTY_STRING */\n    ).length) {\n      this.formElementProperty = ['value', \"\"\n      /* EMPTY_STRING */\n      ];\n      this.applyMask('', this.maskExpression);\n    }\n  }\n\n  set formElementProperty([name, value]) {\n    if (!this._renderer || !this._elementRef) {\n      return;\n    }\n\n    Promise.resolve().then(() => {\n      var _a, _b;\n\n      return (_a = this._renderer) === null || _a === void 0 ? void 0 : _a.setProperty((_b = this._elementRef) === null || _b === void 0 ? void 0 : _b.nativeElement, name, value);\n    });\n  }\n\n  checkDropSpecialCharAmount(mask) {\n    const chars = mask.split(\"\"\n    /* EMPTY_STRING */\n    ).filter(item => this._findDropSpecialChar(item));\n    return chars.length;\n  }\n\n  removeMask(inputValue) {\n    return this._removeMask(this._removeSuffix(this._removePrefix(inputValue)), this.specialCharacters.concat('_').concat(this.placeHolderCharacter));\n  }\n\n  _checkForIp(inputVal) {\n    var _a;\n\n    if (inputVal === \"#\"\n    /* HASH */\n    ) {\n      return `${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;\n    }\n\n    const arr = [];\n\n    for (let i = 0; i < inputVal.length; i++) {\n      const value = (_a = inputVal[i]) !== null && _a !== void 0 ? _a : \"\"\n      /* EMPTY_STRING */\n      ;\n\n      if (!value) {\n        continue;\n      }\n\n      if (value.match('\\\\d')) {\n        arr.push(value);\n      }\n    }\n\n    if (arr.length <= 3) {\n      return `${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;\n    }\n\n    if (arr.length > 3 && arr.length <= 6) {\n      return `${this.placeHolderCharacter}.${this.placeHolderCharacter}`;\n    }\n\n    if (arr.length > 6 && arr.length <= 9) {\n      return this.placeHolderCharacter;\n    }\n\n    if (arr.length > 9 && arr.length <= 12) {\n      return '';\n    }\n\n    return '';\n  }\n\n  _checkForCpfCnpj(inputVal) {\n    var _a;\n\n    const cpf = `${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` + `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` + `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` + `-${this.placeHolderCharacter}${this.placeHolderCharacter}`;\n    const cnpj = `${this.placeHolderCharacter}${this.placeHolderCharacter}` + `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` + `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` + `/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` + `-${this.placeHolderCharacter}${this.placeHolderCharacter}`;\n\n    if (inputVal === \"#\"\n    /* HASH */\n    ) {\n      return cpf;\n    }\n\n    const arr = [];\n\n    for (let i = 0; i < inputVal.length; i++) {\n      const value = (_a = inputVal[i]) !== null && _a !== void 0 ? _a : \"\"\n      /* EMPTY_STRING */\n      ;\n\n      if (!value) {\n        continue;\n      }\n\n      if (value.match('\\\\d')) {\n        arr.push(value);\n      }\n    }\n\n    if (arr.length <= 3) {\n      return cpf.slice(arr.length, cpf.length);\n    }\n\n    if (arr.length > 3 && arr.length <= 6) {\n      return cpf.slice(arr.length + 1, cpf.length);\n    }\n\n    if (arr.length > 6 && arr.length <= 9) {\n      return cpf.slice(arr.length + 2, cpf.length);\n    }\n\n    if (arr.length > 9 && arr.length < 11) {\n      return cpf.slice(arr.length + 3, cpf.length);\n    }\n\n    if (arr.length === 11) {\n      return '';\n    }\n\n    if (arr.length === 12) {\n      if (inputVal.length === 17) {\n        return cnpj.slice(16, cnpj.length);\n      }\n\n      return cnpj.slice(15, cnpj.length);\n    }\n\n    if (arr.length > 12 && arr.length <= 14) {\n      return cnpj.slice(arr.length + 4, cnpj.length);\n    }\n\n    return '';\n  }\n  /**\n   * Recursively determine the current active element by navigating the Shadow DOM until the Active Element is found.\n   */\n\n\n  _getActiveElement(document = this.document) {\n    var _a;\n\n    const shadowRootEl = (_a = document === null || document === void 0 ? void 0 : document.activeElement) === null || _a === void 0 ? void 0 : _a.shadowRoot;\n\n    if (!(shadowRootEl === null || shadowRootEl === void 0 ? void 0 : shadowRootEl.activeElement)) {\n      return document.activeElement;\n    } else {\n      return this._getActiveElement(shadowRootEl);\n    }\n  }\n  /**\n   * Propogates the input value back to the Angular model by triggering the onChange function. It won't do this if writingValue\n   * is true. If that is true it means we are currently in the writeValue function, which is supposed to only update the actual\n   * DOM element based on the Angular model value. It should be a one way process, i.e. writeValue should not be modifying the Angular\n   * model value too. Therefore, we don't trigger onChange in this scenario.\n   * @param inputValue the current form input value\n   */\n\n\n  formControlResult(inputValue) {\n    if (this.writingValue || !this.triggerOnMaskChange && this.maskChanged) {\n      this.maskChanged ? this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(inputValue)))))) : '';\n      this.maskChanged = false;\n      return;\n    }\n\n    if (Array.isArray(this.dropSpecialCharacters)) {\n      this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(inputValue)), this.dropSpecialCharacters)))));\n    } else if (this.dropSpecialCharacters || !this.dropSpecialCharacters && this.prefix === inputValue) {\n      this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(inputValue))))));\n    } else {\n      this.onChange(this.outputTransformFn(this._toNumber(inputValue)));\n    }\n  }\n\n  _toNumber(value) {\n    if (!this.isNumberValue || value === \"\"\n    /* EMPTY_STRING */\n    ) {\n      return value;\n    }\n\n    if (this.maskExpression.startsWith(\"separator\"\n    /* SEPARATOR */\n    ) && (this.leadZero || !this.dropSpecialCharacters)) {\n      return value;\n    }\n\n    if (String(value).length > 16 && this.separatorLimit.length > 14) {\n      return String(value);\n    }\n\n    const num = Number(value);\n\n    if (this.maskExpression.startsWith(\"separator\"\n    /* SEPARATOR */\n    ) && Number.isNaN(num)) {\n      const val = String(value).replace(',', '.');\n      return Number(val);\n    }\n\n    return Number.isNaN(num) ? value : num;\n  }\n\n  _removeMask(value, specialCharactersForRemove) {\n    if (this.maskExpression.startsWith(\"percent\"\n    /* PERCENT */\n    ) && value.includes(\".\"\n    /* DOT */\n    )) {\n      return value;\n    }\n\n    return value ? value.replace(this._regExpForRemove(specialCharactersForRemove), \"\"\n    /* EMPTY_STRING */\n    ) : value;\n  }\n\n  _removePrefix(value) {\n    if (!this.prefix) {\n      return value;\n    }\n\n    return value ? value.replace(this.prefix, \"\"\n    /* EMPTY_STRING */\n    ) : value;\n  }\n\n  _removeSuffix(value) {\n    if (!this.suffix) {\n      return value;\n    }\n\n    return value ? value.replace(this.suffix, \"\"\n    /* EMPTY_STRING */\n    ) : value;\n  }\n\n  _retrieveSeparatorValue(result) {\n    let specialCharacters = Array.isArray(this.dropSpecialCharacters) ? this.specialCharacters.filter(v => {\n      return this.dropSpecialCharacters.includes(v);\n    }) : this.specialCharacters;\n\n    if (!this.deletedSpecialCharacter && this._checkPatternForSpace() && result.includes(\" \"\n    /* WHITE_SPACE */\n    ) && this.maskExpression.includes(\"*\"\n    /* SYMBOL_STAR */\n    )) {\n      specialCharacters = specialCharacters.filter(char => char !== \" \"\n      /* WHITE_SPACE */\n      );\n    }\n\n    return this._removeMask(result, specialCharacters);\n  }\n\n  _regExpForRemove(specialCharactersForRemove) {\n    return new RegExp(specialCharactersForRemove.map(item => `\\\\${item}`).join('|'), 'gi');\n  }\n\n  _replaceDecimalMarkerToDot(value) {\n    const markers = Array.isArray(this.decimalMarker) ? this.decimalMarker : [this.decimalMarker];\n    return value.replace(this._regExpForRemove(markers), \".\"\n    /* DOT */\n    );\n  }\n\n  _checkSymbols(result) {\n    if (result === \"\"\n    /* EMPTY_STRING */\n    ) {\n      return result;\n    }\n\n    if (this.maskExpression.startsWith(\"percent\"\n    /* PERCENT */\n    ) && this.decimalMarker === \",\"\n    /* COMMA */\n    ) {\n      // eslint-disable-next-line no-param-reassign\n      result = result.replace(\",\"\n      /* COMMA */\n      , \".\"\n      /* DOT */\n      );\n    }\n\n    const separatorPrecision = this._retrieveSeparatorPrecision(this.maskExpression);\n\n    const separatorValue = this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(result));\n\n    if (!this.isNumberValue) {\n      return separatorValue;\n    }\n\n    if (separatorPrecision) {\n      if (result === this.decimalMarker) {\n        return null;\n      }\n\n      if (this.separatorLimit.length > 14) {\n        return String(separatorValue);\n      }\n\n      return this._checkPrecision(this.maskExpression, separatorValue);\n    } else {\n      return separatorValue;\n    }\n  }\n\n  _checkPatternForSpace() {\n    var _a, _b, _c;\n\n    for (const key in this.patterns) {\n      // eslint-disable-next-line no-prototype-builtins\n      if (this.patterns[key] && ((_a = this.patterns[key]) === null || _a === void 0 ? void 0 : _a.hasOwnProperty('pattern'))) {\n        const patternString = (_b = this.patterns[key]) === null || _b === void 0 ? void 0 : _b.pattern.toString();\n        const pattern = (_c = this.patterns[key]) === null || _c === void 0 ? void 0 : _c.pattern;\n\n        if ((patternString === null || patternString === void 0 ? void 0 : patternString.includes(\" \"\n        /* WHITE_SPACE */\n        )) && (pattern === null || pattern === void 0 ? void 0 : pattern.test(this.maskExpression))) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  } // TODO should think about helpers or separting decimal precision to own property\n\n\n  _retrieveSeparatorPrecision(maskExpretion) {\n    const matcher = maskExpretion.match(new RegExp(`^separator\\\\.([^d]*)`));\n    return matcher ? Number(matcher[1]) : null;\n  }\n\n  _checkPrecision(separatorExpression, separatorValue) {\n    const separatorPrecision = separatorExpression.slice(10, 11);\n\n    if (separatorExpression.indexOf('2') > 0 || this.leadZero && Number(separatorPrecision) > 1) {\n      if (this.decimalMarker === \",\"\n      /* COMMA */\n      && this.leadZero) {\n        // eslint-disable-next-line no-param-reassign\n        separatorValue = separatorValue.replace(',', '.');\n      }\n\n      return this.leadZero ? Number(separatorValue).toFixed(Number(separatorPrecision)) : Number(separatorValue).toFixed(2);\n    }\n\n    return this.numberToString(separatorValue);\n  }\n\n  _repeatPatternSymbols(maskExp) {\n    return maskExp.match(/{[0-9]+}/) && maskExp.split(\"\"\n    /* EMPTY_STRING */\n    ).reduce((accum, currVal, index) => {\n      this._start = currVal === \"{\"\n      /* CURLY_BRACKETS_LEFT */\n      ? index : this._start;\n\n      if (currVal !== \"}\"\n      /* CURLY_BRACKETS_RIGHT */\n      ) {\n        return this._findSpecialChar(currVal) ? accum + currVal : accum;\n      }\n\n      this._end = index;\n      const repeatNumber = Number(maskExp.slice(this._start + 1, this._end));\n      const replaceWith = new Array(repeatNumber + 1).join(maskExp[this._start - 1]);\n\n      if (maskExp.slice(0, this._start).length > 1 && maskExp.includes(\"S\"\n      /* LETTER_S */\n      )) {\n        const symbols = maskExp.slice(0, this._start - 1);\n        return symbols.includes(\"{\"\n        /* CURLY_BRACKETS_LEFT */\n        ) ? accum + replaceWith : symbols + accum + replaceWith;\n      } else {\n        return accum + replaceWith;\n      }\n    }, '') || maskExp;\n  }\n\n  currentLocaleDecimalMarker() {\n    return 1.1.toLocaleString().substring(1, 2);\n  }\n\n}\n\nNgxMaskService.ɵfac = function NgxMaskService_Factory(t) {\n  return new (t || NgxMaskService)(i0.ɵɵinject(DOCUMENT), i0.ɵɵinject(NGX_MASK_CONFIG), i0.ɵɵinject(i0.ElementRef, 8), i0.ɵɵinject(i0.Renderer2, 8));\n};\n\nNgxMaskService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: NgxMaskService,\n  factory: NgxMaskService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NgxMaskService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: undefined,\n      decorators: [{\n        type: Inject,\n        args: [DOCUMENT]\n      }]\n    }, {\n      type: undefined,\n      decorators: [{\n        type: Inject,\n        args: [NGX_MASK_CONFIG]\n      }]\n    }, {\n      type: i0.ElementRef,\n      decorators: [{\n        type: Optional\n      }]\n    }, {\n      type: i0.Renderer2,\n      decorators: [{\n        type: Optional\n      }]\n    }];\n  }, null);\n})(); // tslint:disable deprecation\n// tslint:disable no-input-rename\n\n\nclass NgxMaskDirective {\n  constructor( // tslint:disable-next-line\n  document, _config, _maskService) {\n    this.document = document;\n    this._config = _config;\n    this._maskService = _maskService; // eslint-disable-next-line @angular-eslint/no-input-rename\n\n    this.maskExpression = '';\n    this.specialCharacters = [];\n    this.patterns = {};\n    this.prefix = '';\n    this.suffix = '';\n    this.thousandSeparator = ' ';\n    this.decimalMarker = '.';\n    this.dropSpecialCharacters = null;\n    this.hiddenInput = null;\n    this.showMaskTyped = null;\n    this.placeHolderCharacter = null;\n    this.shownMaskExpression = null;\n    this.showTemplate = null;\n    this.clearIfNotMatch = null;\n    this.validation = null;\n    this.separatorLimit = null;\n    this.allowNegativeNumbers = null;\n    this.leadZeroDateTime = null;\n    this.leadZero = null;\n    this.triggerOnMaskChange = null;\n    this.apm = null;\n    this.inputTransformFn = null;\n    this.outputTransformFn = null;\n    this.keepCharacterPositions = null;\n    this.maskFilled = new EventEmitter();\n    this._maskValue = '';\n    this._isFocused = false;\n    this._position = null;\n    this._maskExpressionArray = [];\n    this._justPasted = false;\n    /**For IME composition event */\n\n    this._isComposing = false; // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n\n    this.onChange = _ => {}; // eslint-disable-next-line @typescript-eslint/no-empty-function\n\n\n    this.onTouch = () => {};\n  }\n\n  ngOnChanges(changes) {\n    const {\n      maskExpression,\n      specialCharacters,\n      patterns,\n      prefix,\n      suffix,\n      thousandSeparator,\n      decimalMarker,\n      dropSpecialCharacters,\n      hiddenInput,\n      showMaskTyped,\n      placeHolderCharacter,\n      shownMaskExpression,\n      showTemplate,\n      clearIfNotMatch,\n      validation,\n      separatorLimit,\n      allowNegativeNumbers,\n      leadZeroDateTime,\n      leadZero,\n      triggerOnMaskChange,\n      apm,\n      inputTransformFn,\n      outputTransformFn,\n      keepCharacterPositions\n    } = changes;\n\n    if (maskExpression) {\n      if (maskExpression.currentValue !== maskExpression.previousValue && !maskExpression.firstChange) {\n        this._maskService.maskChanged = true;\n      }\n\n      if (maskExpression.currentValue && maskExpression.currentValue.split(\"||\"\n      /* OR */\n      ).length > 1) {\n        this._maskExpressionArray = maskExpression.currentValue.split(\"||\"\n        /* OR */\n        ).sort((a, b) => {\n          return a.length - b.length;\n        });\n\n        this._setMask();\n      } else {\n        this._maskExpressionArray = [];\n        this._maskValue = maskExpression.currentValue || \"\"\n        /* EMPTY_STRING */\n        ;\n        this._maskService.maskExpression = this._maskValue;\n      }\n    }\n\n    if (specialCharacters) {\n      if (!specialCharacters.currentValue || !Array.isArray(specialCharacters.currentValue)) {\n        return;\n      } else {\n        this._maskService.specialCharacters = specialCharacters.currentValue || [];\n      }\n    }\n\n    if (allowNegativeNumbers) {\n      this._maskService.allowNegativeNumbers = allowNegativeNumbers.currentValue;\n\n      if (this._maskService.allowNegativeNumbers) {\n        this._maskService.specialCharacters = this._maskService.specialCharacters.filter(c => c !== \"-\"\n        /* MINUS */\n        );\n      }\n    } // Only overwrite the mask available patterns if a pattern has actually been passed in\n\n\n    if (patterns && patterns.currentValue) {\n      this._maskService.patterns = patterns.currentValue;\n    }\n\n    if (apm && apm.currentValue) {\n      this._maskService.apm = apm.currentValue;\n    }\n\n    if (prefix) {\n      this._maskService.prefix = prefix.currentValue;\n    }\n\n    if (suffix) {\n      this._maskService.suffix = suffix.currentValue;\n    }\n\n    if (thousandSeparator) {\n      this._maskService.thousandSeparator = thousandSeparator.currentValue;\n    }\n\n    if (decimalMarker) {\n      this._maskService.decimalMarker = decimalMarker.currentValue;\n    }\n\n    if (dropSpecialCharacters) {\n      this._maskService.dropSpecialCharacters = dropSpecialCharacters.currentValue;\n    }\n\n    if (hiddenInput) {\n      this._maskService.hiddenInput = hiddenInput.currentValue;\n    }\n\n    if (showMaskTyped) {\n      this._maskService.showMaskTyped = showMaskTyped.currentValue;\n\n      if (showMaskTyped.previousValue === false && showMaskTyped.currentValue === true && this._isFocused) {\n        requestAnimationFrame(() => {\n          var _a;\n\n          (_a = this._maskService._elementRef) === null || _a === void 0 ? void 0 : _a.nativeElement.click();\n        });\n      }\n    }\n\n    if (placeHolderCharacter) {\n      this._maskService.placeHolderCharacter = placeHolderCharacter.currentValue;\n    }\n\n    if (shownMaskExpression) {\n      this._maskService.shownMaskExpression = shownMaskExpression.currentValue;\n    }\n\n    if (showTemplate) {\n      this._maskService.showTemplate = showTemplate.currentValue;\n    }\n\n    if (clearIfNotMatch) {\n      this._maskService.clearIfNotMatch = clearIfNotMatch.currentValue;\n    }\n\n    if (validation) {\n      this._maskService.validation = validation.currentValue;\n    }\n\n    if (separatorLimit) {\n      this._maskService.separatorLimit = separatorLimit.currentValue;\n    }\n\n    if (leadZeroDateTime) {\n      this._maskService.leadZeroDateTime = leadZeroDateTime.currentValue;\n    }\n\n    if (leadZero) {\n      this._maskService.leadZero = leadZero.currentValue;\n    }\n\n    if (triggerOnMaskChange) {\n      this._maskService.triggerOnMaskChange = triggerOnMaskChange.currentValue;\n    }\n\n    if (inputTransformFn) {\n      this._maskService.inputTransformFn = inputTransformFn.currentValue;\n    }\n\n    if (outputTransformFn) {\n      this._maskService.outputTransformFn = outputTransformFn.currentValue;\n    }\n\n    if (keepCharacterPositions) {\n      this._maskService.keepCharacterPositions = keepCharacterPositions.currentValue;\n    }\n\n    this._applyMask();\n  } // eslint-disable-next-line complexity\n\n\n  validate({\n    value\n  }) {\n    var _a, _b, _c;\n\n    if (!this._maskService.validation || !this._maskValue) {\n      return null;\n    }\n\n    if (this._maskService.ipError) {\n      return this._createValidationError(value);\n    }\n\n    if (this._maskService.cpfCnpjError) {\n      return this._createValidationError(value);\n    }\n\n    if (this._maskValue.startsWith(\"separator\"\n    /* SEPARATOR */\n    )) {\n      return null;\n    }\n\n    if (withoutValidation.includes(this._maskValue)) {\n      return null;\n    }\n\n    if (this._maskService.clearIfNotMatch) {\n      return null;\n    }\n\n    if (timeMasks.includes(this._maskValue)) {\n      return this._validateTime(value);\n    }\n\n    if (value && value.toString().length >= 1) {\n      let counterOfOpt = 0;\n\n      if (this._maskValue.startsWith(\"percent\"\n      /* PERCENT */\n      )) {\n        return null;\n      }\n\n      for (const key in this._maskService.patterns) {\n        if ((_a = this._maskService.patterns[key]) === null || _a === void 0 ? void 0 : _a.optional) {\n          if (this._maskValue.indexOf(key) !== this._maskValue.lastIndexOf(key)) {\n            const opt = this._maskValue.split(\"\"\n            /* EMPTY_STRING */\n            ).filter(i => i === key).join(\"\"\n            /* EMPTY_STRING */\n            );\n\n            counterOfOpt += opt.length;\n          } else if (this._maskValue.indexOf(key) !== -1) {\n            counterOfOpt++;\n          }\n\n          if (this._maskValue.indexOf(key) !== -1 && value.toString().length >= this._maskValue.indexOf(key)) {\n            return null;\n          }\n\n          if (counterOfOpt === this._maskValue.length) {\n            return null;\n          }\n        }\n      }\n\n      if (this._maskValue.indexOf(\"{\"\n      /* CURLY_BRACKETS_LEFT */\n      ) === 1 && value.toString().length === this._maskValue.length + Number(((_b = this._maskValue.split(\"{\"\n      /* CURLY_BRACKETS_LEFT */\n      )[1]) !== null && _b !== void 0 ? _b : \"\"\n      /* EMPTY_STRING */\n      ).split(\"}\"\n      /* CURLY_BRACKETS_RIGHT */\n      )[0]) - 4) {\n        return null;\n      } else if (this._maskValue.indexOf(\"*\"\n      /* SYMBOL_STAR */\n      ) > 1 && value.toString().length < this._maskValue.indexOf(\"*\"\n      /* SYMBOL_STAR */\n      ) || this._maskValue.indexOf(\"?\"\n      /* SYMBOL_QUESTION */\n      ) > 1 && value.toString().length < this._maskValue.indexOf(\"?\"\n      /* SYMBOL_QUESTION */\n      ) || this._maskValue.indexOf(\"{\"\n      /* CURLY_BRACKETS_LEFT */\n      ) === 1) {\n        return this._createValidationError(value);\n      }\n\n      if (this._maskValue.indexOf(\"*\"\n      /* SYMBOL_STAR */\n      ) === -1 || this._maskValue.indexOf(\"?\"\n      /* SYMBOL_QUESTION */\n      ) === -1) {\n        // eslint-disable-next-line no-param-reassign\n        value = typeof value === 'number' ? String(value) : value;\n\n        const array = this._maskValue.split('*');\n\n        const length = this._maskService.dropSpecialCharacters ? this._maskValue.length - this._maskService.checkDropSpecialCharAmount(this._maskValue) - counterOfOpt : this.prefix ? this._maskValue.length + this.prefix.length - counterOfOpt : this._maskValue.length - counterOfOpt;\n\n        if (array.length === 1) {\n          if (value.toString().length < length) {\n            return this._createValidationError(value);\n          }\n        }\n\n        if (array.length > 1) {\n          const lastIndexArray = array[array.length - 1];\n\n          if (lastIndexArray && this._maskService.specialCharacters.includes(lastIndexArray[0]) && String(value).includes((_c = lastIndexArray[0]) !== null && _c !== void 0 ? _c : '') && !this.dropSpecialCharacters) {\n            const special = value.split(lastIndexArray[0]);\n            return special[special.length - 1].length === lastIndexArray.length - 1 ? null : this._createValidationError(value);\n          } else if ((lastIndexArray && !this._maskService.specialCharacters.includes(lastIndexArray[0]) || !lastIndexArray || this._maskService.dropSpecialCharacters) && value.length >= length - 1) {\n            return null;\n          } else {\n            return this._createValidationError(value);\n          }\n        }\n      }\n\n      if (this._maskValue.indexOf(\"*\"\n      /* SYMBOL_STAR */\n      ) === 1 || this._maskValue.indexOf(\"?\"\n      /* SYMBOL_QUESTION */\n      ) === 1) {\n        return null;\n      }\n    }\n\n    if (value) {\n      this.maskFilled.emit();\n      return null;\n    }\n\n    return null;\n  }\n\n  onPaste() {\n    this._justPasted = true;\n  }\n\n  onFocus() {\n    this._isFocused = true;\n  }\n\n  onModelChange(value) {\n    // on form reset we need to update the actualValue\n    if ((value === \"\"\n    /* EMPTY_STRING */\n    || value === null || value === undefined) && this._maskService.actualValue) {\n      this._maskService.actualValue = this._maskService.getActualValue(\"\"\n      /* EMPTY_STRING */\n      );\n    }\n  }\n\n  onInput(e) {\n    var _a, _b, _c, _d, _e; // If IME is composing text, we wait for the composed text.\n\n\n    if (this._isComposing) return;\n    const el = e.target;\n\n    const transformedValue = this._maskService.inputTransformFn(el.value);\n\n    if (el.type !== 'number') {\n      if (typeof transformedValue === 'string' || typeof transformedValue === 'number') {\n        el.value = transformedValue.toString();\n        this._inputValue = el.value;\n\n        this._setMask();\n\n        if (!this._maskValue) {\n          this.onChange(el.value);\n          return;\n        }\n\n        let position = el.selectionStart === 1 ? el.selectionStart + this._maskService.prefix.length : el.selectionStart;\n\n        if (this.showMaskTyped && this.keepCharacterPositions && this._maskService.placeHolderCharacter.length === 1) {\n          const inputSymbol = el.value.slice(position - 1, position);\n          const prefixLength = this.prefix.length;\n\n          const checkSymbols = this._maskService._checkSymbolMask(inputSymbol, (_a = this._maskService.maskExpression[position - 1 - prefixLength]) !== null && _a !== void 0 ? _a : \"\"\n          /* EMPTY_STRING */\n          );\n\n          const checkSpecialCharacter = this._maskService._checkSymbolMask(inputSymbol, (_b = this._maskService.maskExpression[position + 1 - prefixLength]) !== null && _b !== void 0 ? _b : \"\"\n          /* EMPTY_STRING */\n          );\n\n          const selectRangeBackspace = this._maskService.selStart === this._maskService.selEnd;\n          const selStart = (_c = Number(this._maskService.selStart) - prefixLength) !== null && _c !== void 0 ? _c : '';\n          const selEnd = (_d = Number(this._maskService.selEnd) - prefixLength) !== null && _d !== void 0 ? _d : '';\n\n          if (this._code === \"Backspace\"\n          /* BACKSPACE */\n          ) {\n            if (!selectRangeBackspace) {\n              if (this._maskService.selStart === prefixLength) {\n                this._maskService.actualValue = this.prefix + this._maskService.maskIsShown.slice(0, selEnd) + this._inputValue.split(this.prefix).join('');\n              } else if (this._maskService.selStart === this._maskService.maskIsShown.length + prefixLength) {\n                this._maskService.actualValue = this._inputValue + this._maskService.maskIsShown.slice(selStart, selEnd);\n              } else {\n                this._maskService.actualValue = this.prefix + this._inputValue.split(this.prefix).join('').slice(0, selStart) + this._maskService.maskIsShown.slice(selStart, selEnd) + this._maskService.actualValue.slice(selEnd + prefixLength, this._maskService.maskIsShown.length + prefixLength) + this.suffix;\n              }\n            } else if (!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(position - this.prefix.length, position + 1 - this.prefix.length)) && selectRangeBackspace) {\n              if (selStart === 1 && this.prefix) {\n                this._maskService.actualValue = this.prefix + this._maskService.placeHolderCharacter + el.value.split(this.prefix).join('').split(this.suffix).join('') + this.suffix;\n                position = position - 1;\n              } else {\n                const part1 = el.value.substring(0, position);\n                const part2 = el.value.substring(position);\n                this._maskService.actualValue = part1 + this._maskService.placeHolderCharacter + part2;\n              }\n            }\n          }\n\n          if (this._code !== \"Backspace\"\n          /* BACKSPACE */\n          ) {\n            if (!checkSymbols && !checkSpecialCharacter && selectRangeBackspace) {\n              position = Number(el.selectionStart) - 1;\n            } else if (this._maskService.specialCharacters.includes(el.value.slice(position, position + 1)) && checkSpecialCharacter && !this._maskService.specialCharacters.includes(el.value.slice(position + 1, position + 2))) {\n              this._maskService.actualValue = el.value.slice(0, position - 1) + el.value.slice(position, position + 1) + inputSymbol + el.value.slice(position + 2);\n              position = position + 1;\n            } else if (checkSymbols) {\n              if (el.value.length === 1 && position === 1) {\n                this._maskService.actualValue = this.prefix + inputSymbol + this._maskService.maskIsShown.slice(1, this._maskService.maskIsShown.length) + this.suffix;\n              } else {\n                this._maskService.actualValue = el.value.slice(0, position - 1) + inputSymbol + el.value.slice(position + 1).split(this.suffix).join('') + this.suffix;\n              }\n            } else if (this.prefix && el.value.length === 1 && position - prefixLength === 1 && this._maskService._checkSymbolMask(el.value, (_e = this._maskService.maskExpression[position - 1 - prefixLength]) !== null && _e !== void 0 ? _e : \"\"\n            /* EMPTY_STRING */\n            )) {\n              this._maskService.actualValue = this.prefix + el.value + this._maskService.maskIsShown.slice(1, this._maskService.maskIsShown.length) + this.suffix;\n            }\n          }\n        }\n\n        let caretShift = 0;\n        let backspaceShift = false;\n\n        if (this._code === \"Delete\"\n        /* DELETE */\n        && \"separator\"\n        /* SEPARATOR */\n        ) {\n          this._maskService.deletedSpecialCharacter = true;\n        }\n\n        if (this._inputValue.length >= this._maskService.maskExpression.length - 1 && this._code !== \"Backspace\"\n        /* BACKSPACE */\n        && this._maskService.maskExpression === \"d0/M0/0000\"\n        /* DAYS_MONTHS_YEARS */\n        && position < 10) {\n          const inputSymbol = this._inputValue.slice(position - 1, position);\n\n          el.value = this._inputValue.slice(0, position - 1) + inputSymbol + this._inputValue.slice(position + 1);\n        }\n\n        if (this._maskService.maskExpression === \"d0/M0/0000\"\n        /* DAYS_MONTHS_YEARS */\n        && this.leadZeroDateTime) {\n          if (position < 3 && Number(el.value) > 31 && Number(el.value) < 40 || position === 5 && Number(el.value.slice(3, 5)) > 12) {\n            position = position + 2;\n          }\n        }\n\n        if (this._maskService.maskExpression === \"Hh:m0:s0\"\n        /* HOURS_MINUTES_SECONDS */\n        && this.apm) {\n          if (this._justPasted && el.value.slice(0, 2) === \"00\"\n          /* DOUBLE_ZERO */\n          ) {\n            el.value = el.value.slice(1, 2) + el.value.slice(2, el.value.length);\n          }\n\n          el.value = el.value === \"00\"\n          /* DOUBLE_ZERO */\n          ? \"0\"\n          /* NUMBER_ZERO */\n          : el.value;\n        }\n\n        this._maskService.applyValueChanges(position, this._justPasted, this._code === \"Backspace\"\n        /* BACKSPACE */\n        || this._code === \"Delete\"\n        /* DELETE */\n        , (shift, _backspaceShift) => {\n          this._justPasted = false;\n          caretShift = shift;\n          backspaceShift = _backspaceShift;\n        }); // only set the selection if the element is active\n\n\n        if (this._getActiveElement() !== el) {\n          return;\n        }\n\n        if (this._maskService.plusOnePosition) {\n          position = position + 1;\n          this._maskService.plusOnePosition = false;\n        } // update position after applyValueChanges to prevent cursor on wrong position when it has an array of maskExpression\n\n\n        if (this._maskExpressionArray.length) {\n          if (this._code === \"Backspace\"\n          /* BACKSPACE */\n          ) {\n            position = this.specialCharacters.includes(this._inputValue.slice(position - 1, position)) ? position - 1 : position;\n          } else {\n            position = el.selectionStart === 1 ? el.selectionStart + this._maskService.prefix.length : el.selectionStart;\n          }\n        }\n\n        this._position = this._position === 1 && this._inputValue.length === 1 ? null : this._position;\n        let positionToApply = this._position ? this._inputValue.length + position + caretShift : position + (this._code === \"Backspace\"\n        /* BACKSPACE */\n        && !backspaceShift ? 0 : caretShift);\n\n        if (positionToApply > this._getActualInputLength()) {\n          positionToApply = el.value === this._maskService.decimalMarker && el.value.length === 1 ? this._getActualInputLength() + 1 : this._getActualInputLength();\n        }\n\n        if (positionToApply < 0) {\n          positionToApply = 0;\n        }\n\n        el.setSelectionRange(positionToApply, positionToApply);\n        this._position = null;\n      } else {\n        console.warn('Ngx-mask writeValue work with string | number, your current value:', typeof transformedValue);\n      }\n    } else {\n      if (!this._maskValue) {\n        this.onChange(el.value);\n        return;\n      }\n\n      this._maskService.applyValueChanges(el.value.length, this._justPasted, this._code === \"Backspace\"\n      /* BACKSPACE */\n      || this._code === \"Delete\"\n      /* DELETE */\n      );\n    }\n  } // IME starts\n\n\n  onCompositionStart() {\n    this._isComposing = true;\n  } // IME completes\n\n\n  onCompositionEnd(e) {\n    this._isComposing = false;\n    this._justPasted = true;\n    this.onInput(e);\n  }\n\n  onBlur(e) {\n    if (this._maskValue) {\n      const el = e.target;\n\n      if (this.leadZero && el.value.length > 0 && typeof this.decimalMarker === 'string') {\n        const maskExpression = this._maskService.maskExpression;\n        const precision = Number(this._maskService.maskExpression.slice(maskExpression.length - 1, maskExpression.length));\n\n        if (precision > 1) {\n          el.value = this.suffix ? el.value.split(this.suffix).join('') : el.value;\n          const decimalPart = el.value.split(this.decimalMarker)[1];\n          el.value = el.value.includes(this.decimalMarker) ? el.value + \"0\"\n          /* NUMBER_ZERO */\n          .repeat(precision - decimalPart.length) + this.suffix : el.value + this.decimalMarker + \"0\"\n          /* NUMBER_ZERO */\n          .repeat(precision) + this.suffix;\n          this._maskService.actualValue = el.value;\n        }\n      }\n\n      this._maskService.clearIfNotMatchFn();\n    }\n\n    this._isFocused = false;\n    this.onTouch();\n  }\n\n  onClick(e) {\n    if (!this._maskValue) {\n      return;\n    }\n\n    const el = e.target;\n    const posStart = 0;\n    const posEnd = 0;\n\n    if (el !== null && el.selectionStart !== null && el.selectionStart === el.selectionEnd && el.selectionStart > this._maskService.prefix.length && // eslint-disable-next-line\n    e.keyCode !== 38) {\n      if (this._maskService.showMaskTyped && !this.keepCharacterPositions) {\n        // We are showing the mask in the input\n        this._maskService.maskIsShown = this._maskService.showMaskInInput();\n\n        if (el.setSelectionRange && this._maskService.prefix + this._maskService.maskIsShown === el.value) {\n          // the input ONLY contains the mask, so position the cursor at the start\n          el.focus();\n          el.setSelectionRange(posStart, posEnd);\n        } else {\n          // the input contains some characters already\n          if (el.selectionStart > this._maskService.actualValue.length) {\n            // if the user clicked beyond our value's length, position the cursor at the end of our value\n            el.setSelectionRange(this._maskService.actualValue.length, this._maskService.actualValue.length);\n          }\n        }\n      }\n    }\n\n    const nextValue = el && (el.value === this._maskService.prefix ? this._maskService.prefix + this._maskService.maskIsShown : el.value);\n    /** Fix of cursor position jumping to end in most browsers no matter where cursor is inserted onFocus */\n\n    if (el && el.value !== nextValue) {\n      el.value = nextValue;\n    }\n    /** fix of cursor position with prefix when mouse click occur */\n\n\n    if (el && el.type !== 'number' && (el.selectionStart || el.selectionEnd) <= this._maskService.prefix.length) {\n      el.selectionStart = this._maskService.prefix.length;\n      return;\n    }\n    /** select only inserted text */\n\n\n    if (el && el.selectionEnd > this._getActualInputLength()) {\n      el.selectionEnd = this._getActualInputLength();\n    }\n  } // eslint-disable-next-line complexity\n\n\n  onKeyDown(e) {\n    var _a, _b;\n\n    if (!this._maskValue) {\n      return;\n    }\n\n    if (this._isComposing) {\n      // User finalize their choice from IME composition, so trigger onInput() for the composed text.\n      if (e.key === 'Enter') this.onCompositionEnd(e);\n      return;\n    }\n\n    this._code = e.code ? e.code : e.key;\n    const el = e.target;\n    this._inputValue = el.value;\n\n    this._setMask();\n\n    if (el.type !== 'number') {\n      if (e.key === \"ArrowUp\"\n      /* ARROW_UP */\n      ) {\n        e.preventDefault();\n      }\n\n      if (e.key === \"ArrowLeft\"\n      /* ARROW_LEFT */\n      || e.key === \"Backspace\"\n      /* BACKSPACE */\n      || e.key === \"Delete\"\n      /* DELETE */\n      ) {\n        if (e.key === \"Backspace\"\n        /* BACKSPACE */\n        && el.value.length === 0) {\n          el.selectionStart = el.selectionEnd;\n        }\n\n        if (e.key === \"Backspace\"\n        /* BACKSPACE */\n        && el.selectionStart !== 0) {\n          // If specialChars is false, (shouldn't ever happen) then set to the defaults\n          this.specialCharacters = ((_a = this.specialCharacters) === null || _a === void 0 ? void 0 : _a.length) ? this.specialCharacters : this._config.specialCharacters;\n\n          if (this.prefix.length > 1 && el.selectionStart <= this.prefix.length) {\n            el.setSelectionRange(this.prefix.length, el.selectionEnd);\n          } else {\n            if (this._inputValue.length !== el.selectionStart && el.selectionStart !== 1) {\n              while (this.specialCharacters.includes(((_b = this._inputValue[el.selectionStart - 1]) !== null && _b !== void 0 ? _b : \"\"\n              /* EMPTY_STRING */\n              ).toString()) && (this.prefix.length >= 1 && el.selectionStart > this.prefix.length || this.prefix.length === 0)) {\n                el.setSelectionRange(el.selectionStart - 1, el.selectionEnd);\n              }\n            }\n          }\n        }\n\n        this.checkSelectionOnDeletion(el);\n\n        if (this._maskService.prefix.length && el.selectionStart <= this._maskService.prefix.length && el.selectionEnd <= this._maskService.prefix.length) {\n          e.preventDefault();\n        }\n\n        const cursorStart = el.selectionStart;\n\n        if (e.key === \"Backspace\"\n        /* BACKSPACE */\n        && !el.readOnly && cursorStart === 0 && el.selectionEnd === el.value.length && el.value.length !== 0) {\n          this._position = this._maskService.prefix ? this._maskService.prefix.length : 0;\n\n          this._maskService.applyMask(this._maskService.prefix, this._maskService.maskExpression, this._position);\n        }\n      }\n\n      if (!!this.suffix && this.suffix.length > 1 && this._inputValue.length - this.suffix.length < el.selectionStart) {\n        el.setSelectionRange(this._inputValue.length - this.suffix.length, this._inputValue.length);\n      } else if (e.code === 'KeyA' && e.ctrlKey || e.code === 'KeyA' && e.metaKey // Cmd + A (Mac)\n      ) {\n        el.setSelectionRange(0, this._getActualInputLength());\n        e.preventDefault();\n      }\n\n      this._maskService.selStart = el.selectionStart;\n      this._maskService.selEnd = el.selectionEnd;\n    }\n  }\n  /** It writes the value in the input */\n\n\n  writeValue(controlValue) {\n    var _a;\n\n    return __awaiter(this, void 0, void 0, function* () {\n      if (typeof controlValue === 'object' && controlValue !== null && 'value' in controlValue) {\n        if ('disable' in controlValue) {\n          this.setDisabledState(Boolean(controlValue.disable));\n        } // eslint-disable-next-line no-param-reassign\n\n\n        controlValue = controlValue.value;\n      }\n\n      if (controlValue !== null) {\n        // eslint-disable-next-line no-param-reassign\n        controlValue = this.inputTransformFn ? this.inputTransformFn(controlValue) : controlValue;\n      }\n\n      if (typeof controlValue === 'string' || typeof controlValue === 'number' || controlValue === null || controlValue === undefined) {\n        if (controlValue === null || controlValue === undefined || controlValue === '') {\n          this._maskService._currentValue = '';\n          this._maskService._previousValue = '';\n        } // eslint-disable-next-line no-param-reassign\n\n\n        let inputValue = controlValue;\n\n        if (typeof inputValue === 'number' || this._maskValue.startsWith(\"separator\"\n        /* SEPARATOR */\n        )) {\n          // eslint-disable-next-line no-param-reassign\n          inputValue = String(inputValue);\n\n          const localeDecimalMarker = this._maskService.currentLocaleDecimalMarker();\n\n          if (!Array.isArray(this._maskService.decimalMarker)) {\n            // eslint-disable-next-line no-param-reassign\n            inputValue = this._maskService.decimalMarker !== localeDecimalMarker ? inputValue.replace(localeDecimalMarker, this._maskService.decimalMarker) : inputValue;\n          }\n\n          if (this._maskService.leadZero && inputValue && this.maskExpression && this.dropSpecialCharacters !== false) {\n            // eslint-disable-next-line no-param-reassign\n            inputValue = this._maskService._checkPrecision(this._maskService.maskExpression, inputValue);\n          }\n\n          if (this._maskService.decimalMarker === \",\"\n          /* COMMA */\n          ) {\n            // eslint-disable-next-line no-param-reassign\n            inputValue = inputValue.toString().replace(\".\"\n            /* DOT */\n            , \",\"\n            /* COMMA */\n            );\n          }\n\n          if (((_a = this.maskExpression) === null || _a === void 0 ? void 0 : _a.startsWith(\"separator\"\n          /* SEPARATOR */\n          )) && this.leadZero) {\n            requestAnimationFrame(() => {\n              var _a;\n\n              this._maskService.applyMask((_a = inputValue === null || inputValue === void 0 ? void 0 : inputValue.toString()) !== null && _a !== void 0 ? _a : '', this._maskService.maskExpression);\n            });\n          }\n\n          this._maskService.isNumberValue = true;\n        }\n\n        if (typeof inputValue !== 'string') {\n          // eslint-disable-next-line no-param-reassign\n          inputValue = '';\n        }\n\n        this._inputValue = inputValue;\n\n        this._setMask();\n\n        if (inputValue && this._maskService.maskExpression || this._maskService.maskExpression && (this._maskService.prefix || this._maskService.showMaskTyped)) {\n          // Let the service we know we are writing value so that triggering onChange function won't happen during applyMask\n          typeof this.inputTransformFn !== 'function' ? this._maskService.writingValue = true : '';\n          this._maskService.formElementProperty = ['value', this._maskService.applyMask(inputValue, this._maskService.maskExpression)]; // Let the service know we've finished writing value\n\n          typeof this.inputTransformFn !== 'function' ? this._maskService.writingValue = false : '';\n        } else {\n          this._maskService.formElementProperty = ['value', inputValue];\n        }\n\n        this._inputValue = inputValue;\n      } else {\n        console.warn('Ngx-mask writeValue work with string | number, your current value:', typeof controlValue);\n      }\n    });\n  }\n\n  registerOnChange(fn) {\n    this._maskService.onChange = this.onChange = fn;\n  }\n\n  registerOnTouched(fn) {\n    this.onTouch = fn;\n  }\n\n  _getActiveElement(document = this.document) {\n    var _a;\n\n    const shadowRootEl = (_a = document === null || document === void 0 ? void 0 : document.activeElement) === null || _a === void 0 ? void 0 : _a.shadowRoot;\n\n    if (!(shadowRootEl === null || shadowRootEl === void 0 ? void 0 : shadowRootEl.activeElement)) {\n      return document.activeElement;\n    } else {\n      return this._getActiveElement(shadowRootEl);\n    }\n  }\n\n  checkSelectionOnDeletion(el) {\n    el.selectionStart = Math.min(Math.max(this.prefix.length, el.selectionStart), this._inputValue.length - this.suffix.length);\n    el.selectionEnd = Math.min(Math.max(this.prefix.length, el.selectionEnd), this._inputValue.length - this.suffix.length);\n  }\n  /** It disables the input element */\n\n\n  setDisabledState(isDisabled) {\n    this._maskService.formElementProperty = ['disabled', isDisabled];\n  } // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n  _applyMask() {\n    this._maskService.maskExpression = this._maskService._repeatPatternSymbols(this._maskValue || '');\n    this._maskService.formElementProperty = ['value', this._maskService.applyMask(this._inputValue, this._maskService.maskExpression)];\n  }\n\n  _validateTime(value) {\n    var _a;\n\n    const rowMaskLen = this._maskValue.split(\"\"\n    /* EMPTY_STRING */\n    ).filter(s => s !== ':').length;\n\n    if (!value) {\n      return null; // Don't validate empty values to allow for optional form control\n    }\n\n    if (+((_a = value[value.length - 1]) !== null && _a !== void 0 ? _a : -1) === 0 && value.length < rowMaskLen || value.length <= rowMaskLen - 2) {\n      return this._createValidationError(value);\n    }\n\n    return null;\n  }\n\n  _getActualInputLength() {\n    return this._maskService.actualValue.length || this._maskService.actualValue.length + this._maskService.prefix.length;\n  }\n\n  _createValidationError(actualValue) {\n    return {\n      mask: {\n        requiredMask: this._maskValue,\n        actualValue\n      }\n    };\n  }\n\n  _setMask() {\n    this._maskExpressionArray.some(mask => {\n      var _a, _b, _c, _d;\n\n      const specialChart = mask.split(\"\"\n      /* EMPTY_STRING */\n      ).some(char => this._maskService.specialCharacters.includes(char));\n\n      if (specialChart && this._inputValue && !mask.includes(\"S\"\n      /* LETTER_S */\n      ) || mask.includes(\"{\"\n      /* CURLY_BRACKETS_LEFT */\n      )) {\n        const test = ((_a = this._maskService.removeMask(this._inputValue)) === null || _a === void 0 ? void 0 : _a.length) <= ((_b = this._maskService.removeMask(mask)) === null || _b === void 0 ? void 0 : _b.length);\n\n        if (test) {\n          this._maskValue = this.maskExpression = this._maskService.maskExpression = mask.includes(\"{\"\n          /* CURLY_BRACKETS_LEFT */\n          ) ? this._maskService._repeatPatternSymbols(mask) : mask;\n          return test;\n        } else {\n          const expression = (_c = this._maskExpressionArray[this._maskExpressionArray.length - 1]) !== null && _c !== void 0 ? _c : \"\"\n          /* EMPTY_STRING */\n          ;\n          this._maskValue = this.maskExpression = this._maskService.maskExpression = expression.includes(\"{\"\n          /* CURLY_BRACKETS_LEFT */\n          ) ? this._maskService._repeatPatternSymbols(expression) : expression;\n        }\n      } else {\n        const check = (_d = this._maskService.removeMask(this._inputValue)) === null || _d === void 0 ? void 0 : _d.split(\"\"\n        /* EMPTY_STRING */\n        ).every((character, index) => {\n          const indexMask = mask.charAt(index);\n          return this._maskService._checkSymbolMask(character, indexMask);\n        });\n\n        if (check) {\n          this._maskValue = this.maskExpression = this._maskService.maskExpression = mask;\n          return check;\n        }\n      }\n    });\n  }\n\n}\n\nNgxMaskDirective.ɵfac = function NgxMaskDirective_Factory(t) {\n  return new (t || NgxMaskDirective)(i0.ɵɵdirectiveInject(DOCUMENT), i0.ɵɵdirectiveInject(NGX_MASK_CONFIG), i0.ɵɵdirectiveInject(NgxMaskService));\n};\n\nNgxMaskDirective.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n  type: NgxMaskDirective,\n  selectors: [[\"input\", \"mask\", \"\"], [\"textarea\", \"mask\", \"\"]],\n  hostBindings: function NgxMaskDirective_HostBindings(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵlistener(\"paste\", function NgxMaskDirective_paste_HostBindingHandler() {\n        return ctx.onPaste();\n      })(\"focus\", function NgxMaskDirective_focus_HostBindingHandler($event) {\n        return ctx.onFocus($event);\n      })(\"ngModelChange\", function NgxMaskDirective_ngModelChange_HostBindingHandler($event) {\n        return ctx.onModelChange($event);\n      })(\"input\", function NgxMaskDirective_input_HostBindingHandler($event) {\n        return ctx.onInput($event);\n      })(\"compositionstart\", function NgxMaskDirective_compositionstart_HostBindingHandler($event) {\n        return ctx.onCompositionStart($event);\n      })(\"compositionend\", function NgxMaskDirective_compositionend_HostBindingHandler($event) {\n        return ctx.onCompositionEnd($event);\n      })(\"blur\", function NgxMaskDirective_blur_HostBindingHandler($event) {\n        return ctx.onBlur($event);\n      })(\"click\", function NgxMaskDirective_click_HostBindingHandler($event) {\n        return ctx.onClick($event);\n      })(\"keydown\", function NgxMaskDirective_keydown_HostBindingHandler($event) {\n        return ctx.onKeyDown($event);\n      });\n    }\n  },\n  inputs: {\n    maskExpression: [\"mask\", \"maskExpression\"],\n    specialCharacters: \"specialCharacters\",\n    patterns: \"patterns\",\n    prefix: \"prefix\",\n    suffix: \"suffix\",\n    thousandSeparator: \"thousandSeparator\",\n    decimalMarker: \"decimalMarker\",\n    dropSpecialCharacters: \"dropSpecialCharacters\",\n    hiddenInput: \"hiddenInput\",\n    showMaskTyped: \"showMaskTyped\",\n    placeHolderCharacter: \"placeHolderCharacter\",\n    shownMaskExpression: \"shownMaskExpression\",\n    showTemplate: \"showTemplate\",\n    clearIfNotMatch: \"clearIfNotMatch\",\n    validation: \"validation\",\n    separatorLimit: \"separatorLimit\",\n    allowNegativeNumbers: \"allowNegativeNumbers\",\n    leadZeroDateTime: \"leadZeroDateTime\",\n    leadZero: \"leadZero\",\n    triggerOnMaskChange: \"triggerOnMaskChange\",\n    apm: \"apm\",\n    inputTransformFn: \"inputTransformFn\",\n    outputTransformFn: \"outputTransformFn\",\n    keepCharacterPositions: \"keepCharacterPositions\"\n  },\n  outputs: {\n    maskFilled: \"maskFilled\"\n  },\n  exportAs: [\"mask\", \"ngxMask\"],\n  features: [i0.ɵɵProvidersFeature([{\n    provide: NG_VALUE_ACCESSOR,\n    useExisting: forwardRef(() => NgxMaskDirective),\n    multi: true\n  }, {\n    provide: NG_VALIDATORS,\n    useExisting: forwardRef(() => NgxMaskDirective),\n    multi: true\n  }, NgxMaskService]), i0.ɵɵNgOnChangesFeature]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NgxMaskDirective, [{\n    type: Directive,\n    args: [{\n      selector: 'input[mask], textarea[mask]',\n      providers: [{\n        provide: NG_VALUE_ACCESSOR,\n        useExisting: forwardRef(() => NgxMaskDirective),\n        multi: true\n      }, {\n        provide: NG_VALIDATORS,\n        useExisting: forwardRef(() => NgxMaskDirective),\n        multi: true\n      }, NgxMaskService],\n      exportAs: 'mask,ngxMask'\n    }]\n  }], function () {\n    return [{\n      type: undefined,\n      decorators: [{\n        type: Inject,\n        args: [DOCUMENT]\n      }]\n    }, {\n      type: undefined,\n      decorators: [{\n        type: Inject,\n        args: [NGX_MASK_CONFIG]\n      }]\n    }, {\n      type: NgxMaskService\n    }];\n  }, {\n    maskExpression: [{\n      type: Input,\n      args: ['mask']\n    }],\n    specialCharacters: [{\n      type: Input\n    }],\n    patterns: [{\n      type: Input\n    }],\n    prefix: [{\n      type: Input\n    }],\n    suffix: [{\n      type: Input\n    }],\n    thousandSeparator: [{\n      type: Input\n    }],\n    decimalMarker: [{\n      type: Input\n    }],\n    dropSpecialCharacters: [{\n      type: Input\n    }],\n    hiddenInput: [{\n      type: Input\n    }],\n    showMaskTyped: [{\n      type: Input\n    }],\n    placeHolderCharacter: [{\n      type: Input\n    }],\n    shownMaskExpression: [{\n      type: Input\n    }],\n    showTemplate: [{\n      type: Input\n    }],\n    clearIfNotMatch: [{\n      type: Input\n    }],\n    validation: [{\n      type: Input\n    }],\n    separatorLimit: [{\n      type: Input\n    }],\n    allowNegativeNumbers: [{\n      type: Input\n    }],\n    leadZeroDateTime: [{\n      type: Input\n    }],\n    leadZero: [{\n      type: Input\n    }],\n    triggerOnMaskChange: [{\n      type: Input\n    }],\n    apm: [{\n      type: Input\n    }],\n    inputTransformFn: [{\n      type: Input\n    }],\n    outputTransformFn: [{\n      type: Input\n    }],\n    keepCharacterPositions: [{\n      type: Input\n    }],\n    maskFilled: [{\n      type: Output\n    }],\n    onPaste: [{\n      type: HostListener,\n      args: ['paste']\n    }],\n    onFocus: [{\n      type: HostListener,\n      args: ['focus', ['$event']]\n    }],\n    onModelChange: [{\n      type: HostListener,\n      args: ['ngModelChange', ['$event']]\n    }],\n    onInput: [{\n      type: HostListener,\n      args: ['input', ['$event']]\n    }],\n    onCompositionStart: [{\n      type: HostListener,\n      args: ['compositionstart', ['$event']]\n    }],\n    onCompositionEnd: [{\n      type: HostListener,\n      args: ['compositionend', ['$event']]\n    }],\n    onBlur: [{\n      type: HostListener,\n      args: ['blur', ['$event']]\n    }],\n    onClick: [{\n      type: HostListener,\n      args: ['click', ['$event']]\n    }],\n    onKeyDown: [{\n      type: HostListener,\n      args: ['keydown', ['$event']]\n    }]\n  });\n})();\n\nclass NgxMaskPipe {\n  constructor(_maskService) {\n    this._maskService = _maskService;\n    this.defaultOptions = {};\n    this._maskExpressionArray = [];\n    this.mask = '';\n  }\n\n  transform(value, mask, _a = {}) {\n    var {\n      patterns\n    } = _a,\n        config = __rest(_a, [\"patterns\"]);\n\n    const currentConfig = Object.assign(Object.assign(Object.assign({\n      maskExpression: mask\n    }, this.defaultOptions), config), {\n      patterns: Object.assign(Object.assign({}, this._maskService.patterns), patterns)\n    });\n    Object.entries(currentConfig).forEach(([key, value]) => {\n      //eslint-disable-next-line  @typescript-eslint/no-explicit-any\n      this._maskService[key] = value;\n    });\n\n    if (mask.includes('||')) {\n      if (mask.split('||').length > 1) {\n        this._maskExpressionArray = mask.split('||').sort((a, b) => {\n          return a.length - b.length;\n        });\n\n        this._setMask(value);\n\n        return this._maskService.applyMask(`${value}`, this.mask);\n      } else {\n        this._maskExpressionArray = [];\n        return this._maskService.applyMask(`${value}`, this.mask);\n      }\n    }\n\n    if (mask.includes(\"{\"\n    /* CURLY_BRACKETS_LEFT */\n    )) {\n      return this._maskService.applyMask(`${value}`, this._maskService._repeatPatternSymbols(mask));\n    }\n\n    if (mask.startsWith(\"separator\"\n    /* SEPARATOR */\n    )) {\n      if (config.decimalMarker) {\n        this._maskService.decimalMarker = config.decimalMarker;\n      }\n\n      if (config.thousandSeparator) {\n        this._maskService.thousandSeparator = config.thousandSeparator;\n      }\n\n      if (config.leadZero) {\n        // eslint-disable-next-line no-param-reassign\n        this._maskService.leadZero = config.leadZero;\n      } // eslint-disable-next-line no-param-reassign\n\n\n      value = String(value);\n\n      const localeDecimalMarker = this._maskService.currentLocaleDecimalMarker();\n\n      if (!Array.isArray(this._maskService.decimalMarker)) {\n        // eslint-disable-next-line no-param-reassign\n        value = this._maskService.decimalMarker !== localeDecimalMarker ? value.replace(localeDecimalMarker, this._maskService.decimalMarker) : value;\n      }\n\n      if (this._maskService.leadZero && value && this._maskService.dropSpecialCharacters !== false) {\n        // eslint-disable-next-line no-param-reassign\n        value = this._maskService._checkPrecision(mask, value);\n      }\n\n      if (this._maskService.decimalMarker === \",\"\n      /* COMMA */\n      ) {\n        // eslint-disable-next-line no-param-reassign\n        value = value.toString().replace(\".\"\n        /* DOT */\n        , \",\"\n        /* COMMA */\n        );\n      }\n\n      this._maskService.isNumberValue = true;\n    }\n\n    if (value === null || value === undefined) {\n      return this._maskService.applyMask('', mask);\n    }\n\n    return this._maskService.applyMask(`${value}`, mask);\n  }\n\n  _setMask(value) {\n    if (this._maskExpressionArray.length > 0) {\n      this._maskExpressionArray.some(mask => {\n        var _a, _b, _c;\n\n        const test = ((_a = this._maskService.removeMask(value)) === null || _a === void 0 ? void 0 : _a.length) <= ((_b = this._maskService.removeMask(mask)) === null || _b === void 0 ? void 0 : _b.length);\n\n        if (value && test) {\n          this.mask = mask;\n          return test;\n        } else {\n          const expression = (_c = this._maskExpressionArray[this._maskExpressionArray.length - 1]) !== null && _c !== void 0 ? _c : \"\"\n          /* EMPTY_STRING */\n          ;\n          this.mask = expression;\n        }\n      });\n    }\n  }\n\n}\n\nNgxMaskPipe.ɵfac = function NgxMaskPipe_Factory(t) {\n  return new (t || NgxMaskPipe)(i0.ɵɵdirectiveInject(NgxMaskService, 16));\n};\n\nNgxMaskPipe.ɵpipe = /* @__PURE__ */i0.ɵɵdefinePipe({\n  name: \"mask\",\n  type: NgxMaskPipe,\n  pure: true\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NgxMaskPipe, [{\n    type: Pipe,\n    args: [{\n      name: 'mask',\n      pure: true\n    }]\n  }], function () {\n    return [{\n      type: NgxMaskService\n    }];\n  }, null);\n})();\n/**\n * @internal\n */\n\n\nfunction _configFactory(initConfig, configValue) {\n  return configValue instanceof Function ? Object.assign(Object.assign({}, initConfig), configValue()) : Object.assign(Object.assign({}, initConfig), configValue);\n}\n\nclass NgxMaskModule {\n  static forRoot(configValue) {\n    return {\n      ngModule: NgxMaskModule,\n      providers: [{\n        provide: NEW_CONFIG,\n        useValue: configValue\n      }, {\n        provide: INITIAL_CONFIG,\n        useValue: initialConfig\n      }, {\n        provide: NGX_MASK_CONFIG,\n        useFactory: _configFactory,\n        deps: [INITIAL_CONFIG, NEW_CONFIG]\n      }, NgxMaskService]\n    };\n  }\n\n  static forChild() {\n    return {\n      ngModule: NgxMaskModule\n    };\n  }\n\n}\n\nNgxMaskModule.ɵfac = function NgxMaskModule_Factory(t) {\n  return new (t || NgxMaskModule)();\n};\n\nNgxMaskModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: NgxMaskModule\n});\nNgxMaskModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NgxMaskModule, [{\n    type: NgModule,\n    args: [{\n      exports: [NgxMaskDirective, NgxMaskPipe],\n      declarations: [NgxMaskDirective, NgxMaskPipe]\n    }]\n  }], null, null);\n})();\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { INITIAL_CONFIG, NEW_CONFIG, NGX_MASK_CONFIG, NgxMaskDirective, NgxMaskModule, NgxMaskPipe, NgxMaskService, _configFactory, initialConfig, timeMasks, withoutValidation };","map":{"version":3,"sources":["C:/Users/jorge/OneDrive/Área de Trabalho/Programação/processo-seletivo/front-end-maptriz/node_modules/ngx-mask/fesm2015/ngx-mask.mjs"],"names":["i0","InjectionToken","EventEmitter","Injectable","Inject","Optional","forwardRef","Directive","Input","Output","HostListener","Pipe","NgModule","__awaiter","__rest","DOCUMENT","NG_VALUE_ACCESSOR","NG_VALIDATORS","NGX_MASK_CONFIG","NEW_CONFIG","INITIAL_CONFIG","initialConfig","suffix","prefix","thousandSeparator","decimalMarker","clearIfNotMatch","showTemplate","showMaskTyped","placeHolderCharacter","dropSpecialCharacters","hiddenInput","undefined","shownMaskExpression","separatorLimit","allowNegativeNumbers","validation","specialCharacters","leadZeroDateTime","apm","leadZero","keepCharacterPositions","triggerOnMaskChange","inputTransformFn","value","outputTransformFn","maskFilled","patterns","pattern","RegExp","optional","X","symbol","A","S","U","L","d","m","M","H","h","s","timeMasks","withoutValidation","NgxMaskApplierService","constructor","_config","_shift","Set","plusOnePosition","maskExpression","actualValue","showKeepCharacterExp","deletedSpecialCharacter","_formatWithSeparators","str","thousandSeparatorChar","decimalChars","precision","_a","_b","_c","x","decimalChar","Array","isArray","regExp","map","v","indexOf","join","split","match","decimals","length","res","replace","slice","rgx","test","substring","percentage","sanitizedStr","Number","isNaN","getPrecision","Infinity","checkAndRemoveSuffix","inputValue","_d","i","substr","includes","checkInputPrecision","marker","find","dm","precisionRegEx","_charToRegExpExpression","precisionMatch","precisionMatchLength","diff","_compareOrIncludes","applyMaskWithPattern","maskAndPattern","mask","customPattern","applyMask","position","justPasted","backspaced","cb","_e","_f","_g","_h","_j","_k","_l","_m","_o","_p","_q","_r","_s","cursor","result","multi","backspaceShift","shift","stepBack","inputArray","toString","valuesIP","ipError","_validIP","arr","push","cpfCnpjError","startsWith","_stripToDecimal","base","_splitPercentZero","thousandSeparatorCharEscaped","invalidChars","invalidCharRegexp","strForSep","commaShift","shiftStep","add","clear","inputSymbol","symbolStarInPattern","_checkSymbolMask","_shiftStep","daysCount","inputValueCursor","inputValueCursorPlusOne","inputValueCursorPlusTwo","inputValueCursorMinusOne","inputValueCursorMinusTwo","inputValueCursorMinusThree","inputValueSliceMinusThreeMinusOne","inputValueSliceMinusOnePlusOne","inputValueSliceCursorPlusTwo","inputValueSliceMinusTwoCursor","maskStartWithMonth","startWithMonthInput","monthsCount","withoutDays","specialChart","day1monthInput","day2monthInput","day2monthInputDot","day1monthPaste","day2monthPaste","_findSpecialChar","newPosition","has","actualShift","onlySpecial","every","char","_findDropSpecialChar","val","maskSymbol","filter","idx","isDecimalMarker","charsToEscape","inputLength","comparedValue","excludedValue","some","index","decimalIndex","parsedValue","parseInt","integerPart","decimalPart","integerString","decimal","ɵfac","ɵprov","type","decorators","args","NgxMaskService","document","_elementRef","_renderer","isNumberValue","maskIsShown","selStart","selEnd","writingValue","maskChanged","_maskExpressionArray","_emitValue","_previousValue","_currentValue","onChange","_","showMaskInInput","formControlResult","getSymbol","newInputValue","actualResult","splice","removeMask","shiftTypedSymbols","Boolean","getActualValue","item","hideInput","resLen","prefNmask","countSkipedSymbol","_numberSkipedSymbols","regex","exec","applyValueChanges","formElement","nativeElement","_getActiveElement","clearIfNotMatchFn","curr","compare","maskChar","symbolToReplace","currSymbol","replaceSymbol","numberToString","String","toLocaleString","useGrouping","maximumFractionDigits","inputVal","Error","_checkForIp","_checkForCpfCnpj","formElementProperty","name","Promise","resolve","then","setProperty","checkDropSpecialCharAmount","chars","_removeMask","_removeSuffix","_removePrefix","concat","cpf","cnpj","shadowRootEl","activeElement","shadowRoot","_toNumber","_checkSymbols","num","specialCharactersForRemove","_regExpForRemove","_retrieveSeparatorValue","_checkPatternForSpace","_replaceDecimalMarkerToDot","markers","separatorPrecision","_retrieveSeparatorPrecision","separatorValue","_checkPrecision","key","hasOwnProperty","patternString","maskExpretion","matcher","separatorExpression","toFixed","_repeatPatternSymbols","maskExp","reduce","accum","currVal","_start","_end","repeatNumber","replaceWith","symbols","currentLocaleDecimalMarker","ElementRef","Renderer2","NgxMaskDirective","_maskService","_maskValue","_isFocused","_position","_justPasted","_isComposing","onTouch","ngOnChanges","changes","currentValue","previousValue","firstChange","sort","a","b","_setMask","c","requestAnimationFrame","click","_applyMask","validate","_createValidationError","_validateTime","counterOfOpt","lastIndexOf","opt","array","lastIndexArray","special","emit","onPaste","onFocus","onModelChange","onInput","e","el","target","transformedValue","_inputValue","selectionStart","prefixLength","checkSymbols","checkSpecialCharacter","selectRangeBackspace","_code","part1","part2","caretShift","_backspaceShift","positionToApply","_getActualInputLength","setSelectionRange","console","warn","onCompositionStart","onCompositionEnd","onBlur","repeat","onClick","posStart","posEnd","selectionEnd","keyCode","focus","nextValue","onKeyDown","code","preventDefault","checkSelectionOnDeletion","cursorStart","readOnly","ctrlKey","metaKey","writeValue","controlValue","setDisabledState","disable","localeDecimalMarker","registerOnChange","fn","registerOnTouched","Math","min","max","isDisabled","rowMaskLen","requiredMask","expression","check","character","indexMask","charAt","ɵdir","provide","useExisting","selector","providers","exportAs","NgxMaskPipe","defaultOptions","transform","config","currentConfig","Object","assign","entries","forEach","ɵpipe","pure","_configFactory","initConfig","configValue","Function","NgxMaskModule","forRoot","ngModule","useValue","useFactory","deps","forChild","ɵmod","ɵinj","exports","declarations"],"mappings":"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","sourcesContent":["import * as i0 from '@angular/core';\nimport { InjectionToken, EventEmitter, Injectable, Inject, Optional, forwardRef, Directive, Input, Output, HostListener, Pipe, NgModule } from '@angular/core';\nimport { __awaiter, __rest } from 'tslib';\nimport { DOCUMENT } from '@angular/common';\nimport { NG_VALUE_ACCESSOR, NG_VALIDATORS } from '@angular/forms';\n\nconst NGX_MASK_CONFIG = new InjectionToken('ngx-mask config');\nconst NEW_CONFIG = new InjectionToken('new ngx-mask config');\nconst INITIAL_CONFIG = new InjectionToken('initial ngx-mask config');\nconst initialConfig = {\n    suffix: '',\n    prefix: '',\n    thousandSeparator: ' ',\n    decimalMarker: ['.', ','],\n    clearIfNotMatch: false,\n    showTemplate: false,\n    showMaskTyped: false,\n    placeHolderCharacter: '_',\n    dropSpecialCharacters: true,\n    hiddenInput: undefined,\n    shownMaskExpression: '',\n    separatorLimit: '',\n    allowNegativeNumbers: false,\n    validation: true,\n    // eslint-disable-next-line @typescript-eslint/quotes\n    specialCharacters: ['-', '/', '(', ')', '.', ':', ' ', '+', ',', '@', '[', ']', '\"', \"'\"],\n    leadZeroDateTime: false,\n    apm: false,\n    leadZero: false,\n    keepCharacterPositions: false,\n    triggerOnMaskChange: false,\n    inputTransformFn: (value) => value,\n    outputTransformFn: (value) => value,\n    maskFilled: new EventEmitter(),\n    patterns: {\n        '0': {\n            pattern: new RegExp('\\\\d'),\n        },\n        '9': {\n            pattern: new RegExp('\\\\d'),\n            optional: true,\n        },\n        X: {\n            pattern: new RegExp('\\\\d'),\n            symbol: '*',\n        },\n        A: {\n            pattern: new RegExp('[a-zA-Z0-9]'),\n        },\n        S: {\n            pattern: new RegExp('[a-zA-Z]'),\n        },\n        U: {\n            pattern: new RegExp('[A-Z]'),\n        },\n        L: {\n            pattern: new RegExp('[a-z]'),\n        },\n        d: {\n            pattern: new RegExp('\\\\d'),\n        },\n        m: {\n            pattern: new RegExp('\\\\d'),\n        },\n        M: {\n            pattern: new RegExp('\\\\d'),\n        },\n        H: {\n            pattern: new RegExp('\\\\d'),\n        },\n        h: {\n            pattern: new RegExp('\\\\d'),\n        },\n        s: {\n            pattern: new RegExp('\\\\d'),\n        },\n    },\n};\nconst timeMasks = [\n    \"Hh:m0:s0\" /* HOURS_MINUTES_SECONDS */,\n    \"Hh:m0\" /* HOURS_MINUTES */,\n    \"m0:s0\" /* MINUTES_SECONDS */,\n];\nconst withoutValidation = [\n    \"percent\" /* PERCENT */,\n    \"Hh\" /* HOURS_HOUR */,\n    \"s0\" /* SECONDS */,\n    \"m0\" /* MINUTES */,\n    \"separator\" /* SEPARATOR */,\n    \"d0/M0/0000\" /* DAYS_MONTHS_YEARS */,\n    \"d0/M0\" /* DAYS_MONTHS */,\n    \"d0\" /* DAYS */,\n    \"M0\" /* MONTHS */,\n];\n\nclass NgxMaskApplierService {\n    constructor(_config) {\n        this._config = _config;\n        this._shift = new Set();\n        this.plusOnePosition = false;\n        this.maskExpression = '';\n        this.actualValue = '';\n        this.showKeepCharacterExp = '';\n        this.shownMaskExpression = '';\n        this.deletedSpecialCharacter = false;\n        this._formatWithSeparators = (str, thousandSeparatorChar, decimalChars, precision) => {\n            var _a, _b, _c;\n            let x = [];\n            let decimalChar = '';\n            if (Array.isArray(decimalChars)) {\n                const regExp = new RegExp(decimalChars.map((v) => ('[\\\\^$.|?*+()'.indexOf(v) >= 0 ? `\\\\${v}` : v)).join('|'));\n                x = str.split(regExp);\n                decimalChar = (_b = (_a = str.match(regExp)) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : \"\" /* EMPTY_STRING */;\n            }\n            else {\n                x = str.split(decimalChars);\n                decimalChar = decimalChars;\n            }\n            const decimals = x.length > 1 ? `${decimalChar}${x[1]}` : \"\" /* EMPTY_STRING */;\n            let res = (_c = x[0]) !== null && _c !== void 0 ? _c : \"\" /* EMPTY_STRING */;\n            const separatorLimit = this.separatorLimit.replace(/\\s/g, \"\" /* EMPTY_STRING */);\n            if (separatorLimit && +separatorLimit) {\n                if (res[0] === \"-\" /* MINUS */) {\n                    res = `-${res.slice(1, res.length).slice(0, separatorLimit.length)}`;\n                }\n                else {\n                    res = res.slice(0, separatorLimit.length);\n                }\n            }\n            const rgx = /(\\d+)(\\d{3})/;\n            while (thousandSeparatorChar && rgx.test(res)) {\n                res = res.replace(rgx, '$1' + thousandSeparatorChar + '$2');\n            }\n            if (precision === undefined) {\n                return res + decimals;\n            }\n            else if (precision === 0) {\n                return res;\n            }\n            return res + decimals.substring(0, precision + 1);\n        };\n        this.percentage = (str) => {\n            const sanitizedStr = str.replace(',', '.');\n            const value = Number(sanitizedStr);\n            return !isNaN(value) && value >= 0 && value <= 100;\n        };\n        this.getPrecision = (maskExpression) => {\n            const x = maskExpression.split(\".\" /* DOT */);\n            if (x.length > 1) {\n                return Number(x[x.length - 1]);\n            }\n            return Infinity;\n        };\n        this.checkAndRemoveSuffix = (inputValue) => {\n            var _a, _b, _c, _d;\n            for (let i = ((_a = this.suffix) === null || _a === void 0 ? void 0 : _a.length) - 1; i >= 0; i--) {\n                const substr = this.suffix.substring(i, (_b = this.suffix) === null || _b === void 0 ? void 0 : _b.length);\n                if (inputValue.includes(substr) &&\n                    i !== ((_c = this.suffix) === null || _c === void 0 ? void 0 : _c.length) - 1 &&\n                    (i - 1 < 0 ||\n                        !inputValue.includes(this.suffix.substring(i - 1, (_d = this.suffix) === null || _d === void 0 ? void 0 : _d.length)))) {\n                    return inputValue.replace(substr, \"\" /* EMPTY_STRING */);\n                }\n            }\n            return inputValue;\n        };\n        this.checkInputPrecision = (inputValue, precision, decimalMarker) => {\n            var _a, _b;\n            if (precision < Infinity) {\n                // TODO need think about decimalMarker\n                if (Array.isArray(decimalMarker)) {\n                    const marker = decimalMarker.find((dm) => dm !== this.thousandSeparator);\n                    // eslint-disable-next-line no-param-reassign\n                    decimalMarker = marker ? marker : decimalMarker[0];\n                }\n                const precisionRegEx = new RegExp(this._charToRegExpExpression(decimalMarker) + `\\\\d{${precision}}.*$`);\n                const precisionMatch = inputValue.match(precisionRegEx);\n                const precisionMatchLength = (_b = (precisionMatch && ((_a = precisionMatch[0]) === null || _a === void 0 ? void 0 : _a.length))) !== null && _b !== void 0 ? _b : 0;\n                if (precisionMatchLength - 1 > precision) {\n                    const diff = precisionMatchLength - 1 - precision;\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue = inputValue.substring(0, inputValue.length - diff);\n                }\n                if (precision === 0 &&\n                    this._compareOrIncludes(inputValue[inputValue.length - 1], decimalMarker, this.thousandSeparator)) {\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue = inputValue.substring(0, inputValue.length - 1);\n                }\n            }\n            return inputValue;\n        };\n        this.dropSpecialCharacters = this._config.dropSpecialCharacters;\n        this.hiddenInput = this._config.hiddenInput;\n        this.clearIfNotMatch = this._config.clearIfNotMatch;\n        this.specialCharacters = this._config.specialCharacters;\n        this.patterns = this._config.patterns;\n        this.prefix = this._config.prefix;\n        this.suffix = this._config.suffix;\n        this.thousandSeparator = this._config.thousandSeparator;\n        this.decimalMarker = this._config.decimalMarker;\n        this.showMaskTyped = this._config.showMaskTyped;\n        this.placeHolderCharacter = this._config.placeHolderCharacter;\n        this.validation = this._config.validation;\n        this.separatorLimit = this._config.separatorLimit;\n        this.allowNegativeNumbers = this._config.allowNegativeNumbers;\n        this.leadZeroDateTime = this._config.leadZeroDateTime;\n        this.leadZero = this._config.leadZero;\n        this.apm = this._config.apm;\n        this.inputTransformFn = this._config.inputTransformFn;\n        this.outputTransformFn = this._config.outputTransformFn;\n        this.keepCharacterPositions = this._config.keepCharacterPositions;\n    }\n    applyMaskWithPattern(inputValue, maskAndPattern) {\n        const [mask, customPattern] = maskAndPattern;\n        this.customPattern = customPattern;\n        return this.applyMask(inputValue, mask);\n    }\n    applyMask(inputValue, maskExpression, position = 0, justPasted = false, backspaced = false, \n    // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n    cb = () => { }) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s;\n        if (!maskExpression || typeof inputValue !== 'string') {\n            return \"\" /* EMPTY_STRING */;\n        }\n        let cursor = 0;\n        let result = '';\n        let multi = false;\n        let backspaceShift = false;\n        let shift = 1;\n        let stepBack = false;\n        if (inputValue.slice(0, this.prefix.length) === this.prefix) {\n            // eslint-disable-next-line no-param-reassign\n            inputValue = inputValue.slice(this.prefix.length, inputValue.length);\n        }\n        if (!!this.suffix && (inputValue === null || inputValue === void 0 ? void 0 : inputValue.length) > 0) {\n            // eslint-disable-next-line no-param-reassign\n            inputValue = this.checkAndRemoveSuffix(inputValue);\n        }\n        if (inputValue === '(' && this.prefix) {\n            // eslint-disable-next-line no-param-reassign\n            inputValue = '';\n        }\n        const inputArray = inputValue.toString().split(\"\" /* EMPTY_STRING */);\n        if (this.allowNegativeNumbers &&\n            inputValue.slice(cursor, cursor + 1) === \"-\" /* MINUS */) {\n            // eslint-disable-next-line no-param-reassign\n            result += inputValue.slice(cursor, cursor + 1);\n        }\n        if (maskExpression === \"IP\" /* IP */) {\n            const valuesIP = inputValue.split(\".\" /* DOT */);\n            this.ipError = this._validIP(valuesIP);\n            // eslint-disable-next-line no-param-reassign\n            maskExpression = '099.099.099.099';\n        }\n        const arr = [];\n        for (let i = 0; i < inputValue.length; i++) {\n            if ((_a = inputValue[i]) === null || _a === void 0 ? void 0 : _a.match('\\\\d')) {\n                arr.push((_b = inputValue[i]) !== null && _b !== void 0 ? _b : \"\" /* EMPTY_STRING */);\n            }\n        }\n        if (maskExpression === \"CPF_CNPJ\" /* CPF_CNPJ */) {\n            this.cpfCnpjError = arr.length !== 11 && arr.length !== 14;\n            if (arr.length > 11) {\n                // eslint-disable-next-line no-param-reassign\n                maskExpression = '00.000.000/0000-00';\n            }\n            else {\n                // eslint-disable-next-line no-param-reassign\n                maskExpression = '000.000.000-00';\n            }\n        }\n        if (maskExpression.startsWith(\"percent\" /* PERCENT */)) {\n            if (inputValue.match('[a-z]|[A-Z]') ||\n                // eslint-disable-next-line no-useless-escape\n                (inputValue.match(/[-!$%^&*()_+|~=`{}\\[\\]:\";'<>?,\\/.]/) && !backspaced)) {\n                // eslint-disable-next-line no-param-reassign\n                inputValue = this._stripToDecimal(inputValue);\n                const precision = this.getPrecision(maskExpression);\n                // eslint-disable-next-line no-param-reassign\n                inputValue = this.checkInputPrecision(inputValue, precision, this.decimalMarker);\n            }\n            const decimalMarker = typeof this.decimalMarker === 'string' ? this.decimalMarker : \".\" /* DOT */;\n            if (inputValue.indexOf(decimalMarker) > 0 &&\n                !this.percentage(inputValue.substring(0, inputValue.indexOf(decimalMarker)))) {\n                let base = inputValue.substring(0, inputValue.indexOf(decimalMarker) - 1);\n                if (this.allowNegativeNumbers &&\n                    inputValue.slice(cursor, cursor + 1) === \"-\" /* MINUS */ &&\n                    !backspaced) {\n                    base = inputValue.substring(0, inputValue.indexOf(decimalMarker));\n                }\n                // eslint-disable-next-line no-param-reassign\n                inputValue = `${base}${inputValue.substring(inputValue.indexOf(decimalMarker), inputValue.length)}`;\n            }\n            let value = '';\n            this.allowNegativeNumbers &&\n                inputValue.slice(cursor, cursor + 1) === \"-\" /* MINUS */\n                ? (value = inputValue.slice(cursor + 1, cursor + inputValue.length))\n                : (value = inputValue);\n            if (this.percentage(value)) {\n                result = this._splitPercentZero(inputValue);\n            }\n            else {\n                result = this._splitPercentZero(inputValue.substring(0, inputValue.length - 1));\n            }\n        }\n        else if (maskExpression.startsWith(\"separator\" /* SEPARATOR */)) {\n            if (inputValue.match('[wа-яА-Я]') ||\n                inputValue.match('[ЁёА-я]') ||\n                inputValue.match('[a-z]|[A-Z]') ||\n                inputValue.match(/[-@#!$%\\\\^&*()_£¬'+|~=`{}\\]:\";<>.?/]/) ||\n                inputValue.match('[^A-Za-z0-9,]')) {\n                // eslint-disable-next-line no-param-reassign\n                inputValue = this._stripToDecimal(inputValue);\n            }\n            const precision = this.getPrecision(maskExpression);\n            const decimalMarker = Array.isArray(this.decimalMarker)\n                ? \".\" /* DOT */\n                : this.decimalMarker;\n            if (precision === 0) {\n                // eslint-disable-next-line no-param-reassign\n                inputValue = this.allowNegativeNumbers\n                    ? inputValue.length > 2 &&\n                        inputValue[0] === \"-\" /* MINUS */ &&\n                        inputValue[1] === \"0\" /* NUMBER_ZERO */ &&\n                        inputValue[2] !== this.thousandSeparator &&\n                        inputValue[2] !== \",\" /* COMMA */ &&\n                        inputValue[2] !== \".\" /* DOT */\n                        ? '-' + inputValue.slice(2, inputValue.length)\n                        : inputValue[0] === \"0\" /* NUMBER_ZERO */ &&\n                            inputValue.length > 1 &&\n                            inputValue[1] !== this.thousandSeparator &&\n                            inputValue[1] !== \",\" /* COMMA */ &&\n                            inputValue[1] !== \".\" /* DOT */\n                            ? inputValue.slice(1, inputValue.length)\n                            : inputValue\n                    : inputValue.length > 1 &&\n                        inputValue[0] === \"0\" /* NUMBER_ZERO */ &&\n                        inputValue[1] !== this.thousandSeparator &&\n                        inputValue[1] !== \",\" /* COMMA */ &&\n                        inputValue[1] !== \".\" /* DOT */\n                        ? inputValue.slice(1, inputValue.length)\n                        : inputValue;\n            }\n            else {\n                // eslint-disable-next-line no-param-reassign\n                if (inputValue[0] === decimalMarker && inputValue.length > 1) {\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue =\n                        \"0\" /* NUMBER_ZERO */ + inputValue.slice(0, inputValue.length + 1);\n                    this.plusOnePosition = true;\n                }\n                if (inputValue[0] === \"0\" /* NUMBER_ZERO */ &&\n                    inputValue[1] !== decimalMarker &&\n                    inputValue[1] !== this.thousandSeparator) {\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue =\n                        inputValue.length > 1\n                            ? inputValue.slice(0, 1) +\n                                decimalMarker +\n                                inputValue.slice(1, inputValue.length + 1)\n                            : inputValue;\n                    this.plusOnePosition = true;\n                }\n                if (this.allowNegativeNumbers &&\n                    inputValue[0] === \"-\" /* MINUS */ &&\n                    (inputValue[1] === decimalMarker ||\n                        inputValue[1] === \"0\" /* NUMBER_ZERO */)) {\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue =\n                        inputValue[1] === decimalMarker && inputValue.length > 2\n                            ? inputValue.slice(0, 1) +\n                                \"0\" /* NUMBER_ZERO */ +\n                                inputValue.slice(1, inputValue.length)\n                            : inputValue[1] === \"0\" /* NUMBER_ZERO */ &&\n                                inputValue.length > 2 &&\n                                inputValue[2] !== decimalMarker\n                                ? inputValue.slice(0, 2) +\n                                    decimalMarker +\n                                    inputValue.slice(2, inputValue.length)\n                                : inputValue;\n                    this.plusOnePosition = true;\n                }\n            }\n            if (backspaced) {\n                if (inputValue[0] === \"0\" /* NUMBER_ZERO */ &&\n                    inputValue[1] === this.decimalMarker &&\n                    (inputValue[position] === \"0\" /* NUMBER_ZERO */ ||\n                        inputValue[position] === this.decimalMarker)) {\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue = inputValue.slice(2, inputValue.length);\n                }\n                if (inputValue[0] === \"-\" /* MINUS */ &&\n                    inputValue[1] === \"0\" /* NUMBER_ZERO */ &&\n                    inputValue[2] === this.decimalMarker &&\n                    (inputValue[position] === \"0\" /* NUMBER_ZERO */ ||\n                        inputValue[position] === this.decimalMarker)) {\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue = \"-\" /* MINUS */ + inputValue.slice(3, inputValue.length);\n                }\n                // eslint-disable-next-line no-param-reassign\n                inputValue = this._compareOrIncludes(inputValue[inputValue.length - 1], this.decimalMarker, this.thousandSeparator)\n                    ? inputValue.slice(0, inputValue.length - 1)\n                    : inputValue;\n            }\n            // TODO: we had different rexexps here for the different cases... but tests dont seam to bother - check this\n            //  separator: no COMMA, dot-sep: no SPACE, COMMA OK, comma-sep: no SPACE, COMMA OK\n            const thousandSeparatorCharEscaped = this._charToRegExpExpression(this.thousandSeparator);\n            let invalidChars = '@#!$%^&*()_+|~=`{}\\\\[\\\\]:\\\\s,\\\\.\";<>?\\\\/'.replace(thousandSeparatorCharEscaped, '');\n            //.replace(decimalMarkerEscaped, '');\n            if (Array.isArray(this.decimalMarker)) {\n                for (const marker of this.decimalMarker) {\n                    invalidChars = invalidChars.replace(this._charToRegExpExpression(marker), \"\" /* EMPTY_STRING */);\n                }\n            }\n            else {\n                invalidChars = invalidChars.replace(this._charToRegExpExpression(this.decimalMarker), '');\n            }\n            const invalidCharRegexp = new RegExp('[' + invalidChars + ']');\n            if (inputValue.match(invalidCharRegexp)) {\n                // eslint-disable-next-line no-param-reassign\n                inputValue = inputValue.substring(0, inputValue.length - 1);\n            }\n            // eslint-disable-next-line no-param-reassign\n            inputValue = this.checkInputPrecision(inputValue, precision, this.decimalMarker);\n            const strForSep = inputValue.replace(new RegExp(thousandSeparatorCharEscaped, 'g'), '');\n            result = this._formatWithSeparators(strForSep, this.thousandSeparator, this.decimalMarker, precision);\n            const commaShift = result.indexOf(\",\" /* COMMA */) - inputValue.indexOf(\",\" /* COMMA */);\n            const shiftStep = result.length - inputValue.length;\n            if (shiftStep > 0 && result[position] !== this.thousandSeparator) {\n                backspaceShift = true;\n                let _shift = 0;\n                do {\n                    this._shift.add(position + _shift);\n                    _shift++;\n                } while (_shift < shiftStep);\n            }\n            else if (result[position - 1] === this.decimalMarker ||\n                shiftStep === -4 ||\n                shiftStep === -3 ||\n                result[position] === \",\" /* COMMA */) {\n                this._shift.clear();\n                this._shift.add(position - 1);\n            }\n            else if ((commaShift !== 0 &&\n                position > 0 &&\n                !(result.indexOf(\",\" /* COMMA */) >= position && position > 3)) ||\n                (!(result.indexOf(\".\" /* DOT */) >= position && position > 3) &&\n                    shiftStep <= 0)) {\n                this._shift.clear();\n                backspaceShift = true;\n                shift = shiftStep;\n                // eslint-disable-next-line no-param-reassign\n                position += shiftStep;\n                this._shift.add(position);\n            }\n            else {\n                this._shift.clear();\n            }\n        }\n        else {\n            for (\n            // eslint-disable-next-line\n            let i = 0, inputSymbol = inputArray[0]; i < inputArray.length; i++, inputSymbol = (_c = inputArray[i]) !== null && _c !== void 0 ? _c : \"\" /* EMPTY_STRING */) {\n                if (cursor === maskExpression.length) {\n                    break;\n                }\n                const symbolStarInPattern = \"*\" /* SYMBOL_STAR */ in this.patterns;\n                if (this._checkSymbolMask(inputSymbol, (_d = maskExpression[cursor]) !== null && _d !== void 0 ? _d : \"\" /* EMPTY_STRING */) &&\n                    maskExpression[cursor + 1] === \"?\" /* SYMBOL_QUESTION */) {\n                    result += inputSymbol;\n                    cursor += 2;\n                }\n                else if (maskExpression[cursor + 1] === \"*\" /* SYMBOL_STAR */ &&\n                    multi &&\n                    this._checkSymbolMask(inputSymbol, (_e = maskExpression[cursor + 2]) !== null && _e !== void 0 ? _e : \"\" /* EMPTY_STRING */)) {\n                    result += inputSymbol;\n                    cursor += 3;\n                    multi = false;\n                }\n                else if (this._checkSymbolMask(inputSymbol, (_f = maskExpression[cursor]) !== null && _f !== void 0 ? _f : \"\" /* EMPTY_STRING */) &&\n                    maskExpression[cursor + 1] === \"*\" /* SYMBOL_STAR */ &&\n                    !symbolStarInPattern) {\n                    result += inputSymbol;\n                    multi = true;\n                }\n                else if (maskExpression[cursor + 1] === \"?\" /* SYMBOL_QUESTION */ &&\n                    this._checkSymbolMask(inputSymbol, (_g = maskExpression[cursor + 2]) !== null && _g !== void 0 ? _g : \"\" /* EMPTY_STRING */)) {\n                    result += inputSymbol;\n                    cursor += 3;\n                }\n                else if (this._checkSymbolMask(inputSymbol, (_h = maskExpression[cursor]) !== null && _h !== void 0 ? _h : \"\" /* EMPTY_STRING */)) {\n                    if (maskExpression[cursor] === \"H\" /* HOURS */) {\n                        if (this.apm ? Number(inputSymbol) > 9 : Number(inputSymbol) > 2) {\n                            // eslint-disable-next-line no-param-reassign\n                            position = !this.leadZeroDateTime ? position + 1 : position;\n                            cursor += 1;\n                            this._shiftStep(maskExpression, cursor, inputArray.length);\n                            i--;\n                            if (this.leadZeroDateTime) {\n                                result += '0';\n                            }\n                            continue;\n                        }\n                    }\n                    if (maskExpression[cursor] === \"h\" /* HOUR */) {\n                        if (this.apm\n                            ? (result.length === 1 && Number(result) > 1) ||\n                                (result === '1' && Number(inputSymbol) > 2) ||\n                                (inputValue.slice(cursor - 1, cursor).length === 1 &&\n                                    Number(inputValue.slice(cursor - 1, cursor)) > 2) ||\n                                (inputValue.slice(cursor - 1, cursor) === '1' &&\n                                    Number(inputSymbol) > 2)\n                            : (result === '2' && Number(inputSymbol) > 3) ||\n                                ((result.slice(cursor - 2, cursor) === '2' ||\n                                    result.slice(cursor - 3, cursor) === '2' ||\n                                    result.slice(cursor - 4, cursor) === '2' ||\n                                    result.slice(cursor - 1, cursor) === '2') &&\n                                    Number(inputSymbol) > 3 &&\n                                    cursor > 10)) {\n                            // eslint-disable-next-line no-param-reassign\n                            position = position + 1;\n                            cursor += 1;\n                            i--;\n                            continue;\n                        }\n                    }\n                    if (maskExpression[cursor] === \"m\" /* MINUTE */ ||\n                        maskExpression[cursor] === \"s\" /* SECOND */) {\n                        if (Number(inputSymbol) > 5) {\n                            // eslint-disable-next-line no-param-reassign\n                            position = !this.leadZeroDateTime ? position + 1 : position;\n                            cursor += 1;\n                            this._shiftStep(maskExpression, cursor, inputArray.length);\n                            i--;\n                            if (this.leadZeroDateTime) {\n                                result += '0';\n                            }\n                            continue;\n                        }\n                    }\n                    const daysCount = 31;\n                    const inputValueCursor = inputValue[cursor];\n                    const inputValueCursorPlusOne = inputValue[cursor + 1];\n                    const inputValueCursorPlusTwo = inputValue[cursor + 2];\n                    const inputValueCursorMinusOne = inputValue[cursor - 1];\n                    const inputValueCursorMinusTwo = inputValue[cursor - 2];\n                    const inputValueCursorMinusThree = inputValue[cursor - 3];\n                    const inputValueSliceMinusThreeMinusOne = inputValue.slice(cursor - 3, cursor - 1);\n                    const inputValueSliceMinusOnePlusOne = inputValue.slice(cursor - 1, cursor + 1);\n                    const inputValueSliceCursorPlusTwo = inputValue.slice(cursor, cursor + 2);\n                    const inputValueSliceMinusTwoCursor = inputValue.slice(cursor - 2, cursor);\n                    if (maskExpression[cursor] === \"d\" /* DAY */) {\n                        const maskStartWithMonth = maskExpression.slice(0, 2) === \"M0\" /* MONTHS */;\n                        const startWithMonthInput = maskExpression.slice(0, 2) === \"M0\" /* MONTHS */ &&\n                            this.specialCharacters.includes(inputValueCursorMinusTwo);\n                        if ((Number(inputSymbol) > 3 && this.leadZeroDateTime) ||\n                            (!maskStartWithMonth &&\n                                (Number(inputValueSliceCursorPlusTwo) > daysCount ||\n                                    Number(inputValueSliceMinusOnePlusOne) > daysCount ||\n                                    this.specialCharacters.includes(inputValueCursorPlusOne))) ||\n                            (startWithMonthInput\n                                ? Number(inputValueSliceMinusOnePlusOne) > daysCount ||\n                                    (!this.specialCharacters.includes(inputValueCursor) &&\n                                        this.specialCharacters.includes(inputValueCursorPlusTwo)) ||\n                                    this.specialCharacters.includes(inputValueCursor)\n                                : Number(inputValueSliceCursorPlusTwo) > daysCount ||\n                                    this.specialCharacters.includes(inputValueCursorPlusOne))) {\n                            // eslint-disable-next-line no-param-reassign\n                            position = !this.leadZeroDateTime ? position + 1 : position;\n                            cursor += 1;\n                            this._shiftStep(maskExpression, cursor, inputArray.length);\n                            i--;\n                            if (this.leadZeroDateTime) {\n                                result += '0';\n                            }\n                            continue;\n                        }\n                    }\n                    if (maskExpression[cursor] === \"M\" /* MONTH */) {\n                        const monthsCount = 12;\n                        // mask without day\n                        const withoutDays = cursor === 0 &&\n                            (Number(inputSymbol) > 2 ||\n                                Number(inputValueSliceCursorPlusTwo) > monthsCount ||\n                                this.specialCharacters.includes(inputValueCursorPlusOne));\n                        // day<10 && month<12 for input\n                        const specialChart = maskExpression.slice(cursor + 2, cursor + 3);\n                        const day1monthInput = inputValueSliceMinusThreeMinusOne.includes(specialChart) &&\n                            ((this.specialCharacters.includes(inputValueCursorMinusTwo) &&\n                                Number(inputValueSliceMinusOnePlusOne) > monthsCount &&\n                                !this.specialCharacters.includes(inputValueCursor)) ||\n                                this.specialCharacters.includes(inputValueCursor) ||\n                                (this.specialCharacters.includes(inputValueCursorMinusThree) &&\n                                    Number(inputValueSliceMinusTwoCursor) > monthsCount &&\n                                    !this.specialCharacters.includes(inputValueCursorMinusOne)) ||\n                                this.specialCharacters.includes(inputValueCursorMinusOne));\n                        //  month<12 && day<10 for input\n                        const day2monthInput = Number(inputValueSliceMinusThreeMinusOne) <= daysCount &&\n                            !this.specialCharacters.includes(inputValueSliceMinusThreeMinusOne) &&\n                            this.specialCharacters.includes(inputValueCursorMinusOne) &&\n                            (Number(inputValueSliceCursorPlusTwo) > monthsCount ||\n                                this.specialCharacters.includes(inputValueCursorPlusOne));\n                        // cursor === 5 && without days\n                        const day2monthInputDot = (Number(inputValueSliceCursorPlusTwo) > monthsCount && cursor === 5) ||\n                            (this.specialCharacters.includes(inputValueCursorPlusOne) &&\n                                cursor === 5);\n                        // // day<10 && month<12 for paste whole data\n                        const day1monthPaste = Number(inputValueSliceMinusThreeMinusOne) > daysCount &&\n                            !this.specialCharacters.includes(inputValueSliceMinusThreeMinusOne) &&\n                            !this.specialCharacters.includes(inputValueSliceMinusTwoCursor) &&\n                            Number(inputValueSliceMinusTwoCursor) > monthsCount;\n                        // 10<day<31 && month<12 for paste whole data\n                        const day2monthPaste = Number(inputValueSliceMinusThreeMinusOne) <= daysCount &&\n                            !this.specialCharacters.includes(inputValueSliceMinusThreeMinusOne) &&\n                            !this.specialCharacters.includes(inputValueCursorMinusOne) &&\n                            Number(inputValueSliceMinusOnePlusOne) > monthsCount;\n                        if ((Number(inputSymbol) > 1 && this.leadZeroDateTime) ||\n                            withoutDays ||\n                            day1monthInput ||\n                            day2monthPaste ||\n                            day1monthPaste ||\n                            day2monthInput ||\n                            (day2monthInputDot && !this.leadZeroDateTime)) {\n                            // eslint-disable-next-line no-param-reassign\n                            position = !this.leadZeroDateTime ? position + 1 : position;\n                            cursor += 1;\n                            this._shiftStep(maskExpression, cursor, inputArray.length);\n                            i--;\n                            if (this.leadZeroDateTime) {\n                                result += '0';\n                            }\n                            continue;\n                        }\n                    }\n                    result += inputSymbol;\n                    cursor++;\n                }\n                else if ((inputSymbol === \" \" /* WHITE_SPACE */ &&\n                    maskExpression[cursor] === \" \" /* WHITE_SPACE */) ||\n                    (inputSymbol === \"/\" /* SLASH */ &&\n                        maskExpression[cursor] === \"/\" /* SLASH */)) {\n                    result += inputSymbol;\n                    cursor++;\n                }\n                else if (this.specialCharacters.indexOf((_j = maskExpression[cursor]) !== null && _j !== void 0 ? _j : \"\" /* EMPTY_STRING */) !== -1) {\n                    result += maskExpression[cursor];\n                    cursor++;\n                    this._shiftStep(maskExpression, cursor, inputArray.length);\n                    i--;\n                }\n                else if (maskExpression[cursor] === \"9\" /* NUMBER_NINE */ &&\n                    this.showMaskTyped) {\n                    this._shiftStep(maskExpression, cursor, inputArray.length);\n                }\n                else if (this.patterns[(_k = maskExpression[cursor]) !== null && _k !== void 0 ? _k : \"\" /* EMPTY_STRING */] &&\n                    ((_m = this.patterns[(_l = maskExpression[cursor]) !== null && _l !== void 0 ? _l : \"\" /* EMPTY_STRING */]) === null || _m === void 0 ? void 0 : _m.optional)) {\n                    if (!!inputArray[cursor] &&\n                        maskExpression !== '099.099.099.099' &&\n                        maskExpression !== '000.000.000-00' &&\n                        maskExpression !== '00.000.000/0000-00' &&\n                        !maskExpression.match(/^9+\\.0+$/) &&\n                        !((_p = this.patterns[(_o = maskExpression[cursor]) !== null && _o !== void 0 ? _o : \"\" /* EMPTY_STRING */]) === null || _p === void 0 ? void 0 : _p.optional)) {\n                        result += inputArray[cursor];\n                    }\n                    if (maskExpression.includes(\"9\" /* NUMBER_NINE */ + \"*\" /* SYMBOL_STAR */) &&\n                        maskExpression.includes(\"0\" /* NUMBER_ZERO */ + \"*\" /* SYMBOL_STAR */)) {\n                        cursor++;\n                    }\n                    cursor++;\n                    i--;\n                }\n                else if (this.maskExpression[cursor + 1] === \"*\" /* SYMBOL_STAR */ &&\n                    this._findSpecialChar((_q = this.maskExpression[cursor + 2]) !== null && _q !== void 0 ? _q : \"\" /* EMPTY_STRING */) &&\n                    this._findSpecialChar(inputSymbol) === this.maskExpression[cursor + 2] &&\n                    multi) {\n                    cursor += 3;\n                    result += inputSymbol;\n                }\n                else if (this.maskExpression[cursor + 1] === \"?\" /* SYMBOL_QUESTION */ &&\n                    this._findSpecialChar((_r = this.maskExpression[cursor + 2]) !== null && _r !== void 0 ? _r : \"\" /* EMPTY_STRING */) &&\n                    this._findSpecialChar(inputSymbol) === this.maskExpression[cursor + 2] &&\n                    multi) {\n                    cursor += 3;\n                    result += inputSymbol;\n                }\n                else if (this.showMaskTyped &&\n                    this.specialCharacters.indexOf(inputSymbol) < 0 &&\n                    inputSymbol !== this.placeHolderCharacter &&\n                    this.placeHolderCharacter.length === 1) {\n                    stepBack = true;\n                }\n            }\n        }\n        if (result.length + 1 === maskExpression.length &&\n            this.specialCharacters.indexOf((_s = maskExpression[maskExpression.length - 1]) !== null && _s !== void 0 ? _s : \"\" /* EMPTY_STRING */) !== -1) {\n            result += maskExpression[maskExpression.length - 1];\n        }\n        let newPosition = position + 1;\n        while (this._shift.has(newPosition)) {\n            shift++;\n            newPosition++;\n        }\n        let actualShift = justPasted && !maskExpression.startsWith(\"separator\" /* SEPARATOR */)\n            ? cursor\n            : this._shift.has(position)\n                ? shift\n                : 0;\n        if (stepBack) {\n            actualShift--;\n        }\n        cb(actualShift, backspaceShift);\n        if (shift < 0) {\n            this._shift.clear();\n        }\n        let onlySpecial = false;\n        if (backspaced) {\n            onlySpecial = inputArray.every((char) => this.specialCharacters.includes(char));\n        }\n        let res = `${this.prefix}${onlySpecial ? \"\" /* EMPTY_STRING */ : result}${this.showMaskTyped ? '' : this.suffix}`;\n        if (result.length === 0) {\n            res = !this.dropSpecialCharacters ? `${this.prefix}${result}` : `${result}`;\n        }\n        if (result.includes(\"-\" /* MINUS */) && this.prefix && this.allowNegativeNumbers) {\n            if (backspaced && result === \"-\" /* MINUS */) {\n                return '';\n            }\n            res = `${\"-\" /* MINUS */}${this.prefix}${result\n                .split(\"-\" /* MINUS */)\n                .join(\"\" /* EMPTY_STRING */)}${this.suffix}`;\n        }\n        return res;\n    }\n    _findDropSpecialChar(inputSymbol) {\n        if (Array.isArray(this.dropSpecialCharacters)) {\n            return this.dropSpecialCharacters.find((val) => val === inputSymbol);\n        }\n        return this._findSpecialChar(inputSymbol);\n    }\n    _findSpecialChar(inputSymbol) {\n        return this.specialCharacters.find((val) => val === inputSymbol);\n    }\n    _checkSymbolMask(inputSymbol, maskSymbol) {\n        var _a, _b, _c;\n        this.patterns = this.customPattern ? this.customPattern : this.patterns;\n        return ((_c = (((_a = this.patterns[maskSymbol]) === null || _a === void 0 ? void 0 : _a.pattern) &&\n            ((_b = this.patterns[maskSymbol]) === null || _b === void 0 ? void 0 : _b.pattern.test(inputSymbol)))) !== null && _c !== void 0 ? _c : false);\n    }\n    _stripToDecimal(str) {\n        return str\n            .split(\"\" /* EMPTY_STRING */)\n            .filter((i, idx) => {\n            const isDecimalMarker = typeof this.decimalMarker === 'string'\n                ? i === this.decimalMarker\n                : // TODO (inepipenko) use utility type\n                    this.decimalMarker.includes(i);\n            return (i.match('^-?\\\\d') ||\n                i === this.thousandSeparator ||\n                isDecimalMarker ||\n                (i === \"-\" /* MINUS */ && idx === 0 && this.allowNegativeNumbers));\n        })\n            .join(\"\" /* EMPTY_STRING */);\n    }\n    _charToRegExpExpression(char) {\n        // if (Array.isArray(char)) {\n        // \treturn char.map((v) => ('[\\\\^$.|?*+()'.indexOf(v) >= 0 ? `\\\\${v}` : v)).join('|');\n        // }\n        if (char) {\n            const charsToEscape = '[\\\\^$.|?*+()';\n            return char === ' ' ? '\\\\s' : charsToEscape.indexOf(char) >= 0 ? `\\\\${char}` : char;\n        }\n        return char;\n    }\n    _shiftStep(maskExpression, cursor, inputLength) {\n        const shiftStep = /[*?]/g.test(maskExpression.slice(0, cursor))\n            ? inputLength\n            : cursor;\n        this._shift.add(shiftStep + this.prefix.length || 0);\n    }\n    _compareOrIncludes(value, comparedValue, excludedValue) {\n        return Array.isArray(comparedValue)\n            ? comparedValue.filter((v) => v !== excludedValue).includes(value)\n            : value === comparedValue;\n    }\n    _validIP(valuesIP) {\n        return !(valuesIP.length === 4 &&\n            !valuesIP.some((value, index) => {\n                if (valuesIP.length !== index + 1) {\n                    return value === \"\" /* EMPTY_STRING */ || Number(value) > 255;\n                }\n                return value === \"\" /* EMPTY_STRING */ || Number(value.substring(0, 3)) > 255;\n            }));\n    }\n    _splitPercentZero(value) {\n        const decimalIndex = typeof this.decimalMarker === 'string'\n            ? value.indexOf(this.decimalMarker)\n            : value.indexOf(\".\" /* DOT */);\n        if (decimalIndex === -1) {\n            const parsedValue = parseInt(value, 10);\n            return isNaN(parsedValue) ? \"\" /* EMPTY_STRING */ : parsedValue.toString();\n        }\n        else {\n            const integerPart = parseInt(value.substring(0, decimalIndex), 10);\n            const decimalPart = value.substring(decimalIndex + 1);\n            const integerString = isNaN(integerPart) ? '' : integerPart.toString();\n            const decimal = typeof this.decimalMarker === 'string' ? this.decimalMarker : \".\" /* DOT */;\n            return integerString === \"\" /* EMPTY_STRING */\n                ? \"\" /* EMPTY_STRING */\n                : integerString + decimal + decimalPart;\n        }\n    }\n}\nNgxMaskApplierService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskApplierService, deps: [{ token: NGX_MASK_CONFIG }], target: i0.ɵɵFactoryTarget.Injectable });\nNgxMaskApplierService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskApplierService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskApplierService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () {\n        return [{ type: undefined, decorators: [{\n                        type: Inject,\n                        args: [NGX_MASK_CONFIG]\n                    }] }];\n    } });\n\nclass NgxMaskService extends NgxMaskApplierService {\n    constructor(document, _config, _elementRef, _renderer) {\n        super(_config);\n        this.document = document;\n        this._config = _config;\n        this._elementRef = _elementRef;\n        this._renderer = _renderer;\n        this.isNumberValue = false;\n        this.maskIsShown = '';\n        this.selStart = null;\n        this.selEnd = null;\n        /**\n         * Whether we are currently in writeValue function, in this case when applying the mask we don't want to trigger onChange function,\n         * since writeValue should be a one way only process of writing the DOM value based on the Angular model value.\n         */\n        this.writingValue = false;\n        this.maskChanged = false;\n        this._maskExpressionArray = [];\n        this.triggerOnMaskChange = false;\n        this._emitValue = false;\n        this._previousValue = '';\n        this._currentValue = '';\n        // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n        this.onChange = (_) => { };\n    }\n    // eslint-disable-next-line complexity\n    applyMask(inputValue, maskExpression, position = 0, justPasted = false, backspaced = false, \n    // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n    cb = () => { }) {\n        var _a, _b;\n        if (!maskExpression) {\n            return inputValue !== this.actualValue ? this.actualValue : inputValue;\n        }\n        this.maskIsShown = this.showMaskTyped\n            ? this.showMaskInInput()\n            : \"\" /* EMPTY_STRING */;\n        if (this.maskExpression === \"IP\" /* IP */ && this.showMaskTyped) {\n            this.maskIsShown = this.showMaskInInput(inputValue || \"#\" /* HASH */);\n        }\n        if (this.maskExpression === \"CPF_CNPJ\" /* CPF_CNPJ */ && this.showMaskTyped) {\n            this.maskIsShown = this.showMaskInInput(inputValue || \"#\" /* HASH */);\n        }\n        if (!inputValue && this.showMaskTyped) {\n            this.formControlResult(this.prefix);\n            return this.prefix + this.maskIsShown + this.suffix;\n        }\n        const getSymbol = !!inputValue && typeof this.selStart === 'number'\n            ? (_a = inputValue[this.selStart]) !== null && _a !== void 0 ? _a : \"\" /* EMPTY_STRING */\n            : \"\" /* EMPTY_STRING */;\n        let newInputValue = '';\n        if (this.hiddenInput !== undefined && !this.writingValue) {\n            let actualResult = inputValue && inputValue.length === 1\n                ? inputValue.split(\"\" /* EMPTY_STRING */)\n                : this.actualValue.split(\"\" /* EMPTY_STRING */);\n            // eslint-disable  @typescript-eslint/no-unused-expressions\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            if (typeof this.selStart === 'object' && typeof this.selEnd === 'object') {\n                this.selStart = Number(this.selStart);\n                this.selEnd = Number(this.selEnd);\n            }\n            else {\n                inputValue !== \"\" /* EMPTY_STRING */ && actualResult.length\n                    ? typeof this.selStart === 'number' && typeof this.selEnd === 'number'\n                        ? inputValue.length > actualResult.length\n                            ? actualResult.splice(this.selStart, 0, getSymbol)\n                            : inputValue.length < actualResult.length\n                                ? actualResult.length - inputValue.length === 1\n                                    ? backspaced\n                                        ? actualResult.splice(this.selStart - 1, 1)\n                                        : actualResult.splice(inputValue.length - 1, 1)\n                                    : actualResult.splice(this.selStart, this.selEnd - this.selStart)\n                                : null\n                        : null\n                    : (actualResult = []);\n            }\n            if (this.showMaskTyped) {\n                if (!this.hiddenInput) {\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue = this.removeMask(inputValue);\n                }\n            }\n            // eslint-enable  @typescript-eslint/no-unused-expressions\n            newInputValue =\n                this.actualValue.length && actualResult.length <= inputValue.length\n                    ? this.shiftTypedSymbols(actualResult.join(\"\" /* EMPTY_STRING */))\n                    : inputValue;\n        }\n        if (justPasted && (this.hiddenInput || !this.hiddenInput)) {\n            newInputValue = inputValue;\n        }\n        if (backspaced &&\n            this.specialCharacters.indexOf((_b = this.maskExpression[position]) !== null && _b !== void 0 ? _b : \"\" /* EMPTY_STRING */) !== -1 &&\n            this.showMaskTyped) {\n            newInputValue = this._currentValue;\n        }\n        if (this.deletedSpecialCharacter && position) {\n            if (this.specialCharacters.includes(this.actualValue.slice(position, position + 1))) {\n                // eslint-disable-next-line no-param-reassign\n                position = position + 1;\n            }\n            else if (maskExpression.slice(position - 1, position + 1) !== \"M0\" /* MONTHS */) {\n                // eslint-disable-next-line no-param-reassign\n                position = position - 2;\n            }\n            // eslint-disable-next-line no-param-reassign\n            this.deletedSpecialCharacter = false;\n        }\n        if (this.showMaskTyped &&\n            this.placeHolderCharacter.length === 1 &&\n            !this.leadZeroDateTime) {\n            // eslint-disable-next-line no-param-reassign\n            inputValue = this.removeMask(inputValue);\n        }\n        if (this.maskChanged) {\n            newInputValue = inputValue;\n        }\n        else {\n            newInputValue =\n                Boolean(newInputValue) && newInputValue.length ? newInputValue : inputValue;\n        }\n        if (this.showMaskTyped && this.keepCharacterPositions && this.actualValue && !justPasted) {\n            const value = this.dropSpecialCharacters\n                ? this.removeMask(this.actualValue)\n                : this.actualValue;\n            this.formControlResult(value);\n            return this.actualValue\n                ? this.actualValue\n                : this.prefix + this.maskIsShown + this.suffix;\n        }\n        const result = super.applyMask(newInputValue, maskExpression, position, justPasted, backspaced, cb);\n        this.actualValue = this.getActualValue(result);\n        // handle some separator implications:\n        // a.) adjust decimalMarker default (. -> ,) if thousandSeparator is a dot\n        if (this.thousandSeparator === \".\" /* DOT */ &&\n            this.decimalMarker === \".\" /* DOT */) {\n            this.decimalMarker = \",\" /* COMMA */;\n        }\n        // b) remove decimal marker from list of special characters to mask\n        if (this.maskExpression.startsWith(\"separator\" /* SEPARATOR */) &&\n            this.dropSpecialCharacters === true) {\n            this.specialCharacters = this.specialCharacters.filter((item) => !this._compareOrIncludes(item, this.decimalMarker, this.thousandSeparator) //item !== this.decimalMarker, // !\n            );\n        }\n        if (result || result === '') {\n            this._previousValue = this._currentValue;\n            this._currentValue = result;\n            this._emitValue =\n                this._previousValue !== this._currentValue ||\n                    this.maskChanged ||\n                    (this._previousValue === this._currentValue && justPasted);\n        }\n        this._emitValue ? this.formControlResult(result) : '';\n        if (!this.showMaskTyped || (this.showMaskTyped && this.hiddenInput)) {\n            if (this.hiddenInput) {\n                if (backspaced) {\n                    return this.hideInput(result, this.maskExpression);\n                }\n                return (this.hideInput(result, this.maskExpression) +\n                    this.maskIsShown.slice(result.length));\n            }\n            return result;\n        }\n        const resLen = result.length;\n        const prefNmask = this.prefix + this.maskIsShown + this.suffix;\n        if (this.maskExpression.includes(\"H\" /* HOURS */)) {\n            const countSkipedSymbol = this._numberSkipedSymbols(result);\n            return result + prefNmask.slice(resLen + countSkipedSymbol);\n        }\n        else if (this.maskExpression === \"IP\" /* IP */ ||\n            this.maskExpression === \"CPF_CNPJ\" /* CPF_CNPJ */) {\n            return result + prefNmask;\n        }\n        return result + prefNmask.slice(resLen);\n    }\n    // get the number of characters that were shifted\n    _numberSkipedSymbols(value) {\n        const regex = /(^|\\D)(\\d\\D)/g;\n        let match = regex.exec(value);\n        let countSkipedSymbol = 0;\n        while (match != null) {\n            countSkipedSymbol += 1;\n            match = regex.exec(value);\n        }\n        return countSkipedSymbol;\n    }\n    applyValueChanges(position, justPasted, backspaced, \n    // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n    cb = () => { }) {\n        var _a;\n        const formElement = (_a = this._elementRef) === null || _a === void 0 ? void 0 : _a.nativeElement;\n        if (!formElement) {\n            return;\n        }\n        formElement.value = this.applyMask(formElement.value, this.maskExpression, position, justPasted, backspaced, cb);\n        if (formElement === this._getActiveElement()) {\n            return;\n        }\n        this.clearIfNotMatchFn();\n    }\n    hideInput(inputValue, maskExpression) {\n        return inputValue\n            .split(\"\" /* EMPTY_STRING */)\n            .map((curr, index) => {\n            var _a, _b, _c, _d, _e;\n            if (this.patterns &&\n                this.patterns[(_a = maskExpression[index]) !== null && _a !== void 0 ? _a : \"\" /* EMPTY_STRING */] &&\n                ((_c = this.patterns[(_b = maskExpression[index]) !== null && _b !== void 0 ? _b : \"\" /* EMPTY_STRING */]) === null || _c === void 0 ? void 0 : _c.symbol)) {\n                return (_e = this.patterns[(_d = maskExpression[index]) !== null && _d !== void 0 ? _d : \"\" /* EMPTY_STRING */]) === null || _e === void 0 ? void 0 : _e.symbol;\n            }\n            return curr;\n        })\n            .join(\"\" /* EMPTY_STRING */);\n    }\n    // this function is not necessary, it checks result against maskExpression\n    getActualValue(res) {\n        const compare = res\n            .split(\"\" /* EMPTY_STRING */)\n            .filter((symbol, i) => {\n            var _a;\n            const maskChar = (_a = this.maskExpression[i]) !== null && _a !== void 0 ? _a : \"\" /* EMPTY_STRING */;\n            return (this._checkSymbolMask(symbol, maskChar) ||\n                (this.specialCharacters.includes(maskChar) && symbol === maskChar));\n        });\n        if (compare.join(\"\" /* EMPTY_STRING */) === res) {\n            return compare.join(\"\" /* EMPTY_STRING */);\n        }\n        return res;\n    }\n    shiftTypedSymbols(inputValue) {\n        let symbolToReplace = '';\n        const newInputValue = (inputValue &&\n            inputValue\n                .split(\"\" /* EMPTY_STRING */)\n                .map((currSymbol, index) => {\n                var _a;\n                if (this.specialCharacters.includes((_a = inputValue[index + 1]) !== null && _a !== void 0 ? _a : \"\" /* EMPTY_STRING */) &&\n                    inputValue[index + 1] !== this.maskExpression[index + 1]) {\n                    symbolToReplace = currSymbol;\n                    return inputValue[index + 1];\n                }\n                if (symbolToReplace.length) {\n                    const replaceSymbol = symbolToReplace;\n                    symbolToReplace = \"\" /* EMPTY_STRING */;\n                    return replaceSymbol;\n                }\n                return currSymbol;\n            })) ||\n            [];\n        return newInputValue.join(\"\" /* EMPTY_STRING */);\n    }\n    /**\n     * Convert number value to string\n     * 3.1415 -> '3.1415'\n     * 1e-7 -> '0.0000001'\n     */\n    numberToString(value) {\n        if ((!value && value !== 0) ||\n            (this.maskExpression.startsWith(\"separator\" /* SEPARATOR */) &&\n                (this.leadZero || !this.dropSpecialCharacters)) ||\n            (this.maskExpression.startsWith(\"separator\" /* SEPARATOR */) &&\n                this.separatorLimit.length > 14 &&\n                String(value).length > 14)) {\n            return String(value);\n        }\n        return Number(value)\n            .toLocaleString('fullwide', {\n            useGrouping: false,\n            maximumFractionDigits: 20,\n        })\n            .replace(`/${\"-\" /* MINUS */}/`, \"-\" /* MINUS */);\n    }\n    showMaskInInput(inputVal) {\n        if (this.showMaskTyped && !!this.shownMaskExpression) {\n            if (this.maskExpression.length !== this.shownMaskExpression.length) {\n                throw new Error('Mask expression must match mask placeholder length');\n            }\n            else {\n                return this.shownMaskExpression;\n            }\n        }\n        else if (this.showMaskTyped) {\n            if (inputVal) {\n                if (this.maskExpression === \"IP\" /* IP */) {\n                    return this._checkForIp(inputVal);\n                }\n                if (this.maskExpression === \"CPF_CNPJ\" /* CPF_CNPJ */) {\n                    return this._checkForCpfCnpj(inputVal);\n                }\n            }\n            if (this.placeHolderCharacter.length === this.maskExpression.length) {\n                return this.placeHolderCharacter;\n            }\n            return this.maskExpression.replace(/\\w/g, this.placeHolderCharacter);\n        }\n        return '';\n    }\n    clearIfNotMatchFn() {\n        var _a;\n        const formElement = (_a = this._elementRef) === null || _a === void 0 ? void 0 : _a.nativeElement;\n        if (!formElement) {\n            return;\n        }\n        if (this.clearIfNotMatch &&\n            this.prefix.length + this.maskExpression.length + this.suffix.length !==\n                formElement.value.replace(this.placeHolderCharacter, \"\" /* EMPTY_STRING */)\n                    .length) {\n            this.formElementProperty = ['value', \"\" /* EMPTY_STRING */];\n            this.applyMask('', this.maskExpression);\n        }\n    }\n    set formElementProperty([name, value]) {\n        if (!this._renderer || !this._elementRef) {\n            return;\n        }\n        Promise.resolve().then(() => { var _a, _b; return (_a = this._renderer) === null || _a === void 0 ? void 0 : _a.setProperty((_b = this._elementRef) === null || _b === void 0 ? void 0 : _b.nativeElement, name, value); });\n    }\n    checkDropSpecialCharAmount(mask) {\n        const chars = mask\n            .split(\"\" /* EMPTY_STRING */)\n            .filter((item) => this._findDropSpecialChar(item));\n        return chars.length;\n    }\n    removeMask(inputValue) {\n        return this._removeMask(this._removeSuffix(this._removePrefix(inputValue)), this.specialCharacters.concat('_').concat(this.placeHolderCharacter));\n    }\n    _checkForIp(inputVal) {\n        var _a;\n        if (inputVal === \"#\" /* HASH */) {\n            return `${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;\n        }\n        const arr = [];\n        for (let i = 0; i < inputVal.length; i++) {\n            const value = (_a = inputVal[i]) !== null && _a !== void 0 ? _a : \"\" /* EMPTY_STRING */;\n            if (!value) {\n                continue;\n            }\n            if (value.match('\\\\d')) {\n                arr.push(value);\n            }\n        }\n        if (arr.length <= 3) {\n            return `${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;\n        }\n        if (arr.length > 3 && arr.length <= 6) {\n            return `${this.placeHolderCharacter}.${this.placeHolderCharacter}`;\n        }\n        if (arr.length > 6 && arr.length <= 9) {\n            return this.placeHolderCharacter;\n        }\n        if (arr.length > 9 && arr.length <= 12) {\n            return '';\n        }\n        return '';\n    }\n    _checkForCpfCnpj(inputVal) {\n        var _a;\n        const cpf = `${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n            `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n            `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n            `-${this.placeHolderCharacter}${this.placeHolderCharacter}`;\n        const cnpj = `${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n            `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n            `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n            `/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n            `-${this.placeHolderCharacter}${this.placeHolderCharacter}`;\n        if (inputVal === \"#\" /* HASH */) {\n            return cpf;\n        }\n        const arr = [];\n        for (let i = 0; i < inputVal.length; i++) {\n            const value = (_a = inputVal[i]) !== null && _a !== void 0 ? _a : \"\" /* EMPTY_STRING */;\n            if (!value) {\n                continue;\n            }\n            if (value.match('\\\\d')) {\n                arr.push(value);\n            }\n        }\n        if (arr.length <= 3) {\n            return cpf.slice(arr.length, cpf.length);\n        }\n        if (arr.length > 3 && arr.length <= 6) {\n            return cpf.slice(arr.length + 1, cpf.length);\n        }\n        if (arr.length > 6 && arr.length <= 9) {\n            return cpf.slice(arr.length + 2, cpf.length);\n        }\n        if (arr.length > 9 && arr.length < 11) {\n            return cpf.slice(arr.length + 3, cpf.length);\n        }\n        if (arr.length === 11) {\n            return '';\n        }\n        if (arr.length === 12) {\n            if (inputVal.length === 17) {\n                return cnpj.slice(16, cnpj.length);\n            }\n            return cnpj.slice(15, cnpj.length);\n        }\n        if (arr.length > 12 && arr.length <= 14) {\n            return cnpj.slice(arr.length + 4, cnpj.length);\n        }\n        return '';\n    }\n    /**\n     * Recursively determine the current active element by navigating the Shadow DOM until the Active Element is found.\n     */\n    _getActiveElement(document = this.document) {\n        var _a;\n        const shadowRootEl = (_a = document === null || document === void 0 ? void 0 : document.activeElement) === null || _a === void 0 ? void 0 : _a.shadowRoot;\n        if (!(shadowRootEl === null || shadowRootEl === void 0 ? void 0 : shadowRootEl.activeElement)) {\n            return document.activeElement;\n        }\n        else {\n            return this._getActiveElement(shadowRootEl);\n        }\n    }\n    /**\n     * Propogates the input value back to the Angular model by triggering the onChange function. It won't do this if writingValue\n     * is true. If that is true it means we are currently in the writeValue function, which is supposed to only update the actual\n     * DOM element based on the Angular model value. It should be a one way process, i.e. writeValue should not be modifying the Angular\n     * model value too. Therefore, we don't trigger onChange in this scenario.\n     * @param inputValue the current form input value\n     */\n    formControlResult(inputValue) {\n        if (this.writingValue || (!this.triggerOnMaskChange && this.maskChanged)) {\n            this.maskChanged\n                ? this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(inputValue))))))\n                : '';\n            this.maskChanged = false;\n            return;\n        }\n        if (Array.isArray(this.dropSpecialCharacters)) {\n            this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(inputValue)), this.dropSpecialCharacters)))));\n        }\n        else if (this.dropSpecialCharacters ||\n            (!this.dropSpecialCharacters && this.prefix === inputValue)) {\n            this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(inputValue))))));\n        }\n        else {\n            this.onChange(this.outputTransformFn(this._toNumber(inputValue)));\n        }\n    }\n    _toNumber(value) {\n        if (!this.isNumberValue || value === \"\" /* EMPTY_STRING */) {\n            return value;\n        }\n        if (this.maskExpression.startsWith(\"separator\" /* SEPARATOR */) &&\n            (this.leadZero || !this.dropSpecialCharacters)) {\n            return value;\n        }\n        if (String(value).length > 16 && this.separatorLimit.length > 14) {\n            return String(value);\n        }\n        const num = Number(value);\n        if (this.maskExpression.startsWith(\"separator\" /* SEPARATOR */) && Number.isNaN(num)) {\n            const val = String(value).replace(',', '.');\n            return Number(val);\n        }\n        return Number.isNaN(num) ? value : num;\n    }\n    _removeMask(value, specialCharactersForRemove) {\n        if (this.maskExpression.startsWith(\"percent\" /* PERCENT */) &&\n            value.includes(\".\" /* DOT */)) {\n            return value;\n        }\n        return value\n            ? value.replace(this._regExpForRemove(specialCharactersForRemove), \"\" /* EMPTY_STRING */)\n            : value;\n    }\n    _removePrefix(value) {\n        if (!this.prefix) {\n            return value;\n        }\n        return value ? value.replace(this.prefix, \"\" /* EMPTY_STRING */) : value;\n    }\n    _removeSuffix(value) {\n        if (!this.suffix) {\n            return value;\n        }\n        return value ? value.replace(this.suffix, \"\" /* EMPTY_STRING */) : value;\n    }\n    _retrieveSeparatorValue(result) {\n        let specialCharacters = Array.isArray(this.dropSpecialCharacters)\n            ? this.specialCharacters.filter((v) => {\n                return this.dropSpecialCharacters.includes(v);\n            })\n            : this.specialCharacters;\n        if (!this.deletedSpecialCharacter &&\n            this._checkPatternForSpace() &&\n            result.includes(\" \" /* WHITE_SPACE */) &&\n            this.maskExpression.includes(\"*\" /* SYMBOL_STAR */)) {\n            specialCharacters = specialCharacters.filter((char) => char !== \" \" /* WHITE_SPACE */);\n        }\n        return this._removeMask(result, specialCharacters);\n    }\n    _regExpForRemove(specialCharactersForRemove) {\n        return new RegExp(specialCharactersForRemove.map((item) => `\\\\${item}`).join('|'), 'gi');\n    }\n    _replaceDecimalMarkerToDot(value) {\n        const markers = Array.isArray(this.decimalMarker)\n            ? this.decimalMarker\n            : [this.decimalMarker];\n        return value.replace(this._regExpForRemove(markers), \".\" /* DOT */);\n    }\n    _checkSymbols(result) {\n        if (result === \"\" /* EMPTY_STRING */) {\n            return result;\n        }\n        if (this.maskExpression.startsWith(\"percent\" /* PERCENT */) &&\n            this.decimalMarker === \",\" /* COMMA */) {\n            // eslint-disable-next-line no-param-reassign\n            result = result.replace(\",\" /* COMMA */, \".\" /* DOT */);\n        }\n        const separatorPrecision = this._retrieveSeparatorPrecision(this.maskExpression);\n        const separatorValue = this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(result));\n        if (!this.isNumberValue) {\n            return separatorValue;\n        }\n        if (separatorPrecision) {\n            if (result === this.decimalMarker) {\n                return null;\n            }\n            if (this.separatorLimit.length > 14) {\n                return String(separatorValue);\n            }\n            return this._checkPrecision(this.maskExpression, separatorValue);\n        }\n        else {\n            return separatorValue;\n        }\n    }\n    _checkPatternForSpace() {\n        var _a, _b, _c;\n        for (const key in this.patterns) {\n            // eslint-disable-next-line no-prototype-builtins\n            if (this.patterns[key] && ((_a = this.patterns[key]) === null || _a === void 0 ? void 0 : _a.hasOwnProperty('pattern'))) {\n                const patternString = (_b = this.patterns[key]) === null || _b === void 0 ? void 0 : _b.pattern.toString();\n                const pattern = (_c = this.patterns[key]) === null || _c === void 0 ? void 0 : _c.pattern;\n                if ((patternString === null || patternString === void 0 ? void 0 : patternString.includes(\" \" /* WHITE_SPACE */)) &&\n                    (pattern === null || pattern === void 0 ? void 0 : pattern.test(this.maskExpression))) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    // TODO should think about helpers or separting decimal precision to own property\n    _retrieveSeparatorPrecision(maskExpretion) {\n        const matcher = maskExpretion.match(new RegExp(`^separator\\\\.([^d]*)`));\n        return matcher ? Number(matcher[1]) : null;\n    }\n    _checkPrecision(separatorExpression, separatorValue) {\n        const separatorPrecision = separatorExpression.slice(10, 11);\n        if (separatorExpression.indexOf('2') > 0 ||\n            (this.leadZero && Number(separatorPrecision) > 1)) {\n            if (this.decimalMarker === \",\" /* COMMA */ && this.leadZero) {\n                // eslint-disable-next-line no-param-reassign\n                separatorValue = separatorValue.replace(',', '.');\n            }\n            return this.leadZero\n                ? Number(separatorValue).toFixed(Number(separatorPrecision))\n                : Number(separatorValue).toFixed(2);\n        }\n        return this.numberToString(separatorValue);\n    }\n    _repeatPatternSymbols(maskExp) {\n        return ((maskExp.match(/{[0-9]+}/) &&\n            maskExp\n                .split(\"\" /* EMPTY_STRING */)\n                .reduce((accum, currVal, index) => {\n                this._start =\n                    currVal === \"{\" /* CURLY_BRACKETS_LEFT */ ? index : this._start;\n                if (currVal !== \"}\" /* CURLY_BRACKETS_RIGHT */) {\n                    return this._findSpecialChar(currVal) ? accum + currVal : accum;\n                }\n                this._end = index;\n                const repeatNumber = Number(maskExp.slice(this._start + 1, this._end));\n                const replaceWith = new Array(repeatNumber + 1).join(maskExp[this._start - 1]);\n                if (maskExp.slice(0, this._start).length > 1 &&\n                    maskExp.includes(\"S\" /* LETTER_S */)) {\n                    const symbols = maskExp.slice(0, this._start - 1);\n                    return symbols.includes(\"{\" /* CURLY_BRACKETS_LEFT */)\n                        ? accum + replaceWith\n                        : symbols + accum + replaceWith;\n                }\n                else {\n                    return accum + replaceWith;\n                }\n            }, '')) ||\n            maskExp);\n    }\n    currentLocaleDecimalMarker() {\n        return (1.1).toLocaleString().substring(1, 2);\n    }\n}\nNgxMaskService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskService, deps: [{ token: DOCUMENT }, { token: NGX_MASK_CONFIG }, { token: i0.ElementRef, optional: true }, { token: i0.Renderer2, optional: true }], target: i0.ɵɵFactoryTarget.Injectable });\nNgxMaskService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () {\n        return [{ type: undefined, decorators: [{\n                        type: Inject,\n                        args: [DOCUMENT]\n                    }] }, { type: undefined, decorators: [{\n                        type: Inject,\n                        args: [NGX_MASK_CONFIG]\n                    }] }, { type: i0.ElementRef, decorators: [{\n                        type: Optional\n                    }] }, { type: i0.Renderer2, decorators: [{\n                        type: Optional\n                    }] }];\n    } });\n\n// tslint:disable deprecation\n// tslint:disable no-input-rename\nclass NgxMaskDirective {\n    constructor(\n    // tslint:disable-next-line\n    document, _config, _maskService) {\n        this.document = document;\n        this._config = _config;\n        this._maskService = _maskService;\n        // eslint-disable-next-line @angular-eslint/no-input-rename\n        this.maskExpression = '';\n        this.specialCharacters = [];\n        this.patterns = {};\n        this.prefix = '';\n        this.suffix = '';\n        this.thousandSeparator = ' ';\n        this.decimalMarker = '.';\n        this.dropSpecialCharacters = null;\n        this.hiddenInput = null;\n        this.showMaskTyped = null;\n        this.placeHolderCharacter = null;\n        this.shownMaskExpression = null;\n        this.showTemplate = null;\n        this.clearIfNotMatch = null;\n        this.validation = null;\n        this.separatorLimit = null;\n        this.allowNegativeNumbers = null;\n        this.leadZeroDateTime = null;\n        this.leadZero = null;\n        this.triggerOnMaskChange = null;\n        this.apm = null;\n        this.inputTransformFn = null;\n        this.outputTransformFn = null;\n        this.keepCharacterPositions = null;\n        this.maskFilled = new EventEmitter();\n        this._maskValue = '';\n        this._isFocused = false;\n        this._position = null;\n        this._maskExpressionArray = [];\n        this._justPasted = false;\n        /**For IME composition event */\n        this._isComposing = false;\n        // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-explicit-any\n        this.onChange = (_) => { };\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        this.onTouch = () => { };\n    }\n    ngOnChanges(changes) {\n        const { maskExpression, specialCharacters, patterns, prefix, suffix, thousandSeparator, decimalMarker, dropSpecialCharacters, hiddenInput, showMaskTyped, placeHolderCharacter, shownMaskExpression, showTemplate, clearIfNotMatch, validation, separatorLimit, allowNegativeNumbers, leadZeroDateTime, leadZero, triggerOnMaskChange, apm, inputTransformFn, outputTransformFn, keepCharacterPositions, } = changes;\n        if (maskExpression) {\n            if (maskExpression.currentValue !== maskExpression.previousValue &&\n                !maskExpression.firstChange) {\n                this._maskService.maskChanged = true;\n            }\n            if (maskExpression.currentValue &&\n                maskExpression.currentValue.split(\"||\" /* OR */).length > 1) {\n                this._maskExpressionArray = maskExpression.currentValue\n                    .split(\"||\" /* OR */)\n                    .sort((a, b) => {\n                    return a.length - b.length;\n                });\n                this._setMask();\n            }\n            else {\n                this._maskExpressionArray = [];\n                this._maskValue = maskExpression.currentValue || \"\" /* EMPTY_STRING */;\n                this._maskService.maskExpression = this._maskValue;\n            }\n        }\n        if (specialCharacters) {\n            if (!specialCharacters.currentValue || !Array.isArray(specialCharacters.currentValue)) {\n                return;\n            }\n            else {\n                this._maskService.specialCharacters = specialCharacters.currentValue || [];\n            }\n        }\n        if (allowNegativeNumbers) {\n            this._maskService.allowNegativeNumbers = allowNegativeNumbers.currentValue;\n            if (this._maskService.allowNegativeNumbers) {\n                this._maskService.specialCharacters = this._maskService.specialCharacters.filter((c) => c !== \"-\" /* MINUS */);\n            }\n        }\n        // Only overwrite the mask available patterns if a pattern has actually been passed in\n        if (patterns && patterns.currentValue) {\n            this._maskService.patterns = patterns.currentValue;\n        }\n        if (apm && apm.currentValue) {\n            this._maskService.apm = apm.currentValue;\n        }\n        if (prefix) {\n            this._maskService.prefix = prefix.currentValue;\n        }\n        if (suffix) {\n            this._maskService.suffix = suffix.currentValue;\n        }\n        if (thousandSeparator) {\n            this._maskService.thousandSeparator = thousandSeparator.currentValue;\n        }\n        if (decimalMarker) {\n            this._maskService.decimalMarker = decimalMarker.currentValue;\n        }\n        if (dropSpecialCharacters) {\n            this._maskService.dropSpecialCharacters = dropSpecialCharacters.currentValue;\n        }\n        if (hiddenInput) {\n            this._maskService.hiddenInput = hiddenInput.currentValue;\n        }\n        if (showMaskTyped) {\n            this._maskService.showMaskTyped = showMaskTyped.currentValue;\n            if (showMaskTyped.previousValue === false &&\n                showMaskTyped.currentValue === true &&\n                this._isFocused) {\n                requestAnimationFrame(() => {\n                    var _a;\n                    (_a = this._maskService._elementRef) === null || _a === void 0 ? void 0 : _a.nativeElement.click();\n                });\n            }\n        }\n        if (placeHolderCharacter) {\n            this._maskService.placeHolderCharacter = placeHolderCharacter.currentValue;\n        }\n        if (shownMaskExpression) {\n            this._maskService.shownMaskExpression = shownMaskExpression.currentValue;\n        }\n        if (showTemplate) {\n            this._maskService.showTemplate = showTemplate.currentValue;\n        }\n        if (clearIfNotMatch) {\n            this._maskService.clearIfNotMatch = clearIfNotMatch.currentValue;\n        }\n        if (validation) {\n            this._maskService.validation = validation.currentValue;\n        }\n        if (separatorLimit) {\n            this._maskService.separatorLimit = separatorLimit.currentValue;\n        }\n        if (leadZeroDateTime) {\n            this._maskService.leadZeroDateTime = leadZeroDateTime.currentValue;\n        }\n        if (leadZero) {\n            this._maskService.leadZero = leadZero.currentValue;\n        }\n        if (triggerOnMaskChange) {\n            this._maskService.triggerOnMaskChange = triggerOnMaskChange.currentValue;\n        }\n        if (inputTransformFn) {\n            this._maskService.inputTransformFn = inputTransformFn.currentValue;\n        }\n        if (outputTransformFn) {\n            this._maskService.outputTransformFn = outputTransformFn.currentValue;\n        }\n        if (keepCharacterPositions) {\n            this._maskService.keepCharacterPositions = keepCharacterPositions.currentValue;\n        }\n        this._applyMask();\n    }\n    // eslint-disable-next-line complexity\n    validate({ value }) {\n        var _a, _b, _c;\n        if (!this._maskService.validation || !this._maskValue) {\n            return null;\n        }\n        if (this._maskService.ipError) {\n            return this._createValidationError(value);\n        }\n        if (this._maskService.cpfCnpjError) {\n            return this._createValidationError(value);\n        }\n        if (this._maskValue.startsWith(\"separator\" /* SEPARATOR */)) {\n            return null;\n        }\n        if (withoutValidation.includes(this._maskValue)) {\n            return null;\n        }\n        if (this._maskService.clearIfNotMatch) {\n            return null;\n        }\n        if (timeMasks.includes(this._maskValue)) {\n            return this._validateTime(value);\n        }\n        if (value && value.toString().length >= 1) {\n            let counterOfOpt = 0;\n            if (this._maskValue.startsWith(\"percent\" /* PERCENT */)) {\n                return null;\n            }\n            for (const key in this._maskService.patterns) {\n                if ((_a = this._maskService.patterns[key]) === null || _a === void 0 ? void 0 : _a.optional) {\n                    if (this._maskValue.indexOf(key) !== this._maskValue.lastIndexOf(key)) {\n                        const opt = this._maskValue\n                            .split(\"\" /* EMPTY_STRING */)\n                            .filter((i) => i === key)\n                            .join(\"\" /* EMPTY_STRING */);\n                        counterOfOpt += opt.length;\n                    }\n                    else if (this._maskValue.indexOf(key) !== -1) {\n                        counterOfOpt++;\n                    }\n                    if (this._maskValue.indexOf(key) !== -1 &&\n                        value.toString().length >= this._maskValue.indexOf(key)) {\n                        return null;\n                    }\n                    if (counterOfOpt === this._maskValue.length) {\n                        return null;\n                    }\n                }\n            }\n            if (this._maskValue.indexOf(\"{\" /* CURLY_BRACKETS_LEFT */) === 1 &&\n                value.toString().length ===\n                    this._maskValue.length +\n                        Number(((_b = this._maskValue.split(\"{\" /* CURLY_BRACKETS_LEFT */)[1]) !== null && _b !== void 0 ? _b : \"\" /* EMPTY_STRING */).split(\"}\" /* CURLY_BRACKETS_RIGHT */)[0]) -\n                        4) {\n                return null;\n            }\n            else if ((this._maskValue.indexOf(\"*\" /* SYMBOL_STAR */) > 1 &&\n                value.toString().length <\n                    this._maskValue.indexOf(\"*\" /* SYMBOL_STAR */)) ||\n                (this._maskValue.indexOf(\"?\" /* SYMBOL_QUESTION */) > 1 &&\n                    value.toString().length <\n                        this._maskValue.indexOf(\"?\" /* SYMBOL_QUESTION */)) ||\n                this._maskValue.indexOf(\"{\" /* CURLY_BRACKETS_LEFT */) === 1) {\n                return this._createValidationError(value);\n            }\n            if (this._maskValue.indexOf(\"*\" /* SYMBOL_STAR */) === -1 ||\n                this._maskValue.indexOf(\"?\" /* SYMBOL_QUESTION */) === -1) {\n                // eslint-disable-next-line no-param-reassign\n                value = typeof value === 'number' ? String(value) : value;\n                const array = this._maskValue.split('*');\n                const length = this._maskService.dropSpecialCharacters\n                    ? this._maskValue.length -\n                        this._maskService.checkDropSpecialCharAmount(this._maskValue) -\n                        counterOfOpt\n                    : this.prefix\n                        ? this._maskValue.length + this.prefix.length - counterOfOpt\n                        : this._maskValue.length - counterOfOpt;\n                if (array.length === 1) {\n                    if (value.toString().length < length) {\n                        return this._createValidationError(value);\n                    }\n                }\n                if (array.length > 1) {\n                    const lastIndexArray = array[array.length - 1];\n                    if (lastIndexArray &&\n                        this._maskService.specialCharacters.includes(lastIndexArray[0]) &&\n                        String(value).includes((_c = lastIndexArray[0]) !== null && _c !== void 0 ? _c : '') &&\n                        !this.dropSpecialCharacters) {\n                        const special = value.split(lastIndexArray[0]);\n                        return special[special.length - 1].length === lastIndexArray.length - 1\n                            ? null\n                            : this._createValidationError(value);\n                    }\n                    else if (((lastIndexArray &&\n                        !this._maskService.specialCharacters.includes(lastIndexArray[0])) ||\n                        !lastIndexArray ||\n                        this._maskService.dropSpecialCharacters) &&\n                        value.length >= length - 1) {\n                        return null;\n                    }\n                    else {\n                        return this._createValidationError(value);\n                    }\n                }\n            }\n            if (this._maskValue.indexOf(\"*\" /* SYMBOL_STAR */) === 1 ||\n                this._maskValue.indexOf(\"?\" /* SYMBOL_QUESTION */) === 1) {\n                return null;\n            }\n        }\n        if (value) {\n            this.maskFilled.emit();\n            return null;\n        }\n        return null;\n    }\n    onPaste() {\n        this._justPasted = true;\n    }\n    onFocus() {\n        this._isFocused = true;\n    }\n    onModelChange(value) {\n        // on form reset we need to update the actualValue\n        if ((value === \"\" /* EMPTY_STRING */ || value === null || value === undefined) &&\n            this._maskService.actualValue) {\n            this._maskService.actualValue = this._maskService.getActualValue(\"\" /* EMPTY_STRING */);\n        }\n    }\n    onInput(e) {\n        var _a, _b, _c, _d, _e;\n        // If IME is composing text, we wait for the composed text.\n        if (this._isComposing)\n            return;\n        const el = e.target;\n        const transformedValue = this._maskService.inputTransformFn(el.value);\n        if (el.type !== 'number') {\n            if (typeof transformedValue === 'string' || typeof transformedValue === 'number') {\n                el.value = transformedValue.toString();\n                this._inputValue = el.value;\n                this._setMask();\n                if (!this._maskValue) {\n                    this.onChange(el.value);\n                    return;\n                }\n                let position = el.selectionStart === 1\n                    ? el.selectionStart + this._maskService.prefix.length\n                    : el.selectionStart;\n                if (this.showMaskTyped &&\n                    this.keepCharacterPositions &&\n                    this._maskService.placeHolderCharacter.length === 1) {\n                    const inputSymbol = el.value.slice(position - 1, position);\n                    const prefixLength = this.prefix.length;\n                    const checkSymbols = this._maskService._checkSymbolMask(inputSymbol, (_a = this._maskService.maskExpression[position - 1 - prefixLength]) !== null && _a !== void 0 ? _a : \"\" /* EMPTY_STRING */);\n                    const checkSpecialCharacter = this._maskService._checkSymbolMask(inputSymbol, (_b = this._maskService.maskExpression[position + 1 - prefixLength]) !== null && _b !== void 0 ? _b : \"\" /* EMPTY_STRING */);\n                    const selectRangeBackspace = this._maskService.selStart === this._maskService.selEnd;\n                    const selStart = (_c = Number(this._maskService.selStart) - prefixLength) !== null && _c !== void 0 ? _c : '';\n                    const selEnd = (_d = Number(this._maskService.selEnd) - prefixLength) !== null && _d !== void 0 ? _d : '';\n                    if (this._code === \"Backspace\" /* BACKSPACE */) {\n                        if (!selectRangeBackspace) {\n                            if (this._maskService.selStart === prefixLength) {\n                                this._maskService.actualValue =\n                                    this.prefix +\n                                        this._maskService.maskIsShown.slice(0, selEnd) +\n                                        this._inputValue.split(this.prefix).join('');\n                            }\n                            else if (this._maskService.selStart ===\n                                this._maskService.maskIsShown.length + prefixLength) {\n                                this._maskService.actualValue =\n                                    this._inputValue +\n                                        this._maskService.maskIsShown.slice(selStart, selEnd);\n                            }\n                            else {\n                                this._maskService.actualValue =\n                                    this.prefix +\n                                        this._inputValue\n                                            .split(this.prefix)\n                                            .join('')\n                                            .slice(0, selStart) +\n                                        this._maskService.maskIsShown.slice(selStart, selEnd) +\n                                        this._maskService.actualValue.slice(selEnd + prefixLength, this._maskService.maskIsShown.length + prefixLength) +\n                                        this.suffix;\n                            }\n                        }\n                        else if (!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(position - this.prefix.length, position + 1 - this.prefix.length)) &&\n                            selectRangeBackspace) {\n                            if (selStart === 1 && this.prefix) {\n                                this._maskService.actualValue =\n                                    this.prefix +\n                                        this._maskService.placeHolderCharacter +\n                                        el.value\n                                            .split(this.prefix)\n                                            .join('')\n                                            .split(this.suffix)\n                                            .join('') +\n                                        this.suffix;\n                                position = position - 1;\n                            }\n                            else {\n                                const part1 = el.value.substring(0, position);\n                                const part2 = el.value.substring(position);\n                                this._maskService.actualValue =\n                                    part1 + this._maskService.placeHolderCharacter + part2;\n                            }\n                        }\n                    }\n                    if (this._code !== \"Backspace\" /* BACKSPACE */) {\n                        if (!checkSymbols && !checkSpecialCharacter && selectRangeBackspace) {\n                            position = Number(el.selectionStart) - 1;\n                        }\n                        else if (this._maskService.specialCharacters.includes(el.value.slice(position, position + 1)) &&\n                            checkSpecialCharacter &&\n                            !this._maskService.specialCharacters.includes(el.value.slice(position + 1, position + 2))) {\n                            this._maskService.actualValue =\n                                el.value.slice(0, position - 1) +\n                                    el.value.slice(position, position + 1) +\n                                    inputSymbol +\n                                    el.value.slice(position + 2);\n                            position = position + 1;\n                        }\n                        else if (checkSymbols) {\n                            if (el.value.length === 1 && position === 1) {\n                                this._maskService.actualValue =\n                                    this.prefix +\n                                        inputSymbol +\n                                        this._maskService.maskIsShown.slice(1, this._maskService.maskIsShown.length) +\n                                        this.suffix;\n                            }\n                            else {\n                                this._maskService.actualValue =\n                                    el.value.slice(0, position - 1) +\n                                        inputSymbol +\n                                        el.value\n                                            .slice(position + 1)\n                                            .split(this.suffix)\n                                            .join('') +\n                                        this.suffix;\n                            }\n                        }\n                        else if (this.prefix &&\n                            el.value.length === 1 &&\n                            position - prefixLength === 1 &&\n                            this._maskService._checkSymbolMask(el.value, (_e = this._maskService.maskExpression[position - 1 - prefixLength]) !== null && _e !== void 0 ? _e : \"\" /* EMPTY_STRING */)) {\n                            this._maskService.actualValue =\n                                this.prefix +\n                                    el.value +\n                                    this._maskService.maskIsShown.slice(1, this._maskService.maskIsShown.length) +\n                                    this.suffix;\n                        }\n                    }\n                }\n                let caretShift = 0;\n                let backspaceShift = false;\n                if (this._code === \"Delete\" /* DELETE */ && \"separator\" /* SEPARATOR */) {\n                    this._maskService.deletedSpecialCharacter = true;\n                }\n                if (this._inputValue.length >= this._maskService.maskExpression.length - 1 &&\n                    this._code !== \"Backspace\" /* BACKSPACE */ &&\n                    this._maskService.maskExpression === \"d0/M0/0000\" /* DAYS_MONTHS_YEARS */ &&\n                    position < 10) {\n                    const inputSymbol = this._inputValue.slice(position - 1, position);\n                    el.value =\n                        this._inputValue.slice(0, position - 1) +\n                            inputSymbol +\n                            this._inputValue.slice(position + 1);\n                }\n                if (this._maskService.maskExpression === \"d0/M0/0000\" /* DAYS_MONTHS_YEARS */ &&\n                    this.leadZeroDateTime) {\n                    if ((position < 3 && Number(el.value) > 31 && Number(el.value) < 40) ||\n                        (position === 5 && Number(el.value.slice(3, 5)) > 12)) {\n                        position = position + 2;\n                    }\n                }\n                if (this._maskService.maskExpression === \"Hh:m0:s0\" /* HOURS_MINUTES_SECONDS */ &&\n                    this.apm) {\n                    if (this._justPasted && el.value.slice(0, 2) === \"00\" /* DOUBLE_ZERO */) {\n                        el.value = el.value.slice(1, 2) + el.value.slice(2, el.value.length);\n                    }\n                    el.value =\n                        el.value === \"00\" /* DOUBLE_ZERO */\n                            ? \"0\" /* NUMBER_ZERO */\n                            : el.value;\n                }\n                this._maskService.applyValueChanges(position, this._justPasted, this._code === \"Backspace\" /* BACKSPACE */ || this._code === \"Delete\" /* DELETE */, (shift, _backspaceShift) => {\n                    this._justPasted = false;\n                    caretShift = shift;\n                    backspaceShift = _backspaceShift;\n                });\n                // only set the selection if the element is active\n                if (this._getActiveElement() !== el) {\n                    return;\n                }\n                if (this._maskService.plusOnePosition) {\n                    position = position + 1;\n                    this._maskService.plusOnePosition = false;\n                }\n                // update position after applyValueChanges to prevent cursor on wrong position when it has an array of maskExpression\n                if (this._maskExpressionArray.length) {\n                    if (this._code === \"Backspace\" /* BACKSPACE */) {\n                        position = this.specialCharacters.includes(this._inputValue.slice(position - 1, position))\n                            ? position - 1\n                            : position;\n                    }\n                    else {\n                        position =\n                            el.selectionStart === 1\n                                ? el.selectionStart + this._maskService.prefix.length\n                                : el.selectionStart;\n                    }\n                }\n                this._position =\n                    this._position === 1 && this._inputValue.length === 1 ? null : this._position;\n                let positionToApply = this._position\n                    ? this._inputValue.length + position + caretShift\n                    : position +\n                        (this._code === \"Backspace\" /* BACKSPACE */ && !backspaceShift ? 0 : caretShift);\n                if (positionToApply > this._getActualInputLength()) {\n                    positionToApply =\n                        el.value === this._maskService.decimalMarker && el.value.length === 1\n                            ? this._getActualInputLength() + 1\n                            : this._getActualInputLength();\n                }\n                if (positionToApply < 0) {\n                    positionToApply = 0;\n                }\n                el.setSelectionRange(positionToApply, positionToApply);\n                this._position = null;\n            }\n            else {\n                console.warn('Ngx-mask writeValue work with string | number, your current value:', typeof transformedValue);\n            }\n        }\n        else {\n            if (!this._maskValue) {\n                this.onChange(el.value);\n                return;\n            }\n            this._maskService.applyValueChanges(el.value.length, this._justPasted, this._code === \"Backspace\" /* BACKSPACE */ || this._code === \"Delete\" /* DELETE */);\n        }\n    }\n    // IME starts\n    onCompositionStart() {\n        this._isComposing = true;\n    }\n    // IME completes\n    onCompositionEnd(e) {\n        this._isComposing = false;\n        this._justPasted = true;\n        this.onInput(e);\n    }\n    onBlur(e) {\n        if (this._maskValue) {\n            const el = e.target;\n            if (this.leadZero && el.value.length > 0 && typeof this.decimalMarker === 'string') {\n                const maskExpression = this._maskService.maskExpression;\n                const precision = Number(this._maskService.maskExpression.slice(maskExpression.length - 1, maskExpression.length));\n                if (precision > 1) {\n                    el.value = this.suffix ? el.value.split(this.suffix).join('') : el.value;\n                    const decimalPart = el.value.split(this.decimalMarker)[1];\n                    el.value = el.value.includes(this.decimalMarker)\n                        ? el.value +\n                            \"0\" /* NUMBER_ZERO */.repeat(precision - decimalPart.length) +\n                            this.suffix\n                        : el.value +\n                            this.decimalMarker +\n                            \"0\" /* NUMBER_ZERO */.repeat(precision) +\n                            this.suffix;\n                    this._maskService.actualValue = el.value;\n                }\n            }\n            this._maskService.clearIfNotMatchFn();\n        }\n        this._isFocused = false;\n        this.onTouch();\n    }\n    onClick(e) {\n        if (!this._maskValue) {\n            return;\n        }\n        const el = e.target;\n        const posStart = 0;\n        const posEnd = 0;\n        if (el !== null &&\n            el.selectionStart !== null &&\n            el.selectionStart === el.selectionEnd &&\n            el.selectionStart > this._maskService.prefix.length &&\n            // eslint-disable-next-line\n            e.keyCode !== 38) {\n            if (this._maskService.showMaskTyped && !this.keepCharacterPositions) {\n                // We are showing the mask in the input\n                this._maskService.maskIsShown = this._maskService.showMaskInInput();\n                if (el.setSelectionRange &&\n                    this._maskService.prefix + this._maskService.maskIsShown === el.value) {\n                    // the input ONLY contains the mask, so position the cursor at the start\n                    el.focus();\n                    el.setSelectionRange(posStart, posEnd);\n                }\n                else {\n                    // the input contains some characters already\n                    if (el.selectionStart > this._maskService.actualValue.length) {\n                        // if the user clicked beyond our value's length, position the cursor at the end of our value\n                        el.setSelectionRange(this._maskService.actualValue.length, this._maskService.actualValue.length);\n                    }\n                }\n            }\n        }\n        const nextValue = el &&\n            (el.value === this._maskService.prefix\n                ? this._maskService.prefix + this._maskService.maskIsShown\n                : el.value);\n        /** Fix of cursor position jumping to end in most browsers no matter where cursor is inserted onFocus */\n        if (el && el.value !== nextValue) {\n            el.value = nextValue;\n        }\n        /** fix of cursor position with prefix when mouse click occur */\n        if (el &&\n            el.type !== 'number' &&\n            (el.selectionStart || el.selectionEnd) <=\n                this._maskService.prefix.length) {\n            el.selectionStart = this._maskService.prefix.length;\n            return;\n        }\n        /** select only inserted text */\n        if (el && el.selectionEnd > this._getActualInputLength()) {\n            el.selectionEnd = this._getActualInputLength();\n        }\n    }\n    // eslint-disable-next-line complexity\n    onKeyDown(e) {\n        var _a, _b;\n        if (!this._maskValue) {\n            return;\n        }\n        if (this._isComposing) {\n            // User finalize their choice from IME composition, so trigger onInput() for the composed text.\n            if (e.key === 'Enter')\n                this.onCompositionEnd(e);\n            return;\n        }\n        this._code = e.code ? e.code : e.key;\n        const el = e.target;\n        this._inputValue = el.value;\n        this._setMask();\n        if (el.type !== 'number') {\n            if (e.key === \"ArrowUp\" /* ARROW_UP */) {\n                e.preventDefault();\n            }\n            if (e.key === \"ArrowLeft\" /* ARROW_LEFT */ ||\n                e.key === \"Backspace\" /* BACKSPACE */ ||\n                e.key === \"Delete\" /* DELETE */) {\n                if (e.key === \"Backspace\" /* BACKSPACE */ && el.value.length === 0) {\n                    el.selectionStart = el.selectionEnd;\n                }\n                if (e.key === \"Backspace\" /* BACKSPACE */ && el.selectionStart !== 0) {\n                    // If specialChars is false, (shouldn't ever happen) then set to the defaults\n                    this.specialCharacters = ((_a = this.specialCharacters) === null || _a === void 0 ? void 0 : _a.length)\n                        ? this.specialCharacters\n                        : this._config.specialCharacters;\n                    if (this.prefix.length > 1 &&\n                        el.selectionStart <= this.prefix.length) {\n                        el.setSelectionRange(this.prefix.length, el.selectionEnd);\n                    }\n                    else {\n                        if (this._inputValue.length !== el.selectionStart &&\n                            el.selectionStart !== 1) {\n                            while (this.specialCharacters.includes(((_b = this._inputValue[el.selectionStart - 1]) !== null && _b !== void 0 ? _b : \"\" /* EMPTY_STRING */).toString()) &&\n                                ((this.prefix.length >= 1 &&\n                                    el.selectionStart > this.prefix.length) ||\n                                    this.prefix.length === 0)) {\n                                el.setSelectionRange(el.selectionStart - 1, el.selectionEnd);\n                            }\n                        }\n                    }\n                }\n                this.checkSelectionOnDeletion(el);\n                if (this._maskService.prefix.length &&\n                    el.selectionStart <= this._maskService.prefix.length &&\n                    el.selectionEnd <= this._maskService.prefix.length) {\n                    e.preventDefault();\n                }\n                const cursorStart = el.selectionStart;\n                if (e.key === \"Backspace\" /* BACKSPACE */ &&\n                    !el.readOnly &&\n                    cursorStart === 0 &&\n                    el.selectionEnd === el.value.length &&\n                    el.value.length !== 0) {\n                    this._position = this._maskService.prefix ? this._maskService.prefix.length : 0;\n                    this._maskService.applyMask(this._maskService.prefix, this._maskService.maskExpression, this._position);\n                }\n            }\n            if (!!this.suffix &&\n                this.suffix.length > 1 &&\n                this._inputValue.length - this.suffix.length < el.selectionStart) {\n                el.setSelectionRange(this._inputValue.length - this.suffix.length, this._inputValue.length);\n            }\n            else if ((e.code === 'KeyA' && e.ctrlKey) ||\n                (e.code === 'KeyA' && e.metaKey) // Cmd + A (Mac)\n            ) {\n                el.setSelectionRange(0, this._getActualInputLength());\n                e.preventDefault();\n            }\n            this._maskService.selStart = el.selectionStart;\n            this._maskService.selEnd = el.selectionEnd;\n        }\n    }\n    /** It writes the value in the input */\n    writeValue(controlValue) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof controlValue === 'object' && controlValue !== null && 'value' in controlValue) {\n                if ('disable' in controlValue) {\n                    this.setDisabledState(Boolean(controlValue.disable));\n                }\n                // eslint-disable-next-line no-param-reassign\n                controlValue = controlValue.value;\n            }\n            if (controlValue !== null) {\n                // eslint-disable-next-line no-param-reassign\n                controlValue = this.inputTransformFn\n                    ? this.inputTransformFn(controlValue)\n                    : controlValue;\n            }\n            if (typeof controlValue === 'string' ||\n                typeof controlValue === 'number' ||\n                controlValue === null ||\n                controlValue === undefined) {\n                if (controlValue === null || controlValue === undefined || controlValue === '') {\n                    this._maskService._currentValue = '';\n                    this._maskService._previousValue = '';\n                }\n                // eslint-disable-next-line no-param-reassign\n                let inputValue = controlValue;\n                if (typeof inputValue === 'number' ||\n                    this._maskValue.startsWith(\"separator\" /* SEPARATOR */)) {\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue = String(inputValue);\n                    const localeDecimalMarker = this._maskService.currentLocaleDecimalMarker();\n                    if (!Array.isArray(this._maskService.decimalMarker)) {\n                        // eslint-disable-next-line no-param-reassign\n                        inputValue =\n                            this._maskService.decimalMarker !== localeDecimalMarker\n                                ? inputValue.replace(localeDecimalMarker, this._maskService.decimalMarker)\n                                : inputValue;\n                    }\n                    if (this._maskService.leadZero &&\n                        inputValue &&\n                        this.maskExpression &&\n                        this.dropSpecialCharacters !== false) {\n                        // eslint-disable-next-line no-param-reassign\n                        inputValue = this._maskService._checkPrecision(this._maskService.maskExpression, inputValue);\n                    }\n                    if (this._maskService.decimalMarker === \",\" /* COMMA */) {\n                        // eslint-disable-next-line no-param-reassign\n                        inputValue = inputValue\n                            .toString()\n                            .replace(\".\" /* DOT */, \",\" /* COMMA */);\n                    }\n                    if (((_a = this.maskExpression) === null || _a === void 0 ? void 0 : _a.startsWith(\"separator\" /* SEPARATOR */)) && this.leadZero) {\n                        requestAnimationFrame(() => {\n                            var _a;\n                            this._maskService.applyMask((_a = inputValue === null || inputValue === void 0 ? void 0 : inputValue.toString()) !== null && _a !== void 0 ? _a : '', this._maskService.maskExpression);\n                        });\n                    }\n                    this._maskService.isNumberValue = true;\n                }\n                if (typeof inputValue !== 'string') {\n                    // eslint-disable-next-line no-param-reassign\n                    inputValue = '';\n                }\n                this._inputValue = inputValue;\n                this._setMask();\n                if ((inputValue && this._maskService.maskExpression) ||\n                    (this._maskService.maskExpression &&\n                        (this._maskService.prefix || this._maskService.showMaskTyped))) {\n                    // Let the service we know we are writing value so that triggering onChange function won't happen during applyMask\n                    typeof this.inputTransformFn !== 'function'\n                        ? (this._maskService.writingValue = true)\n                        : '';\n                    this._maskService.formElementProperty = [\n                        'value',\n                        this._maskService.applyMask(inputValue, this._maskService.maskExpression),\n                    ];\n                    // Let the service know we've finished writing value\n                    typeof this.inputTransformFn !== 'function'\n                        ? (this._maskService.writingValue = false)\n                        : '';\n                }\n                else {\n                    this._maskService.formElementProperty = ['value', inputValue];\n                }\n                this._inputValue = inputValue;\n            }\n            else {\n                console.warn('Ngx-mask writeValue work with string | number, your current value:', typeof controlValue);\n            }\n        });\n    }\n    registerOnChange(fn) {\n        this._maskService.onChange = this.onChange = fn;\n    }\n    registerOnTouched(fn) {\n        this.onTouch = fn;\n    }\n    _getActiveElement(document = this.document) {\n        var _a;\n        const shadowRootEl = (_a = document === null || document === void 0 ? void 0 : document.activeElement) === null || _a === void 0 ? void 0 : _a.shadowRoot;\n        if (!(shadowRootEl === null || shadowRootEl === void 0 ? void 0 : shadowRootEl.activeElement)) {\n            return document.activeElement;\n        }\n        else {\n            return this._getActiveElement(shadowRootEl);\n        }\n    }\n    checkSelectionOnDeletion(el) {\n        el.selectionStart = Math.min(Math.max(this.prefix.length, el.selectionStart), this._inputValue.length - this.suffix.length);\n        el.selectionEnd = Math.min(Math.max(this.prefix.length, el.selectionEnd), this._inputValue.length - this.suffix.length);\n    }\n    /** It disables the input element */\n    setDisabledState(isDisabled) {\n        this._maskService.formElementProperty = ['disabled', isDisabled];\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    _applyMask() {\n        this._maskService.maskExpression = this._maskService._repeatPatternSymbols(this._maskValue || '');\n        this._maskService.formElementProperty = [\n            'value',\n            this._maskService.applyMask(this._inputValue, this._maskService.maskExpression),\n        ];\n    }\n    _validateTime(value) {\n        var _a;\n        const rowMaskLen = this._maskValue\n            .split(\"\" /* EMPTY_STRING */)\n            .filter((s) => s !== ':').length;\n        if (!value) {\n            return null; // Don't validate empty values to allow for optional form control\n        }\n        if ((+((_a = value[value.length - 1]) !== null && _a !== void 0 ? _a : -1) === 0 && value.length < rowMaskLen) ||\n            value.length <= rowMaskLen - 2) {\n            return this._createValidationError(value);\n        }\n        return null;\n    }\n    _getActualInputLength() {\n        return (this._maskService.actualValue.length ||\n            this._maskService.actualValue.length + this._maskService.prefix.length);\n    }\n    _createValidationError(actualValue) {\n        return {\n            mask: {\n                requiredMask: this._maskValue,\n                actualValue,\n            },\n        };\n    }\n    _setMask() {\n        this._maskExpressionArray.some((mask) => {\n            var _a, _b, _c, _d;\n            const specialChart = mask\n                .split(\"\" /* EMPTY_STRING */)\n                .some((char) => this._maskService.specialCharacters.includes(char));\n            if ((specialChart && this._inputValue && !mask.includes(\"S\" /* LETTER_S */)) ||\n                mask.includes(\"{\" /* CURLY_BRACKETS_LEFT */)) {\n                const test = ((_a = this._maskService.removeMask(this._inputValue)) === null || _a === void 0 ? void 0 : _a.length) <=\n                    ((_b = this._maskService.removeMask(mask)) === null || _b === void 0 ? void 0 : _b.length);\n                if (test) {\n                    this._maskValue =\n                        this.maskExpression =\n                            this._maskService.maskExpression =\n                                mask.includes(\"{\" /* CURLY_BRACKETS_LEFT */)\n                                    ? this._maskService._repeatPatternSymbols(mask)\n                                    : mask;\n                    return test;\n                }\n                else {\n                    const expression = (_c = this._maskExpressionArray[this._maskExpressionArray.length - 1]) !== null && _c !== void 0 ? _c : \"\" /* EMPTY_STRING */;\n                    this._maskValue =\n                        this.maskExpression =\n                            this._maskService.maskExpression =\n                                expression.includes(\"{\" /* CURLY_BRACKETS_LEFT */)\n                                    ? this._maskService._repeatPatternSymbols(expression)\n                                    : expression;\n                }\n            }\n            else {\n                const check = (_d = this._maskService\n                    .removeMask(this._inputValue)) === null || _d === void 0 ? void 0 : _d.split(\"\" /* EMPTY_STRING */).every((character, index) => {\n                    const indexMask = mask.charAt(index);\n                    return this._maskService._checkSymbolMask(character, indexMask);\n                });\n                if (check) {\n                    this._maskValue = this.maskExpression = this._maskService.maskExpression = mask;\n                    return check;\n                }\n            }\n        });\n    }\n}\nNgxMaskDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskDirective, deps: [{ token: DOCUMENT }, { token: NGX_MASK_CONFIG }, { token: NgxMaskService }], target: i0.ɵɵFactoryTarget.Directive });\nNgxMaskDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: \"12.0.0\", version: \"13.3.12\", type: NgxMaskDirective, selector: \"input[mask], textarea[mask]\", inputs: { maskExpression: [\"mask\", \"maskExpression\"], specialCharacters: \"specialCharacters\", patterns: \"patterns\", prefix: \"prefix\", suffix: \"suffix\", thousandSeparator: \"thousandSeparator\", decimalMarker: \"decimalMarker\", dropSpecialCharacters: \"dropSpecialCharacters\", hiddenInput: \"hiddenInput\", showMaskTyped: \"showMaskTyped\", placeHolderCharacter: \"placeHolderCharacter\", shownMaskExpression: \"shownMaskExpression\", showTemplate: \"showTemplate\", clearIfNotMatch: \"clearIfNotMatch\", validation: \"validation\", separatorLimit: \"separatorLimit\", allowNegativeNumbers: \"allowNegativeNumbers\", leadZeroDateTime: \"leadZeroDateTime\", leadZero: \"leadZero\", triggerOnMaskChange: \"triggerOnMaskChange\", apm: \"apm\", inputTransformFn: \"inputTransformFn\", outputTransformFn: \"outputTransformFn\", keepCharacterPositions: \"keepCharacterPositions\" }, outputs: { maskFilled: \"maskFilled\" }, host: { listeners: { \"paste\": \"onPaste()\", \"focus\": \"onFocus($event)\", \"ngModelChange\": \"onModelChange($event)\", \"input\": \"onInput($event)\", \"compositionstart\": \"onCompositionStart($event)\", \"compositionend\": \"onCompositionEnd($event)\", \"blur\": \"onBlur($event)\", \"click\": \"onClick($event)\", \"keydown\": \"onKeyDown($event)\" } }, providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => NgxMaskDirective),\n            multi: true,\n        },\n        {\n            provide: NG_VALIDATORS,\n            useExisting: forwardRef(() => NgxMaskDirective),\n            multi: true,\n        },\n        NgxMaskService,\n    ], exportAs: [\"mask\", \"ngxMask\"], usesOnChanges: true, ngImport: i0 });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskDirective, decorators: [{\n            type: Directive,\n            args: [{\n                    selector: 'input[mask], textarea[mask]',\n                    providers: [\n                        {\n                            provide: NG_VALUE_ACCESSOR,\n                            useExisting: forwardRef(() => NgxMaskDirective),\n                            multi: true,\n                        },\n                        {\n                            provide: NG_VALIDATORS,\n                            useExisting: forwardRef(() => NgxMaskDirective),\n                            multi: true,\n                        },\n                        NgxMaskService,\n                    ],\n                    exportAs: 'mask,ngxMask',\n                }]\n        }], ctorParameters: function () {\n        return [{ type: undefined, decorators: [{\n                        type: Inject,\n                        args: [DOCUMENT]\n                    }] }, { type: undefined, decorators: [{\n                        type: Inject,\n                        args: [NGX_MASK_CONFIG]\n                    }] }, { type: NgxMaskService }];\n    }, propDecorators: { maskExpression: [{\n                type: Input,\n                args: ['mask']\n            }], specialCharacters: [{\n                type: Input\n            }], patterns: [{\n                type: Input\n            }], prefix: [{\n                type: Input\n            }], suffix: [{\n                type: Input\n            }], thousandSeparator: [{\n                type: Input\n            }], decimalMarker: [{\n                type: Input\n            }], dropSpecialCharacters: [{\n                type: Input\n            }], hiddenInput: [{\n                type: Input\n            }], showMaskTyped: [{\n                type: Input\n            }], placeHolderCharacter: [{\n                type: Input\n            }], shownMaskExpression: [{\n                type: Input\n            }], showTemplate: [{\n                type: Input\n            }], clearIfNotMatch: [{\n                type: Input\n            }], validation: [{\n                type: Input\n            }], separatorLimit: [{\n                type: Input\n            }], allowNegativeNumbers: [{\n                type: Input\n            }], leadZeroDateTime: [{\n                type: Input\n            }], leadZero: [{\n                type: Input\n            }], triggerOnMaskChange: [{\n                type: Input\n            }], apm: [{\n                type: Input\n            }], inputTransformFn: [{\n                type: Input\n            }], outputTransformFn: [{\n                type: Input\n            }], keepCharacterPositions: [{\n                type: Input\n            }], maskFilled: [{\n                type: Output\n            }], onPaste: [{\n                type: HostListener,\n                args: ['paste']\n            }], onFocus: [{\n                type: HostListener,\n                args: ['focus', ['$event']]\n            }], onModelChange: [{\n                type: HostListener,\n                args: ['ngModelChange', ['$event']]\n            }], onInput: [{\n                type: HostListener,\n                args: ['input', ['$event']]\n            }], onCompositionStart: [{\n                type: HostListener,\n                args: ['compositionstart', ['$event']]\n            }], onCompositionEnd: [{\n                type: HostListener,\n                args: ['compositionend', ['$event']]\n            }], onBlur: [{\n                type: HostListener,\n                args: ['blur', ['$event']]\n            }], onClick: [{\n                type: HostListener,\n                args: ['click', ['$event']]\n            }], onKeyDown: [{\n                type: HostListener,\n                args: ['keydown', ['$event']]\n            }] } });\n\nclass NgxMaskPipe {\n    constructor(_maskService) {\n        this._maskService = _maskService;\n        this.defaultOptions = {};\n        this._maskExpressionArray = [];\n        this.mask = '';\n    }\n    transform(value, mask, _a = {}) {\n        var { patterns } = _a, config = __rest(_a, [\"patterns\"]);\n        const currentConfig = Object.assign(Object.assign(Object.assign({ maskExpression: mask }, this.defaultOptions), config), { patterns: Object.assign(Object.assign({}, this._maskService.patterns), patterns) });\n        Object.entries(currentConfig).forEach(([key, value]) => {\n            //eslint-disable-next-line  @typescript-eslint/no-explicit-any\n            this._maskService[key] = value;\n        });\n        if (mask.includes('||')) {\n            if (mask.split('||').length > 1) {\n                this._maskExpressionArray = mask.split('||').sort((a, b) => {\n                    return a.length - b.length;\n                });\n                this._setMask(value);\n                return this._maskService.applyMask(`${value}`, this.mask);\n            }\n            else {\n                this._maskExpressionArray = [];\n                return this._maskService.applyMask(`${value}`, this.mask);\n            }\n        }\n        if (mask.includes(\"{\" /* CURLY_BRACKETS_LEFT */)) {\n            return this._maskService.applyMask(`${value}`, this._maskService._repeatPatternSymbols(mask));\n        }\n        if (mask.startsWith(\"separator\" /* SEPARATOR */)) {\n            if (config.decimalMarker) {\n                this._maskService.decimalMarker = config.decimalMarker;\n            }\n            if (config.thousandSeparator) {\n                this._maskService.thousandSeparator = config.thousandSeparator;\n            }\n            if (config.leadZero) {\n                // eslint-disable-next-line no-param-reassign\n                this._maskService.leadZero = config.leadZero;\n            }\n            // eslint-disable-next-line no-param-reassign\n            value = String(value);\n            const localeDecimalMarker = this._maskService.currentLocaleDecimalMarker();\n            if (!Array.isArray(this._maskService.decimalMarker)) {\n                // eslint-disable-next-line no-param-reassign\n                value =\n                    this._maskService.decimalMarker !== localeDecimalMarker\n                        ? value.replace(localeDecimalMarker, this._maskService.decimalMarker)\n                        : value;\n            }\n            if (this._maskService.leadZero &&\n                value &&\n                this._maskService.dropSpecialCharacters !== false) {\n                // eslint-disable-next-line no-param-reassign\n                value = this._maskService._checkPrecision(mask, value);\n            }\n            if (this._maskService.decimalMarker === \",\" /* COMMA */) {\n                // eslint-disable-next-line no-param-reassign\n                value = value.toString().replace(\".\" /* DOT */, \",\" /* COMMA */);\n            }\n            this._maskService.isNumberValue = true;\n        }\n        if (value === null || value === undefined) {\n            return this._maskService.applyMask('', mask);\n        }\n        return this._maskService.applyMask(`${value}`, mask);\n    }\n    _setMask(value) {\n        if (this._maskExpressionArray.length > 0) {\n            this._maskExpressionArray.some((mask) => {\n                var _a, _b, _c;\n                const test = ((_a = this._maskService.removeMask(value)) === null || _a === void 0 ? void 0 : _a.length) <=\n                    ((_b = this._maskService.removeMask(mask)) === null || _b === void 0 ? void 0 : _b.length);\n                if (value && test) {\n                    this.mask = mask;\n                    return test;\n                }\n                else {\n                    const expression = (_c = this._maskExpressionArray[this._maskExpressionArray.length - 1]) !== null && _c !== void 0 ? _c : \"\" /* EMPTY_STRING */;\n                    this.mask = expression;\n                }\n            });\n        }\n    }\n}\nNgxMaskPipe.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskPipe, deps: [{ token: NgxMaskService }], target: i0.ɵɵFactoryTarget.Pipe });\nNgxMaskPipe.ɵpipe = i0.ɵɵngDeclarePipe({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskPipe, name: \"mask\" });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskPipe, decorators: [{\n            type: Pipe,\n            args: [{\n                    name: 'mask',\n                    pure: true,\n                }]\n        }], ctorParameters: function () { return [{ type: NgxMaskService }]; } });\n\n/**\n * @internal\n */\nfunction _configFactory(initConfig, configValue) {\n    return configValue instanceof Function\n        ? Object.assign(Object.assign({}, initConfig), configValue()) : Object.assign(Object.assign({}, initConfig), configValue);\n}\nclass NgxMaskModule {\n    static forRoot(configValue) {\n        return {\n            ngModule: NgxMaskModule,\n            providers: [\n                {\n                    provide: NEW_CONFIG,\n                    useValue: configValue,\n                },\n                {\n                    provide: INITIAL_CONFIG,\n                    useValue: initialConfig,\n                },\n                {\n                    provide: NGX_MASK_CONFIG,\n                    useFactory: _configFactory,\n                    deps: [INITIAL_CONFIG, NEW_CONFIG],\n                },\n                NgxMaskService,\n            ],\n        };\n    }\n    static forChild() {\n        return {\n            ngModule: NgxMaskModule,\n        };\n    }\n}\nNgxMaskModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nNgxMaskModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskModule, declarations: [NgxMaskDirective, NgxMaskPipe], exports: [NgxMaskDirective, NgxMaskPipe] });\nNgxMaskModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskModule });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.12\", ngImport: i0, type: NgxMaskModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    exports: [NgxMaskDirective, NgxMaskPipe],\n                    declarations: [NgxMaskDirective, NgxMaskPipe],\n                }]\n        }] });\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { INITIAL_CONFIG, NEW_CONFIG, NGX_MASK_CONFIG, NgxMaskDirective, NgxMaskModule, NgxMaskPipe, NgxMaskService, _configFactory, initialConfig, timeMasks, withoutValidation };\n"]},"metadata":{},"sourceType":"module"}